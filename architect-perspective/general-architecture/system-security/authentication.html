<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>认证 | 软件架构探索：The Fenix Project</title>
    <meta name="description" content="现代软件架构探索">
    <meta name="generator" content="VuePress 1.4.0">
    <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico">
    
    <link rel="preload" href="/assets/css/0.styles.3cae6e06.css" as="style"><link rel="preload" href="/assets/js/app.6cebae64.js" as="script"><link rel="preload" href="/assets/js/3.c73bb120.js" as="script"><link rel="preload" href="/assets/js/5.7ef9e7ae.js" as="script"><link rel="preload" href="/assets/js/60.5ae11b84.js" as="script"><link rel="prefetch" href="/assets/js/10.1ff33d57.js"><link rel="prefetch" href="/assets/js/100.753b1978.js"><link rel="prefetch" href="/assets/js/101.2307148b.js"><link rel="prefetch" href="/assets/js/102.51b8812c.js"><link rel="prefetch" href="/assets/js/103.0cd9b588.js"><link rel="prefetch" href="/assets/js/104.64490dcd.js"><link rel="prefetch" href="/assets/js/105.d120d12d.js"><link rel="prefetch" href="/assets/js/106.98daefe8.js"><link rel="prefetch" href="/assets/js/107.17387844.js"><link rel="prefetch" href="/assets/js/108.93fecc8a.js"><link rel="prefetch" href="/assets/js/109.b41c4aef.js"><link rel="prefetch" href="/assets/js/11.1c5e0da1.js"><link rel="prefetch" href="/assets/js/110.9a462aff.js"><link rel="prefetch" href="/assets/js/111.68fe00c0.js"><link rel="prefetch" href="/assets/js/112.ae9f4097.js"><link rel="prefetch" href="/assets/js/113.50de843f.js"><link rel="prefetch" href="/assets/js/114.e85a7648.js"><link rel="prefetch" href="/assets/js/115.257755bd.js"><link rel="prefetch" href="/assets/js/116.327eca27.js"><link rel="prefetch" href="/assets/js/117.956576fe.js"><link rel="prefetch" href="/assets/js/118.22e6cff5.js"><link rel="prefetch" href="/assets/js/119.d7dd780b.js"><link rel="prefetch" href="/assets/js/12.80c71ea4.js"><link rel="prefetch" href="/assets/js/120.4bac259c.js"><link rel="prefetch" href="/assets/js/121.47b46991.js"><link rel="prefetch" href="/assets/js/122.6273c87b.js"><link rel="prefetch" href="/assets/js/123.51925d66.js"><link rel="prefetch" href="/assets/js/124.ff3ce0e4.js"><link rel="prefetch" href="/assets/js/125.1115545f.js"><link rel="prefetch" href="/assets/js/126.8a2b9fc1.js"><link rel="prefetch" href="/assets/js/127.a2acfc7a.js"><link rel="prefetch" href="/assets/js/128.56e4d290.js"><link rel="prefetch" href="/assets/js/129.182ca3df.js"><link rel="prefetch" href="/assets/js/13.12314d49.js"><link rel="prefetch" href="/assets/js/130.d4841e57.js"><link rel="prefetch" href="/assets/js/131.d14586ed.js"><link rel="prefetch" href="/assets/js/132.23a5a402.js"><link rel="prefetch" href="/assets/js/133.0f3e17ab.js"><link rel="prefetch" href="/assets/js/14.2dd52fe4.js"><link rel="prefetch" href="/assets/js/15.9a30f1fa.js"><link rel="prefetch" href="/assets/js/16.b7fe5a35.js"><link rel="prefetch" href="/assets/js/17.3a0d61f6.js"><link rel="prefetch" href="/assets/js/18.085e4353.js"><link rel="prefetch" href="/assets/js/19.b34b1001.js"><link rel="prefetch" href="/assets/js/2.e152579e.js"><link rel="prefetch" href="/assets/js/20.349ada1e.js"><link rel="prefetch" href="/assets/js/21.fe3ad15a.js"><link rel="prefetch" href="/assets/js/22.7c5c07d9.js"><link rel="prefetch" href="/assets/js/23.3e354e3a.js"><link rel="prefetch" href="/assets/js/24.6bcc64ad.js"><link rel="prefetch" href="/assets/js/25.944bdae6.js"><link rel="prefetch" href="/assets/js/26.f6d28b81.js"><link rel="prefetch" href="/assets/js/27.15392939.js"><link rel="prefetch" href="/assets/js/28.9f9fbd4d.js"><link rel="prefetch" href="/assets/js/29.819f6905.js"><link rel="prefetch" href="/assets/js/30.49e8b4c8.js"><link rel="prefetch" href="/assets/js/31.4d56907f.js"><link rel="prefetch" href="/assets/js/32.878331e2.js"><link rel="prefetch" href="/assets/js/33.d82fb8d6.js"><link rel="prefetch" href="/assets/js/34.f7d1d1d5.js"><link rel="prefetch" href="/assets/js/35.d7cd5895.js"><link rel="prefetch" href="/assets/js/36.4b9aa1db.js"><link rel="prefetch" href="/assets/js/37.f27e3dfd.js"><link rel="prefetch" href="/assets/js/38.d84aa2bf.js"><link rel="prefetch" href="/assets/js/39.610411d2.js"><link rel="prefetch" href="/assets/js/4.06f54dc6.js"><link rel="prefetch" href="/assets/js/40.04588d87.js"><link rel="prefetch" href="/assets/js/41.08028ad3.js"><link rel="prefetch" href="/assets/js/42.4d1d3cc4.js"><link rel="prefetch" href="/assets/js/43.bc8a0d6c.js"><link rel="prefetch" href="/assets/js/44.75674705.js"><link rel="prefetch" href="/assets/js/45.fe0a0104.js"><link rel="prefetch" href="/assets/js/46.4eebf1d0.js"><link rel="prefetch" href="/assets/js/47.361c2fa2.js"><link rel="prefetch" href="/assets/js/48.ab43e748.js"><link rel="prefetch" href="/assets/js/49.d20beab6.js"><link rel="prefetch" href="/assets/js/50.6bf3ad53.js"><link rel="prefetch" href="/assets/js/51.386eec49.js"><link rel="prefetch" href="/assets/js/52.444344dc.js"><link rel="prefetch" href="/assets/js/53.f54dc3c8.js"><link rel="prefetch" href="/assets/js/54.57dbbdde.js"><link rel="prefetch" href="/assets/js/55.c5ac3778.js"><link rel="prefetch" href="/assets/js/56.8cdc6bec.js"><link rel="prefetch" href="/assets/js/57.13a8aec9.js"><link rel="prefetch" href="/assets/js/58.0d1adf33.js"><link rel="prefetch" href="/assets/js/59.952f67e0.js"><link rel="prefetch" href="/assets/js/6.b9ea4c4f.js"><link rel="prefetch" href="/assets/js/61.4cb9c701.js"><link rel="prefetch" href="/assets/js/62.1b730731.js"><link rel="prefetch" href="/assets/js/63.6e42f350.js"><link rel="prefetch" href="/assets/js/64.fe3e5f4e.js"><link rel="prefetch" href="/assets/js/65.ec5b203d.js"><link rel="prefetch" href="/assets/js/66.d8512a6e.js"><link rel="prefetch" href="/assets/js/67.70f4efdf.js"><link rel="prefetch" href="/assets/js/68.9bc25aad.js"><link rel="prefetch" href="/assets/js/69.8e5c6ef5.js"><link rel="prefetch" href="/assets/js/7.77c56415.js"><link rel="prefetch" href="/assets/js/70.522d0f4a.js"><link rel="prefetch" href="/assets/js/71.8c468216.js"><link rel="prefetch" href="/assets/js/72.76d808c2.js"><link rel="prefetch" href="/assets/js/73.a02772f8.js"><link rel="prefetch" href="/assets/js/74.d8b7e069.js"><link rel="prefetch" href="/assets/js/75.fae6b7b6.js"><link rel="prefetch" href="/assets/js/76.4690ffb1.js"><link rel="prefetch" href="/assets/js/77.114d1234.js"><link rel="prefetch" href="/assets/js/78.133c4911.js"><link rel="prefetch" href="/assets/js/79.6eb8ae12.js"><link rel="prefetch" href="/assets/js/8.fa5a23c3.js"><link rel="prefetch" href="/assets/js/80.67332057.js"><link rel="prefetch" href="/assets/js/81.277ae01c.js"><link rel="prefetch" href="/assets/js/82.831bff0b.js"><link rel="prefetch" href="/assets/js/83.e577c779.js"><link rel="prefetch" href="/assets/js/84.f92bbfe3.js"><link rel="prefetch" href="/assets/js/85.bece5d70.js"><link rel="prefetch" href="/assets/js/86.bfcecdb1.js"><link rel="prefetch" href="/assets/js/87.5320b9e4.js"><link rel="prefetch" href="/assets/js/88.e6625f7d.js"><link rel="prefetch" href="/assets/js/89.506864b5.js"><link rel="prefetch" href="/assets/js/9.999efa61.js"><link rel="prefetch" href="/assets/js/90.faf21986.js"><link rel="prefetch" href="/assets/js/91.efba4603.js"><link rel="prefetch" href="/assets/js/92.741491c5.js"><link rel="prefetch" href="/assets/js/93.1846411e.js"><link rel="prefetch" href="/assets/js/94.0acff6c5.js"><link rel="prefetch" href="/assets/js/95.0cd24d9b.js"><link rel="prefetch" href="/assets/js/96.0c8faec7.js"><link rel="prefetch" href="/assets/js/97.727fe0ef.js"><link rel="prefetch" href="/assets/js/98.acd6c6ac.js"><link rel="prefetch" href="/assets/js/99.a1e8a2a1.js">
    <link rel="stylesheet" href="/assets/css/0.styles.3cae6e06.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/images/logo-color.png" alt="软件架构探索：The Fenix Project" class="logo"> <span class="site-name can-hide">软件架构探索：The Fenix Project</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="代码" class="dropdown-title"><span class="title">代码</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/fenixsoft/awesome-fenix" target="_blank" rel="noopener noreferrer" class="nav-link external">
  文档工程 Awesome-Fenix
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/fenixsoft/fenix-bookstore-frontend" target="_blank" rel="noopener noreferrer" class="nav-link external">
  前端工程 Fenix's Bookstore
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/fenixsoft/monolithic_arch_springboot" target="_blank" rel="noopener noreferrer" class="nav-link external">
  后端：单体架构 SpringBoot
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/fenixsoft/microservice_arch_springcloud" target="_blank" rel="noopener noreferrer" class="nav-link external">
  后端：微服务架构 SpringCloud
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/fenixsoft/microservice_arch_kubernetes" target="_blank" rel="noopener noreferrer" class="nav-link external">
  后端：微服务架构 Kubernetes
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/fenixsoft/serverless_arch_knative" target="_blank" rel="noopener noreferrer" class="nav-link external">
  后端：无服务架构 Knative
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div><div class="nav-item"><a href="http://bookstore.icyfenix.cn" target="_blank" rel="noopener noreferrer" class="nav-link external">
  示例
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://icyfenix.cn/pdf/the-fenix-project.pdf" target="_blank" rel="noopener noreferrer" class="nav-link external">
  PDF下载
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="/board.html" class="nav-link">
  讨论区
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="代码" class="dropdown-title"><span class="title">代码</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/fenixsoft/awesome-fenix" target="_blank" rel="noopener noreferrer" class="nav-link external">
  文档工程 Awesome-Fenix
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/fenixsoft/fenix-bookstore-frontend" target="_blank" rel="noopener noreferrer" class="nav-link external">
  前端工程 Fenix's Bookstore
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/fenixsoft/monolithic_arch_springboot" target="_blank" rel="noopener noreferrer" class="nav-link external">
  后端：单体架构 SpringBoot
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/fenixsoft/microservice_arch_springcloud" target="_blank" rel="noopener noreferrer" class="nav-link external">
  后端：微服务架构 SpringCloud
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/fenixsoft/microservice_arch_kubernetes" target="_blank" rel="noopener noreferrer" class="nav-link external">
  后端：微服务架构 Kubernetes
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/fenixsoft/serverless_arch_knative" target="_blank" rel="noopener noreferrer" class="nav-link external">
  后端：无服务架构 Knative
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div><div class="nav-item"><a href="http://bookstore.icyfenix.cn" target="_blank" rel="noopener noreferrer" class="nav-link external">
  示例
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://icyfenix.cn/pdf/the-fenix-project.pdf" target="_blank" rel="noopener noreferrer" class="nav-link external">
  PDF下载
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="/board.html" class="nav-link">
  讨论区
</a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/summary/" class="sidebar-link">目录</a></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>前言</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/introduction/about-me.html" class="sidebar-link">✔️ 关于作者</a></li><li><a href="/introduction/about-the-fenix-project.html" class="sidebar-link">✔️ 什么是“The Fenix Project”</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>探索起步</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading open"><span>阅读指引</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/exploration/guide/quick-start.html" class="sidebar-link">✔️ 如何开始</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><a href="/exploration/projects/" class="sidebar-heading clickable"><span>✔️ 技术演示工程</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/exploration/projects/fenix-bookstore-frontend.html" class="sidebar-link">✔️ 前端工程</a></li><li><a href="/exploration/projects/monolithic_arch_springboot.html" class="sidebar-link">✔️ 后端工程：SpringBoot</a></li><li><a href="/exploration/projects/microservice_arch_springcloud.html" class="sidebar-link">✔️ 后端工程：SpringCloud</a></li><li><a href="/exploration/projects/microservice_arch_kubernetes.html" class="sidebar-link">后端工程：Kubernetes</a></li><li><a href="/exploration/projects/serverless_arch_knative.html" class="sidebar-link">后端工程：Knative</a></li></ul></section></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>设计者的视角</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group is-sub-group depth-1"><a href="/architect-perspective/general-architecture/" class="sidebar-heading clickable router-link-active open"><span>✔️ 架构的普适问题</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group collapsable is-sub-group depth-2"><a href="/architect-perspective/general-architecture/api-style/" class="sidebar-heading clickable"><span>✔️ 服务风格设计</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-2"><a href="/architect-perspective/general-architecture/system-security/" class="sidebar-heading clickable router-link-active open"><span>✔️ 安全架构</span> <span class="arrow down"></span></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/architect-perspective/general-architecture/system-security/authentication.html" class="active sidebar-link">✔️ 认证</a></li><li><a href="/architect-perspective/general-architecture/system-security/authorization.html" class="sidebar-link">✔️ 授权</a></li><li><a href="/architect-perspective/general-architecture/system-security/credentials.html" class="sidebar-link">✔️ 凭证</a></li><li><a href="/architect-perspective/general-architecture/system-security/confidentiality.html" class="sidebar-link">✔️ 保密</a></li><li><a href="/architect-perspective/general-architecture/system-security/transport-security.html" class="sidebar-link">✔️ 传输</a></li><li><a href="/architect-perspective/general-architecture/system-security/verification.html" class="sidebar-link">✔️ 验证</a></li><li><a href="/architect-perspective/general-architecture/system-security/exploit.html" class="sidebar-link">漏洞利用</a></li></ul></section></li><li><section class="sidebar-group collapsable is-sub-group depth-2"><a href="/architect-perspective/general-architecture/transaction/" class="sidebar-heading clickable"><span>✔️ 事务一致性</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-2"><a href="/architect-perspective/general-architecture/diversion-system/" class="sidebar-heading clickable"><span>✔️ 透明多级分流系统</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-2"><a href="/architect-perspective/general-architecture/concurrent/" class="sidebar-heading clickable"><span>高效并发</span> <span class="arrow right"></span></a> <!----></section></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>设计方法论</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/architect-perspective/methodology/layered-system.html" class="sidebar-link">系统分层</a></li><li><a href="/architect-perspective/methodology/capacity-design.html" class="sidebar-link">容量规划</a></li><li><a href="/architect-perspective/methodology/constraint.html" class="sidebar-link">非功能属性设计</a></li></ul></section></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>演进中的架构</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group is-sub-group depth-1"><a href="/architecture/architect-history/" class="sidebar-heading clickable open"><span>✔️ 服务架构演进史</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/architecture/architect-history/primitive-distribution.html" class="sidebar-link">✔️ 原始分布式时代</a></li><li><a href="/architecture/architect-history/monolithic.html" class="sidebar-link">✔️ 单体系统时代</a></li><li><a href="/architecture/architect-history/soa.html" class="sidebar-link">✔️ SOA时代</a></li><li><a href="/architecture/architect-history/microservices.html" class="sidebar-link">✔️ 微服务时代</a></li><li><a href="/architecture/architect-history/post-microservices.html" class="sidebar-link">✔️ 后微服务时代</a></li><li><a href="/architecture/architect-history/serverless.html" class="sidebar-link">✔️ 无服务时代</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>从架构到实现</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/architecture/architect-framework/j2ee-base-arch.html" class="sidebar-link">基于J2EE的单体架构</a></li><li><a href="/architecture/architect-framework/springboot-base-arch.html" class="sidebar-link">基于Spring Boot的单体架构</a></li><li><a href="/architecture/architect-framework/springcloud-base-arch.html" class="sidebar-link">基于Spring Cloud微服务架构</a></li><li><a href="/architecture/architect-framework/kubernetes-base-arch.html" class="sidebar-link">基于Kubernetes的微服务架构</a></li><li><a href="/architecture/architect-framework/servicemesh-lstio-arch.html" class="sidebar-link">基于Istio的服务网格架构</a></li><li><a href="/architecture/architect-framework/serverless-arch-knative.html" class="sidebar-link">基于Knative的无服务架构</a></li><li><a href="/architecture/architect-framework/serverless-arch-kubeless.html" class="sidebar-link">基于Kubeless的无服务架构</a></li></ul></section></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>分布式的基石</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group is-sub-group depth-1"><a href="/distribution/service-governance/" class="sidebar-heading clickable open"><span>服务治理</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/distribution/service-governance/service-discovery.html" class="sidebar-link">服务发现</a></li><li><a href="/distribution/service-governance/service-routing.html" class="sidebar-link">服务路由与网关</a></li><li><a href="/distribution/service-governance/composer.html" class="sidebar-link">服务编排</a></li></ul></section></li><li><a href="/distribution/load-balancing.html" class="sidebar-link">进程内负载均衡</a></li><li><section class="sidebar-group is-sub-group depth-1"><a href="/distribution/fault-tolerance/" class="sidebar-heading clickable"><span>服务容错</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/distribution/fault-tolerance/isolation.html" class="sidebar-link">隔离</a></li><li><a href="/distribution/fault-tolerance/breaker.html" class="sidebar-link">熔断</a></li><li><a href="/distribution/fault-tolerance/timeout.html" class="sidebar-link">超时</a></li><li><a href="/distribution/fault-tolerance/traffic-control.html" class="sidebar-link">流控</a></li><li><a href="/distribution/fault-tolerance/service-downgrade.html" class="sidebar-link">降级</a></li><li><a href="/distribution/fault-tolerance/exception-inject.html" class="sidebar-link">异常注入</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><a href="/distribution/service-monitoring/" class="sidebar-heading clickable"><span>服务监控</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/distribution/service-monitoring/logging.html" class="sidebar-link">日志聚合</a></li><li><a href="/distribution/service-monitoring/invokechain-trace.html" class="sidebar-link">链路跟踪</a></li><li><a href="/distribution/service-monitoring/apm.html" class="sidebar-link">应用性能管理</a></li></ul></section></li><li><a href="/distribution/configuration.html" class="sidebar-link">中心化配置</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>不可变基础设施</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/immutable-infrastructure/history.html" class="sidebar-link">概念与演进历史</a></li><li><section class="sidebar-group is-sub-group depth-1"><a href="/immutable-infrastructure/container/" class="sidebar-heading clickable"><span>容器</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/immutable-infrastructure/container/cri.html" class="sidebar-link">CRI接口</a></li><li><a href="/immutable-infrastructure/container/resource-isolation.html" class="sidebar-link">资源隔离</a></li><li><a href="/immutable-infrastructure/container/image.html" class="sidebar-link">镜像</a></li><li><a href="/immutable-infrastructure/container/manage.html" class="sidebar-link">容器管理</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><a href="/immutable-infrastructure/network/" class="sidebar-heading clickable"><span>网络</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/immutable-infrastructure/network/cni.html" class="sidebar-link">CNI接口</a></li><li><a href="/immutable-infrastructure/network/container-lb.html" class="sidebar-link">容器负载均衡</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><a href="/immutable-infrastructure/storage/" class="sidebar-heading clickable"><span>存储</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/immutable-infrastructure/storage/csi.html" class="sidebar-link">CSI接口</a></li><li><a href="/immutable-infrastructure/storage/storage-plugins.html" class="sidebar-link">共享存储插件</a></li></ul></section></li><li><a href="/immutable-infrastructure/gpu-support.html" class="sidebar-link">GPU虚拟化</a></li><li><a href="/immutable-infrastructure/hardware-schedule.html" class="sidebar-link">硬件资源调度</a></li><li><a href="/immutable-infrastructure/cloud-native.html" class="sidebar-link">云原生环境</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>技巧与专题</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group is-sub-group depth-1"><a href="/tricks/graalvm/" class="sidebar-heading clickable open"><span>✔️ Graal VM</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/tricks/graalvm/graal-compiler.html" class="sidebar-link">✔️ 新一代即时编译器</a></li><li><a href="/tricks/graalvm/substratevm.html" class="sidebar-link">✔️ 向原生迈进</a></li><li><a href="/tricks/graalvm/graalvm-native.html" class="sidebar-link">✔️ 没有虚拟机的Java</a></li><li><a href="/tricks/graalvm/spring-over-graal.html" class="sidebar-link">✔️ Spring over Graal</a></li></ul></section></li><li><a href="/tricks/responsive-programming.html" class="sidebar-link">响应式编程</a></li><li><a href="/tricks/zero-copy.html" class="sidebar-link">零拷贝</a></li><li><a href="/tricks/stream-computing.html" class="sidebar-link">流式计算</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>附录</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/appendix/build-script.html" class="sidebar-link">构建发布脚本</a></li><li><a href="/appendix/continuous-integration.html" class="sidebar-link">持续集成</a></li><li><a href="/appendix/gated-launch.html" class="sidebar-link">灰度发布</a></li><li><section class="sidebar-group is-sub-group depth-1"><a href="/appendix/deployment-env-setup/" class="sidebar-heading clickable"><span>✔️ 环境依赖</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/appendix/deployment-env-setup/setup-docker.html" class="sidebar-link">✔️ 部署Docker CE容器环境</a></li><li><section class="sidebar-group collapsable is-sub-group depth-2"><a href="/appendix/deployment-env-setup/setup-kubernetes/" class="sidebar-heading clickable"><span>✔️ 部署Kubernetes集群</span> <span class="arrow right"></span></a> <!----></section></li></ul></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/appendix/operation-env-setup/" class="sidebar-heading clickable"><span>运维环境</span> <span class="arrow right"></span></a> <!----></section></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="认证">认证</h1> <div class="custom-block tip"><p class="custom-block-title">认证（Authentication）</p> <p>系统如何正确分辨出操作用户的真实身份？</p></div> <p>“认证”可以说是一个系统中最基础的安全设计，再简陋的系统大概也不大可能省略掉“用户登录”功能。但“认证”这件事情又并不如大多数人所认为的那样，校验一下 用户名、密码是否正确这么简单。尤其是在基于Java的软件系统里，尝试去触接了解Java安全标准的人往往会对一些今天看起来很别扭的概念产生疑惑。在这一部分，将简要概览一下关于认证的主流行业规范、标准；项目中具体如何认证、授权的内容放到下一节去介绍。</p> <p>最初的Java系统里，安全中的“认证”其实是特指“代码级安全”（你是否信任要在你的电脑中运行的代码），这是由“Java 2”之前它的主要应用形式Applets所决定的：从远端下载一段Java代码，以Applet的形式在用户的浏览器中运行，当然要保证这些代码不会损害用户的计算机才行。这一阶段的安全催生了今天仍然存在于Java体系中的“安全管理器”（java.lang.SecurityManager）、“代码权限许可”（java.lang.RuntimePermission）这些概念。</p> <p>不久之后，Java迎来了互联网的迅速兴起，进入了Java第一次快速发展时期，基于超文本的Web应用迅速盖过了“Java 2”时代之前的Applet，此时“安全认证”的重点逐渐转为“用户级安全”（你是否信任正在操作的用户）。在1999年随着J2EE 1.2（它是J2EE的首个版本，版本号直接就是1.2）所发布的Servlet 2.2中增加了一系列认证的API，诸如：</p> <ul><li>HttpServletRequest.isUserInRole()</li> <li>HttpServletRequest.getUserPrincipal()</li> <li>还内置支持了四种硬编码、不可扩展的认证机制：BASIC、FORM、CLIENT-CERT和DIGEST。</li></ul> <p>到Java 1.3时代中，Sun公司提出了同时面向与代码级安全和用户级安全的认证授权服务JAAS（Java Authentication and Authorization Service，1.3处于扩展包中，1.4纳入标准包），不过相对而言，在JAAS中代码级安全仍然是占更主要的地位。</p> <p>由于用户数据可能来自于各种不同的数据源（譬如RDBMS、JNDI、LDAP等等），JAAS设计了一种插入式（Pluggable）的认证和授权模型，以适配各种环境。在今天仍然活跃的主流安全框架中的许多概念，譬如用户叫做“Subject / Principal”、密码存在“Credentials”之中、登陆后从安全上下文“Context”中获取状态等都可以追溯到这一时期所设计的API：</p> <ul><li>LoginModule （javax.security.auth.spi.LoginModule）</li> <li>LoginContext （javax.security.auth.login.LoginContext）</li> <li>Subject （javax.security.auth.Subject）</li> <li>Principal （java.security.Principal）</li> <li>Credentials（javax.security.auth.Destroyable、javax.security.auth.Refreshable）</li></ul> <p>但是，尽管JAAS开创了许多沿用至今的安全概念，实质上并没有得到广泛的应用。这里有两大原因，一方面是由于JAAS同时面向代码级和用户级的安全机制，使得它过度复杂化，难以推广。在这里问题上JCP一直在做着持续的增强和补救，譬如Java EE 6中的JASPIC、Java EE 8中的EE Security：</p> <ul><li>JSR 115：<a href="https://jcp.org/aboutJava/communityprocess/mrel/jsr115/index3.html" target="_blank" rel="noopener noreferrer">Java Authorization Contract for Containers<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>（JACC）</li> <li>JSR 196：<a href="https://jcp.org/aboutJava/communityprocess/mrel/jsr196/index2.html" target="_blank" rel="noopener noreferrer">Java Authentication Service Provider Interface for Containers<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>（JASPIC）</li> <li>JSR 375： <a href="https://jcp.org/en/jsr/detail?id=375" target="_blank" rel="noopener noreferrer">Java EE Security API<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>（EE Security）</li></ul> <p>而另一方面，可能是更重要的一个原因是在21世纪的第一个十年里，以EJB为代表的容器化J2EE与以“Without EJB”为口号、以Spring、Hibernate等为代表的轻量化企业级开发框架之争，以后者的胜利而结束。这也使得依赖于容器安全的JAAS无法得到大多数人的认可。</p> <p>在今时今日，实际活跃于Java届的两大私有的（私有的意思是不由JSR所规范的，即没有java/javax.*作为包名的）的安全框架：</p> <ul><li><a href="https://shiro.apache.org/" target="_blank" rel="noopener noreferrer">Apache Shiro<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://spring.io/projects/spring-security" target="_blank" rel="noopener noreferrer">Spring Security<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <p>相较而言，Shiro使用更为便捷易用，而Spring Security的功能则要复杂强大一些。在我们的项目中（无论是单体架构还是微服务架构），均选择了Spring Security作为安全框架。当然，这里面也有很大一部分是因为Spring Boot/Cloud全家桶的原因。这两大安全框架都解决的问题都很类似，大致可以分为四类：</p> <ul><li>认证：以HTTP协议中定义的各种认证、表单等认证方式确认用户身份，这是本节的主要话题。</li> <li>授权：主要是授权结果，即访问控制（Access Control），稍后讲的“授权”将聚焦在授权的过程，尤其是多方授权中。这部分内容会放到下一节一起讨论。</li> <li>密码的存储：就是字面意思，我们会放到“保密”这节去一起讨论。</li> <li>安全上下文：用户获得认证之后，需要有API可以得知该用户的基本资料、用户拥有的权限、角色等。</li></ul> <p>介绍了一大段关于Java中安全标准的历史，我们最终还是要切入到如何处理认证的话题上，这可是随着网络出现就有的一个东西，所以，IETF的最初想法是基于Web的验证就应该在HTTP协议层面来解决。</p> <div class="quote"><p class="title">互联网工程任务组（Internet Engineering Task Force，IETF）</p><p>管理和发布互联网标准的组织，其标准以RFC即&quot;请求意见稿&quot;Request for Comments的形式发出。不仅是HTTP，几乎目前所有的主要网络协议，如IP、TCP、UDP、FTP、CMIP、SOCKS，等等都是以RFC形式定义的。</p></div><p>IETF给HTTP 1.1协议定义了401（Unauthorized，未授权）状态码，当服务端向客户端返回此状态码时，应在Header中附带一个WWW-Authenticate项，此项目通过跟随的一个可扩展的Scheme，告诉客户端应该采取怎样的方式来开始验证，例如：</p> <div class="language-http extra-class"><pre class="language-http"><code><span class="token response-status">HTTP/1.1 <span class="token property">401 Unauthorized</span></span>
<span class="token header-name keyword">Date:</span> Mon, 24 Feb 2020 16:50:53 GMT
<span class="token header-name keyword">WWW-Authenticate:</span> Basic realm=&quot;From icyfenix.cn&quot;
</code></pre></div><p>同时，IETF也定义了几种标准的Schema，对应了一些预定义好的认证方式，包括：</p> <ul><li><strong>Basic</strong>：<a href="https://tools.ietf.org/html/rfc7617" target="_blank" rel="noopener noreferrer">RFC 7617<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>，HTTP基础认证，弹出一个输入框，把用户名和密码Base64之后发送出去</li> <li><strong>Digest</strong>：<a href="https://tools.ietf.org/html/rfc7616" target="_blank" rel="noopener noreferrer">RFC 7616<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>，HTTP摘要认证，弹出一个输入框，把用户名和密码加盐后再通过MD5/SHA等哈希算法摘要后发送出去</li> <li><strong>Bearer</strong>：<a href="https://tools.ietf.org/html/rfc6750" target="_blank" rel="noopener noreferrer">RFC 6750<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>，OAuth 2.0令牌（OAuth2是一个授权协议，但同时也涉及到认证的内容，下一节的主角）</li> <li><strong>HOBA</strong>：<a href="https://tools.ietf.org/html/rfc7486" target="_blank" rel="noopener noreferrer">RFC 7486<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> ，<strong>H</strong>TTP <strong>O</strong>rigin-<strong>B</strong>ound <strong>A</strong>uthentication的缩写，一种基于数字签名的认证。</li></ul> <p>因为Scheme是允许自定义扩展的，很多厂商也加入了自己的认证方式，譬如：</p> <ul><li><strong>AWS4-HMAC-SHA256</strong>：简单粗暴的名字，一看就是亚马逊AWS基于HMAC-SHA256哈希算法的认证</li> <li><strong>NTLM</strong> / <strong>Negotiate</strong>：微软公司NT LAN Manager（NTLM）用到的两种认证方式</li> <li><strong>Windows Live ID</strong>：这个不需要解释了</li> <li><strong>Twitter Basic</strong>：一个不存在的网站所改良的HTTP基础认证</li> <li>……</li></ul> <p>现在主流的信息系统，直接采用上面这些认证方式比例不算太高，目前的主流仍是Form表单认证，即我们通常所说的“登陆页面”。表单认证并没有什么行业标准可循，表单中的用户字段、密码字段、验证码字段、是否要在客户端加密、加密的方式、接受表单的服务入口等都可由服务端、客户端自行协商决定。</p> <p>在Fenix's Bookstore项目中，我们所设计的登录实质上也是一种表单认证，借用了Spring Security的认证管理器。Spring Security中提供了默认的登陆表单界面和配套的服务，只要在Spring Security的Web安全中简单配置即可启用：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span>
<span class="token annotation punctuation">@EnableWebSecurity</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">WebSecurityConfig</span> <span class="token keyword">extends</span> <span class="token class-name">WebSecurityConfigurerAdapter</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">configure</span><span class="token punctuation">(</span><span class="token class-name">HttpSecurity</span> http<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        http<span class="token punctuation">.</span><span class="token function">authorizeRequests</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">antMatchers</span><span class="token punctuation">(</span><span class="token string">&quot;/&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">permitAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 首页地址'/'的请求都允许访问</span>
                <span class="token punctuation">.</span><span class="token function">anyRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">authenticated</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 任何请求,登录后才可以访问</span>
                <span class="token punctuation">.</span><span class="token function">and</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">formLogin</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment">// 启用表单登录认证，还有另一种httpBasic()方法代表了HTTP基础认证</span>
                <span class="token punctuation">.</span><span class="token function">permitAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 登录页面用户任意访问</span>
                <span class="token punctuation">.</span><span class="token function">and</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">logout</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">permitAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 注销的服务任意访问</span>
    <span class="token punctuation">}</span>    
<span class="token punctuation">}</span>
</code></pre></div><p>Spring Security的权限控制措施在两个层面进行，一种Web级别的访问控制，这是在Web服务器中附加的过滤器（FilterSecurityInterceptor）实现的，另一种是方法级权限控制，是通过动态代理实现的。第二种将在下一节“授权”部分中提及，这里先来说第一种。</p> <p>当Spring Security被启动时（在Spring Boot中通过@EnableWebSecurity注解启动），将会在Web服务器中附加十几个不同作用的过滤器，譬如上面代码就直接涉及到其中三个：</p> <ul><li>SecurityContextPersistenceFilter：用于维护安全上下文，“上下文”说白了就是如果用户登陆了系统，那服务的代码中总该有个地放可以取到当前登陆用户是谁这类信息</li> <li>UsernamePasswordAuthenticationFilter：用于完成用户名、密码的验证过程</li> <li>LogoutFilter：用于注销</li> <li>FilterSecurityInterceptor：用于Web级别的访问控制，如果设置了指定地址需要登陆而实际未登陆，或者设定了需要某些权限才能访问而实际用户并没有，那将抛出AuthenticationException与AccessDeniedException异常</li></ul> <p>让我们再回到上面的代码，这段简单的工作流程是：</p> <ol><li>启用过滤器UsernamePasswordAuthenticationFilter，在其attemptAuthentication()方法中，会从Request中获取用户名和密码，传递给认证管理器AuthenticationManager的authenticate()方法</li> <li>认证管理器的目的是协调不同的用户来源，譬如来自数据库、来自LDAP、来自OAuth等等，每一个用户来源都应该有一个实现了AuthenticationProvider接口并注册到认证管理器的实现类所代表，认证管理器将根据需要，调用对应Provider的authenticate()方法实际完成认证操作。</li> <li>Spring Security默认的Provider是DaoAuthenticationProvider，它在Bookstore项目中并未被采用，而是另外实现了一个UsernamePasswordAuthenticationProvider。但是两者的实际逻辑是相似的，都是调用UserDetailsService接口里的loadUserByUsername()来获取用户信息，UserDetailsService是读取用户明细数据的接口，Spring Security并不关心用户系统的实际存储结构，但认证时肯定也必须使用到用户信息，默认使用InMemoryUserDetailsManager，也就是从内存中写死一些用户数据来完成。</li> <li>在AuthenticationProvider中比较传入的用户密码与数据库中的用户密码是否一致（具体怎么个比较法将在“保密”这一节中说明），返回结果，完成认证。</li></ol> <p>以上流程是大多数系统，尤其是单体系统中主流的认证方式，哪怕不基于Apache Shiro或Spring Security来实现，其思路很可能也是与上面描述的差不多的。但我们的Bookstore却并未直接应用这种认证方式，而是借用了OAuth2授权协议中的密码授权模式，在此过程中完成认证。为何会选择这种方式，以及具体实现部分的内容，将在下一部分“授权”中继续介绍。</p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">总字数:</span> <span class="words">3,167</span> <span class="prefix">字　</span> <span class="prefix">最后更新:</span> <span class="time">4/16/2020, 12:40:27 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
    ←
    <a href="/architect-perspective/general-architecture/system-security/" class="prev router-link-active">
       安全架构
    </a></span> <span class="next"><a href="/architect-perspective/general-architecture/system-security/authorization.html">
      授权
    </a>
    →
  </span></p></div> </main></div><div class="global-ui"><div></div><!----></div></div>
    <script src="/assets/js/app.6cebae64.js" defer></script><script src="/assets/js/3.c73bb120.js" defer></script><script src="/assets/js/5.7ef9e7ae.js" defer></script><script src="/assets/js/60.5ae11b84.js" defer></script>
  </body>
</html>
