<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Paxos | 软件架构探索：The Fenix Project</title>
    <meta name="description" content="现代软件架构探索">
    <meta name="generator" content="VuePress 1.4.0">
    <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico">
    
    <link rel="preload" href="/assets/css/0.styles.fc95d210.css" as="style"><link rel="preload" href="/assets/js/app.085dd782.js" as="script"><link rel="preload" href="/assets/js/3.058cc938.js" as="script"><link rel="preload" href="/assets/js/5.c1e0bc21.js" as="script"><link rel="preload" href="/assets/js/7.b072c099.js" as="script"><link rel="preload" href="/assets/js/11.bfb1e614.js" as="script"><link rel="prefetch" href="/assets/js/1.2cf50ddc.js"><link rel="prefetch" href="/assets/js/10.d56a1df2.js"><link rel="prefetch" href="/assets/js/100.f83cd9ee.js"><link rel="prefetch" href="/assets/js/101.519f194b.js"><link rel="prefetch" href="/assets/js/102.bb2a286c.js"><link rel="prefetch" href="/assets/js/103.86c2fa5a.js"><link rel="prefetch" href="/assets/js/104.dfd62379.js"><link rel="prefetch" href="/assets/js/105.c5bd2b56.js"><link rel="prefetch" href="/assets/js/106.82914855.js"><link rel="prefetch" href="/assets/js/107.95637396.js"><link rel="prefetch" href="/assets/js/108.ba8787e7.js"><link rel="prefetch" href="/assets/js/109.b007a8e9.js"><link rel="prefetch" href="/assets/js/110.d7d73ec7.js"><link rel="prefetch" href="/assets/js/111.fc51c988.js"><link rel="prefetch" href="/assets/js/112.5fba1ad6.js"><link rel="prefetch" href="/assets/js/113.01dfa418.js"><link rel="prefetch" href="/assets/js/114.a8556de8.js"><link rel="prefetch" href="/assets/js/115.12da2301.js"><link rel="prefetch" href="/assets/js/116.7df9fce5.js"><link rel="prefetch" href="/assets/js/117.2e769c15.js"><link rel="prefetch" href="/assets/js/118.1c276474.js"><link rel="prefetch" href="/assets/js/119.5748d724.js"><link rel="prefetch" href="/assets/js/12.38a00e84.js"><link rel="prefetch" href="/assets/js/120.55e0e17d.js"><link rel="prefetch" href="/assets/js/121.68a93bd4.js"><link rel="prefetch" href="/assets/js/122.b8a386ac.js"><link rel="prefetch" href="/assets/js/123.6b475c95.js"><link rel="prefetch" href="/assets/js/124.25dd1fd5.js"><link rel="prefetch" href="/assets/js/125.1fa27969.js"><link rel="prefetch" href="/assets/js/126.d1707399.js"><link rel="prefetch" href="/assets/js/127.5cda015f.js"><link rel="prefetch" href="/assets/js/128.1cd71f01.js"><link rel="prefetch" href="/assets/js/129.620bf3ef.js"><link rel="prefetch" href="/assets/js/13.d1ad87b4.js"><link rel="prefetch" href="/assets/js/130.52e6ff9a.js"><link rel="prefetch" href="/assets/js/131.9b54d47e.js"><link rel="prefetch" href="/assets/js/132.34ee0496.js"><link rel="prefetch" href="/assets/js/133.e3ae0747.js"><link rel="prefetch" href="/assets/js/134.845386a6.js"><link rel="prefetch" href="/assets/js/135.ce5c825c.js"><link rel="prefetch" href="/assets/js/136.96bbc692.js"><link rel="prefetch" href="/assets/js/137.b0368958.js"><link rel="prefetch" href="/assets/js/138.75497d6b.js"><link rel="prefetch" href="/assets/js/139.850c4b2f.js"><link rel="prefetch" href="/assets/js/14.ae1c967d.js"><link rel="prefetch" href="/assets/js/140.42b5f6ae.js"><link rel="prefetch" href="/assets/js/141.4d303770.js"><link rel="prefetch" href="/assets/js/142.3bbdad5a.js"><link rel="prefetch" href="/assets/js/143.924cebea.js"><link rel="prefetch" href="/assets/js/144.745ea0e0.js"><link rel="prefetch" href="/assets/js/145.38ea9930.js"><link rel="prefetch" href="/assets/js/146.fca0d9f8.js"><link rel="prefetch" href="/assets/js/147.d2b668e7.js"><link rel="prefetch" href="/assets/js/148.120e3464.js"><link rel="prefetch" href="/assets/js/149.b59441b2.js"><link rel="prefetch" href="/assets/js/15.1ae41958.js"><link rel="prefetch" href="/assets/js/150.4eb7f462.js"><link rel="prefetch" href="/assets/js/16.a3562dce.js"><link rel="prefetch" href="/assets/js/17.f25e6c71.js"><link rel="prefetch" href="/assets/js/18.d6d8850d.js"><link rel="prefetch" href="/assets/js/19.7540559c.js"><link rel="prefetch" href="/assets/js/20.1e729858.js"><link rel="prefetch" href="/assets/js/21.3337fd31.js"><link rel="prefetch" href="/assets/js/22.e13e40e8.js"><link rel="prefetch" href="/assets/js/23.4c3ac535.js"><link rel="prefetch" href="/assets/js/24.1f1c6382.js"><link rel="prefetch" href="/assets/js/25.fb3bee1e.js"><link rel="prefetch" href="/assets/js/26.96945092.js"><link rel="prefetch" href="/assets/js/27.67d7c6bc.js"><link rel="prefetch" href="/assets/js/28.fb0fe876.js"><link rel="prefetch" href="/assets/js/29.f76563b7.js"><link rel="prefetch" href="/assets/js/30.8cc3c5bd.js"><link rel="prefetch" href="/assets/js/31.71123d40.js"><link rel="prefetch" href="/assets/js/32.a5330eb0.js"><link rel="prefetch" href="/assets/js/33.5e3da3ae.js"><link rel="prefetch" href="/assets/js/34.346fa0c8.js"><link rel="prefetch" href="/assets/js/35.47a4d2ac.js"><link rel="prefetch" href="/assets/js/36.db541fd8.js"><link rel="prefetch" href="/assets/js/37.24d47cd4.js"><link rel="prefetch" href="/assets/js/38.1e8cf702.js"><link rel="prefetch" href="/assets/js/39.7818eaa7.js"><link rel="prefetch" href="/assets/js/4.f00ee938.js"><link rel="prefetch" href="/assets/js/40.06fa0f13.js"><link rel="prefetch" href="/assets/js/41.00cbac92.js"><link rel="prefetch" href="/assets/js/42.26a38600.js"><link rel="prefetch" href="/assets/js/43.4be39ef9.js"><link rel="prefetch" href="/assets/js/44.3a1f10f9.js"><link rel="prefetch" href="/assets/js/45.14b44614.js"><link rel="prefetch" href="/assets/js/46.c6e9c085.js"><link rel="prefetch" href="/assets/js/47.89ee01dc.js"><link rel="prefetch" href="/assets/js/48.4efbbf79.js"><link rel="prefetch" href="/assets/js/49.e5f58c91.js"><link rel="prefetch" href="/assets/js/50.d1817664.js"><link rel="prefetch" href="/assets/js/51.31f7557f.js"><link rel="prefetch" href="/assets/js/52.ea723c3c.js"><link rel="prefetch" href="/assets/js/53.ef7084ba.js"><link rel="prefetch" href="/assets/js/54.3825121b.js"><link rel="prefetch" href="/assets/js/55.c23aa11d.js"><link rel="prefetch" href="/assets/js/56.da2d4a3d.js"><link rel="prefetch" href="/assets/js/57.7cf8ed22.js"><link rel="prefetch" href="/assets/js/58.ff074c30.js"><link rel="prefetch" href="/assets/js/59.282a0133.js"><link rel="prefetch" href="/assets/js/6.2202940e.js"><link rel="prefetch" href="/assets/js/60.d60bb663.js"><link rel="prefetch" href="/assets/js/61.c0747f90.js"><link rel="prefetch" href="/assets/js/62.b82e5947.js"><link rel="prefetch" href="/assets/js/63.440324b6.js"><link rel="prefetch" href="/assets/js/64.e4ec2586.js"><link rel="prefetch" href="/assets/js/65.bd1509fc.js"><link rel="prefetch" href="/assets/js/66.f0cb4543.js"><link rel="prefetch" href="/assets/js/67.70c9f878.js"><link rel="prefetch" href="/assets/js/68.cebd1b92.js"><link rel="prefetch" href="/assets/js/69.36088d82.js"><link rel="prefetch" href="/assets/js/70.40c783d5.js"><link rel="prefetch" href="/assets/js/71.e88120bf.js"><link rel="prefetch" href="/assets/js/72.39961bff.js"><link rel="prefetch" href="/assets/js/73.97768db8.js"><link rel="prefetch" href="/assets/js/74.c06169b5.js"><link rel="prefetch" href="/assets/js/75.d090c05d.js"><link rel="prefetch" href="/assets/js/76.c39f8f39.js"><link rel="prefetch" href="/assets/js/77.e57c1dd8.js"><link rel="prefetch" href="/assets/js/78.88c9f162.js"><link rel="prefetch" href="/assets/js/79.3c11a088.js"><link rel="prefetch" href="/assets/js/8.8e922ab9.js"><link rel="prefetch" href="/assets/js/80.b55dd614.js"><link rel="prefetch" href="/assets/js/81.326fc3f1.js"><link rel="prefetch" href="/assets/js/82.39b5492d.js"><link rel="prefetch" href="/assets/js/83.34e4531d.js"><link rel="prefetch" href="/assets/js/84.64d5b702.js"><link rel="prefetch" href="/assets/js/85.329946c4.js"><link rel="prefetch" href="/assets/js/86.eb63b9bd.js"><link rel="prefetch" href="/assets/js/87.3f2b59e0.js"><link rel="prefetch" href="/assets/js/88.cbb8dec9.js"><link rel="prefetch" href="/assets/js/89.23647228.js"><link rel="prefetch" href="/assets/js/9.a2fa0c6e.js"><link rel="prefetch" href="/assets/js/90.315dce4f.js"><link rel="prefetch" href="/assets/js/91.fbcf0ba5.js"><link rel="prefetch" href="/assets/js/92.dfa95c74.js"><link rel="prefetch" href="/assets/js/93.5bcbda45.js"><link rel="prefetch" href="/assets/js/94.214c48e2.js"><link rel="prefetch" href="/assets/js/95.e79c6947.js"><link rel="prefetch" href="/assets/js/96.e81694ac.js"><link rel="prefetch" href="/assets/js/97.50dc5eb3.js"><link rel="prefetch" href="/assets/js/98.f389a891.js"><link rel="prefetch" href="/assets/js/99.b4ab2e82.js">
    <link rel="stylesheet" href="/assets/css/0.styles.fc95d210.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/images/logo-color.png" alt="软件架构探索：The Fenix Project" class="logo"> <span class="site-name can-hide">软件架构探索：The Fenix Project</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="代码" class="dropdown-title"><span class="title">代码</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/fenixsoft/awesome-fenix" target="_blank" rel="noopener noreferrer" class="nav-link external">
  文档工程 Awesome-Fenix
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/fenixsoft/fenix-bookstore-frontend" target="_blank" rel="noopener noreferrer" class="nav-link external">
  前端工程 Fenix's Bookstore
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://bookstore.icyfenix.cn" target="_blank" rel="noopener noreferrer" class="nav-link external">
  前端工程在线示例 Fenix's Bookstore
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/fenixsoft/monolithic_arch_springboot" target="_blank" rel="noopener noreferrer" class="nav-link external">
  后端：单体架构 Spring Boot
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/fenixsoft/microservice_arch_springcloud" target="_blank" rel="noopener noreferrer" class="nav-link external">
  后端：微服务架构 Spring Cloud
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/fenixsoft/microservice_arch_kubernetes" target="_blank" rel="noopener noreferrer" class="nav-link external">
  后端：微服务架构 Kubernetes
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/fenixsoft/servicemesh_arch_istio" target="_blank" rel="noopener noreferrer" class="nav-link external">
  后端：微服务架构 Istio
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/fenixsoft/serverless_arch" target="_blank" rel="noopener noreferrer" class="nav-link external">
  后端：无服务架构 Serverless
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div><div class="nav-item"><a href="https://icyfenix.cn/pdf/the-fenix-project.pdf" target="_blank" rel="noopener noreferrer" class="nav-link external">
  PDF下载
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="/board.html" class="nav-link">
  讨论区
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="代码" class="dropdown-title"><span class="title">代码</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/fenixsoft/awesome-fenix" target="_blank" rel="noopener noreferrer" class="nav-link external">
  文档工程 Awesome-Fenix
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/fenixsoft/fenix-bookstore-frontend" target="_blank" rel="noopener noreferrer" class="nav-link external">
  前端工程 Fenix's Bookstore
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://bookstore.icyfenix.cn" target="_blank" rel="noopener noreferrer" class="nav-link external">
  前端工程在线示例 Fenix's Bookstore
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/fenixsoft/monolithic_arch_springboot" target="_blank" rel="noopener noreferrer" class="nav-link external">
  后端：单体架构 Spring Boot
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/fenixsoft/microservice_arch_springcloud" target="_blank" rel="noopener noreferrer" class="nav-link external">
  后端：微服务架构 Spring Cloud
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/fenixsoft/microservice_arch_kubernetes" target="_blank" rel="noopener noreferrer" class="nav-link external">
  后端：微服务架构 Kubernetes
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/fenixsoft/servicemesh_arch_istio" target="_blank" rel="noopener noreferrer" class="nav-link external">
  后端：微服务架构 Istio
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/fenixsoft/serverless_arch" target="_blank" rel="noopener noreferrer" class="nav-link external">
  后端：无服务架构 Serverless
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div><div class="nav-item"><a href="https://icyfenix.cn/pdf/the-fenix-project.pdf" target="_blank" rel="noopener noreferrer" class="nav-link external">
  PDF下载
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="/board.html" class="nav-link">
  讨论区
</a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/summary/" class="sidebar-link">目录</a></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>前言</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/introduction/about-me.html" class="sidebar-link">✔️ 关于作者</a></li><li><a href="/introduction/about-the-fenix-project.html" class="sidebar-link">✔️ 什么是“The Fenix Project”</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>探索起步</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading open"><span>阅读指引</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/changelog/" class="sidebar-link">✔️ 更新日志</a></li><li><a href="/exploration/guide/quick-start.html" class="sidebar-link">✔️ 如何开始</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><a href="/exploration/projects/" class="sidebar-heading clickable"><span>✔️ 技术演示工程</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/exploration/projects/fenix-bookstore-frontend.html" class="sidebar-link">✔️ 前端工程</a></li><li><a href="/exploration/projects/monolithic_arch_springboot.html" class="sidebar-link">✔️ 单体架构：Spring Boot</a></li><li><a href="/exploration/projects/microservice_arch_springcloud.html" class="sidebar-link">✔️ 微服务：Spring Cloud</a></li><li><a href="/exploration/projects/microservice_arch_kubernetes.html" class="sidebar-link">✔️ 微服务：Kubernetes</a></li><li><a href="/exploration/projects/servicemesh_arch_istio.html" class="sidebar-link">✔️ 服务网格：Istio</a></li><li><a href="/exploration/projects/serverless_arch.html" class="sidebar-link">无服务：Serverless</a></li></ul></section></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>演进中的架构</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group is-sub-group depth-1"><a href="/architecture/architect-history/" class="sidebar-heading clickable open"><span>✔️ 服务架构演进史</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/architecture/architect-history/primitive-distribution.html" class="sidebar-link">✔️ 原始分布式时代</a></li><li><a href="/architecture/architect-history/monolithic.html" class="sidebar-link">✔️ 单体系统时代</a></li><li><a href="/architecture/architect-history/soa.html" class="sidebar-link">✔️ SOA时代</a></li><li><a href="/architecture/architect-history/microservices.html" class="sidebar-link">✔️ 微服务时代</a></li><li><a href="/architecture/architect-history/post-microservices.html" class="sidebar-link">✔️ 后微服务时代</a></li><li><a href="/architecture/architect-history/serverless.html" class="sidebar-link">✔️ 无服务时代</a></li></ul></section></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>设计者的视角</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group is-sub-group depth-1"><a href="/architect-perspective/general-architecture/" class="sidebar-heading clickable open"><span>✔️ 架构的普适问题</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group collapsable is-sub-group depth-2"><a href="/architect-perspective/general-architecture/api-style/" class="sidebar-heading clickable open"><span>✔️ 服务风格设计</span> <span class="arrow down"></span></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/architect-perspective/general-architecture/api-style/rpc.html" class="sidebar-link">✔️ 远程服务调用</a></li><li><a href="/architect-perspective/general-architecture/api-style/rest.html" class="sidebar-link">✔️ RESTful服务</a></li><li><a href="/architect-perspective/general-architecture/api-style/mq.html" class="sidebar-link">异步服务调用</a></li></ul></section></li><li><section class="sidebar-group collapsable is-sub-group depth-2"><a href="/architect-perspective/general-architecture/transaction/" class="sidebar-heading clickable"><span>✔️ 事务处理</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-2"><a href="/architect-perspective/general-architecture/diversion-system/" class="sidebar-heading clickable"><span>✔️ 透明多级分流系统</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-2"><a href="/architect-perspective/general-architecture/system-security/" class="sidebar-heading clickable"><span>✔️ 安全架构</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-2"><a href="/architect-perspective/general-architecture/concurrent/" class="sidebar-heading clickable"><span>高效并发</span> <span class="arrow right"></span></a> <!----></section></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>设计方法论</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/architect-perspective/methodology/layered-system.html" class="sidebar-link">系统分层</a></li><li><a href="/architect-perspective/methodology/capacity-design.html" class="sidebar-link">容量规划</a></li><li><a href="/architect-perspective/methodology/constraint.html" class="sidebar-link">非功能属性设计</a></li></ul></section></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>分布式的基石</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group is-sub-group depth-1"><a href="/distribution/consensus/" class="sidebar-heading clickable router-link-active open"><span>✔️ 分布式共识算法</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/distribution/consensus/paxos.html" class="active sidebar-link">✔️ Paxos</a></li><li><a href="/distribution/consensus/raft.html" class="sidebar-link">✔️ Multi Paxos与Raft</a></li><li><a href="/distribution/consensus/gossip.html" class="sidebar-link">✔️ Gossip协议</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>服务互联</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/distribution/connect/service-discovery.html" class="sidebar-link">✔️ 服务发现</a></li><li><a href="/distribution/connect/service-routing.html" class="sidebar-link">✔️ 网关路由</a></li><li><a href="/distribution/connect/load-balancing.html" class="sidebar-link">进程内负载均衡</a></li><li><a href="/distribution/connect/composer.html" class="sidebar-link">服务编排</a></li><li><a href="/distribution/connect/configuration.html" class="sidebar-link">中心化配置</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>流量管控</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/distribution/traffic-management/isolation.html" class="sidebar-link">隔离</a></li><li><a href="/distribution/traffic-management/breaker.html" class="sidebar-link">熔断</a></li><li><a href="/distribution/traffic-management/timeout.html" class="sidebar-link">超时</a></li><li><a href="/distribution/traffic-management/traffic-control.html" class="sidebar-link">流控</a></li><li><a href="/distribution/traffic-management/service-downgrade.html" class="sidebar-link">降级</a></li><li><a href="/distribution/traffic-management/exception-inject.html" class="sidebar-link">异常注入</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>可靠通讯</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/distribution/secure/traffic-encryption.html" class="sidebar-link">流量加密</a></li><li><a href="/distribution/secure/access-policies.html" class="sidebar-link">访问策略</a></li><li><a href="/distribution/secure/auditing.html" class="sidebar-link">事件审计</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>可观测性</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/distribution/observability/logging.html" class="sidebar-link">日志聚合</a></li><li><a href="/distribution/observability/invokechain-trace.html" class="sidebar-link">链路跟踪</a></li><li><a href="/distribution/observability/apm.html" class="sidebar-link">应用性能管理</a></li></ul></section></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>不可变基础设施</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/immutable-infrastructure/history.html" class="sidebar-link">虚拟化的概念与历史</a></li><li><section class="sidebar-group is-sub-group depth-1"><a href="/immutable-infrastructure/container/" class="sidebar-heading clickable"><span>虚拟化容器</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/immutable-infrastructure/container/cri.html" class="sidebar-link">CRI接口</a></li><li><a href="/immutable-infrastructure/container/resource-isolation.html" class="sidebar-link">资源隔离</a></li><li><a href="/immutable-infrastructure/container/resource.html" class="sidebar-link">资源对象</a></li><li><a href="/immutable-infrastructure/container/manage.html" class="sidebar-link">容器管理</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><a href="/immutable-infrastructure/network/" class="sidebar-heading clickable"><span>容器间网络</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/immutable-infrastructure/network/cni.html" class="sidebar-link">CNI接口</a></li><li><a href="/immutable-infrastructure/network/strategy.html" class="sidebar-link">网络策略</a></li><li><a href="/immutable-infrastructure/network/plugin.html" class="sidebar-link">网络插件</a></li><li><a href="/immutable-infrastructure/network/container-lb.html" class="sidebar-link">容器负载均衡</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><a href="/immutable-infrastructure/storage/" class="sidebar-heading clickable"><span>配置与数据持久化</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/immutable-infrastructure/storage/csi.html" class="sidebar-link">CSI接口</a></li><li><a href="/immutable-infrastructure/storage/dfs.html" class="sidebar-link">分布式文件系统</a></li><li><a href="/immutable-infrastructure/storage/storage-plugins.html" class="sidebar-link">共享存储插件</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><a href="/immutable-infrastructure/gpu/" class="sidebar-heading clickable"><span>GPU虚拟化</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/immutable-infrastructure/gpu/device-plugin.html" class="sidebar-link">Device Plugin机制</a></li><li><a href="/immutable-infrastructure/gpu/gpu-schedule.html" class="sidebar-link">调度GPU</a></li><li><a href="/immutable-infrastructure/gpu/nvidia.html" class="sidebar-link">Nvidia插件</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><a href="/immutable-infrastructure/extension/" class="sidebar-heading clickable"><span>扩展基础设施</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/immutable-infrastructure/extension/crd.html" class="sidebar-link">CRD定义</a></li><li><a href="/immutable-infrastructure/extension/api-server.html" class="sidebar-link">自定义API Server</a></li></ul></section></li><li><a href="/immutable-infrastructure/hardware-schedule.html" class="sidebar-link">硬件资源调度</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>技巧与专题</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group is-sub-group depth-1"><a href="/tricks/graalvm/" class="sidebar-heading clickable open"><span>✔️ Graal VM</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/tricks/graalvm/graal-compiler.html" class="sidebar-link">✔️ 新一代即时编译器</a></li><li><a href="/tricks/graalvm/substratevm.html" class="sidebar-link">✔️ 向原生迈进</a></li><li><a href="/tricks/graalvm/graalvm-native.html" class="sidebar-link">✔️ 没有虚拟机的Java</a></li><li><a href="/tricks/graalvm/spring-over-graal.html" class="sidebar-link">✔️ Spring over Graal</a></li></ul></section></li><li><a href="/tricks/responsive-programming.html" class="sidebar-link">响应式编程</a></li><li><a href="/tricks/lambda-stream.html" class="sidebar-link">函数式接口与流式编程思想</a></li><li><a href="/tricks/aio.html" class="sidebar-link">并行、异步、非阻塞</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>附录</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/appendix/build-script.html" class="sidebar-link">构建发布脚本</a></li><li><a href="/appendix/continuous-integration.html" class="sidebar-link">持续集成</a></li><li><a href="/appendix/gated-launch.html" class="sidebar-link">灰度发布</a></li><li><section class="sidebar-group is-sub-group depth-1"><a href="/appendix/deployment-env-setup/" class="sidebar-heading clickable"><span>✔️ 环境依赖</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/appendix/deployment-env-setup/setup-docker.html" class="sidebar-link">✔️ 部署Docker CE容器环境</a></li><li><section class="sidebar-group collapsable is-sub-group depth-2"><a href="/appendix/deployment-env-setup/setup-kubernetes/" class="sidebar-heading clickable"><span>✔️ 部署Kubernetes集群</span> <span class="arrow right"></span></a> <!----></section></li></ul></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/appendix/operation-env-setup/" class="sidebar-heading clickable"><span>运维环境</span> <span class="arrow right"></span></a> <!----></section></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="paxos">Paxos</h1> <div class="custom-block tip"><p class="custom-block-title">Distributed Consensus Algorithm</p> <p>There is only one consensus protocol, and that's “Paxos” — all other approaches are just broken versions of Paxos</p> <p>世界上只有一种共识协议，就是Paxos，其他所有共识算法都是Paxos的退化版本。</p> <div class="custom-block right"><p>—— <a href="https://en.wikipedia.org/wiki/Michael_Burrows" target="_blank" rel="noopener noreferrer">Mike Burrows<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>，Inventor of Google Chubby</p></div></div> <p>Paxos是由<a href="https://en.wikipedia.org/wiki/Leslie_Lamport" target="_blank" rel="noopener noreferrer">Leslie Lamport<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>（就是大名鼎鼎的<a href="https://en.wikipedia.org/wiki/LaTeX" target="_blank" rel="noopener noreferrer">LaTeX<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>中的“La”）提出的一种基于消息传递的协商共识算法，现已是当今分布式系统最重要的理论基础，几乎就是“共识”二字的代名词（这句话是Raft作者在论文中说的）。尽管不像Mike Burrows说的“世界上只有Paxos一种分布式共识算法”那么夸张，但是如果没有Paxos，那后续的Raft、ZAB算法，ZooKeeper、etcd这些分布式协调框架、Hadoop、Consul等在此基础上的各类分布式应用都很可能会延后几年面世。</p> <p>Lamport虚构了一个名为“Paxos”的希腊城邦，这个城邦按照民主制度制定法律，却又不存在一个中心化的专职立法机构，立法靠着“兼职议会”（Part-Time Parliament）来完成，无法保证所有城邦居民都能够及时地了解新的法律提案、也无法保证居民会及时为提案投票。Paxos算法的目标就是让城邦能够在每一位居民都无法承诺一定会及时参与的情况下，依然可以按照少数服从多数的原则，最终达成一致意见（但是并不考虑<a href="https://en.wikipedia.org/wiki/Byzantine_fault" target="_blank" rel="noopener noreferrer">拜占庭将军问题<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>，即假设信息可能丢失也可能延迟，但不会被错误传递）。</p> <p>Lamport最初在1990年首次发表了Paxos算法，选的题目就是“<a href="https://lamport.azurewebsites.net/pubs/lamport-paxos.pdf" target="_blank" rel="noopener noreferrer">The Part-Time Parliament<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>”。由于算法本身较为复杂，用希腊城邦作为比喻反而使得描述更为晦涩，论文的三个审稿人一致要求他把希腊城邦的故事删除掉，这令Lamport感觉颇为不爽，然后干脆就撤稿不发了，所以Paxos刚刚被提出的时候并没有引起什么反响。八年之后（1998年），Lamport再次将此文章重新整理后投到《<a href="https://dl.acm.org/journal/tocs" target="_blank" rel="noopener noreferrer">ACM Transactions on Computer Systems<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>》，这次论文成功发表，吸引了一些人去研究，结果是并没有什么人能弄懂。时间又过去了三年（2001年），Lamport认为前两次是同行们无法理解他以“希腊城邦”来讲故事的幽默感，第三次以“<a href="https://lamport.azurewebsites.net/pubs/paxos-simple.pdf" target="_blank" rel="noopener noreferrer">Paxos Made Simple<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>”为题，在《<a href="https://www.sigact.org/SIGACT_News/" target="_blank" rel="noopener noreferrer">SIGACT News<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>》杂志上发表文章，终于放弃了“希腊城邦”的比喻，尽可能用（他认为）简单直接、（他认为）可读性较强的方式去介绍Paxos算法，情况虽然比前两次要好，但以Paxos本应获得的重视程度来说，这次依然只能算是应者寥寥。这段跟网络段子一般的经历被Lamport以自嘲的形式放到了<a href="http://lamport.azurewebsites.net/pubs/pubs.html#lamport-paxos" target="_blank" rel="noopener noreferrer">他自己的个人网站<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>上。尽管我们作为后辈应该尊重Lamport老爷子，但当笔者翻开“Paxos Made Simple”读到只有一句话的“摘要”时，心里实在是不得不怀疑Lamport这样写论文是不是在恶搞审稿人和读者，在嘲讽“你们这些愚蠢的人类！”。</p> <div class="custom-block center"><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAicAAALnCAMAAABlZhdbAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyFpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNS1jMDE0IDc5LjE1MTQ4MSwgMjAxMy8wMy8xMy0xMjowOToxNSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIChXaW5kb3dzKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpGQ0VBRDE0RjkwNjcxMUVBOUE0RjgzMzJCRTI3NURDMyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDpGQ0VBRDE1MDkwNjcxMUVBOUE0RjgzMzJCRTI3NURDMyI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDRUFEMTREOTA2NzExRUE5QTRGODMzMkJFMjc1REMzIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOkZDRUFEMTRFOTA2NzExRUE5QTRGODMzMkJFMjc1REMzIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+hLP0FwAAAYBQTFRFta2orNX0V3ihmnFL582xbV91dIea5v3+/eiup4pyGyZcVCYYjdT6+9WLJmy+RRpV55VGx7KmIA0c//vWkK/Y/eiX///82Pr+8dvAaLfz8/7/+cl52L+xVYnRzdXooLDOrpuHhJiz7rVr///zz6puWKjy2rCOQEhwlUUMElKjkUQiqfb/nKa5x9HE/v3k+P//e6XO//7rlI+XqKaj/OrT5ruNb0guesj50er9t/b/w/j/8KdWeTMcMXnHt2oyZJPDsMnk/vfCvd750I1XyHgxxOj6///4oFAQLUiL1IM4k7nilOL8o52fPorZ28Kav5prIWW3E0KRqeT9++G8lX1z//fo9+ziFDlwls/Ht3tR1uDL5fbZxZuXiVpE6PnpSJjmpl8uocayo8XlzfjoWH687fT7nJvFxunj3ebiQWea6dza+vPx8+/x9//54e359P3v8v7zlp+U3t/quWch8PTi9/Xp/vPZ8/j+vL2+3qRk3Prkfn18GV2u/vn0AAAA////S0vYTgAAD99JREFUeNrs3IlbU1fCwGFQMJqwaKIJi1IxBdQqYRMt4gJKRAW1ojK0UqljnaGtbW07il+U+6/PuVlYFKu2tn7z+L7PQ4PJzc3Jub+cLH1I3Sq8WZ0p4O06ieD36QSdoBN0gk7QCTpBJ6ATdIJO0Ak6QSfoBHSCTtAJOkEn6ASdgE7QCTpBJ+gEnaAT0Ak6QSfoBJ2gE3QCOkEn6ASdoBN0gk5AJ+gEnaATdIJO0Ak6AZ2gE3SCTtAJOkEnoBN0gk7QCTpBJ+gEdIJO0Ak6QSfoBJ2ATtAJOkEn6ASdoBPQCTpBJ+gEnaATdAI6QSfoBJ2gE3SCTtAJ6ASdoBN0gk7QCToBnaATdIJO0Ak6QSegE3SCTtAJOkEn6AR0gk7QCTpBJ+gEnYBO0Ak6QSfoBJ2gE9AJOkEn6ASdoBN0gk5AJ+gEnaATdIJO0AnoBJ2gE3SCTtAJOgGdoBN0gk7QCTpBJ6ATdIJO0Ak6QSfoBHSCTtAJOkEn6ASdgE7QCTpBJ+gEnaATdAI6QSfoBJ2gE3SCTkAn6ASdoBN0gk7QCegEnaATdIJO0Ak6AZ2gE3SCTtAJOkEnoBN0gk7QCTpBJ+gEdIJO0Ak6QSfoBJ2gE9AJOkEn6ASdoBN0AjpBJ+gEnaATdIJOQCfoBJ2gE3SCTtAJ6ASdoBN0gk7QCToBnaATdIJO0Ak6QSegE3SCTtAJOkEn6ASdgE7QyR9258fKafGHb1Wgk9fpP3wkEZ/uHF+dLWy65EnX66+V/e5HnXxUmtPppuovs5svOX2m8NprFZdO6uRjUryYXq30EDrJbrxk8NKZ119tZ0onH5WdfddXk5/Hv3WmzxwsdU9GUeZuqTRUP7e4Ol/a23+3NHCtdKWQ7y017piMn4wONjYOJHpTq8ulep18NLK7z0yMr/YUyutJ8spvF9Lt+bOzhSdLPSPX089XuvLXUvM7LiWvdqZn+8+mT4Z1ZHrq9Oq9hqX0uZVTOvloZBabipdXv0iU15OWQjSRmv/n4fnurrbJeH0J+UyMJz+71p2Yu3U/PqN4drU9mivVP7qY9rzzMelsLZUWV8sHvTnuJDOevnoitbo6X1/tJDM+PxYuzPc2Ni6utmQOV170ZnXyUcmfPXf8+PFLq6GQ2nqS/Oz4V/tvpZ7HnfTP5EInubDdxXRPR9jgp6OVPuJO5vYWdPKR2Nc3Vn7GSd6M15PnHeE/N74aPxletjyP15eJxrFKJ5nx8Fr3ULrl0en4Q5bOA9nLqyc7H+jk4zC4kEov56Lm0fTq/IOoubXUWEot5zJH+0q3+pqizFK68Vx48Zrs+zwqPkv3lXaMph8MXk/1NS5PRXPj841Nnnc+Uvkf4v8+Ld75sfxJyosNH+Rn/1P9R7by8f6jH372+gR0gk7QCTpBJ+gEnYBO0Ak6QSfoBJ2gE9AJOkEn6ASdoBN0An+skxfv49uH3ryTt72Z75++9xkp/lD4S+Zg01CzP/yVfy324tsP0knxYl+plAo/oz29qZaX7+DcrVSyVCo1vvX3PWRPpG5sOUvZQ9tylV+2uJmt9C+k29/3hMwtJseqOx8ovGn4ayPeMBnzYTJG4780fHWoOxtvrt3I51vf9Xextru3nN+/upPs9ptR/+Eb5b+c3P3qEPKXnheiR7uTN986lN2vuR/PlnNR8e7Y72zx8uwf/fOdTDzcfFP7WqudbD9XeOPw4xFvMhhPRlRcOLnVUJvX/phwX+vnr971d9X8mr9NfNvZe9+d9A91VDqZePjaTqLm9L0/3Uks0/g3d9L80h8MN/eN/Ynhh8noiF4Umq/8/lBf6eR9+lCdDHZFlU7yXWEIbcOfJMJ5e4Y/6djYSWdYV5/UzZyPoraVla7+/StdUX7/8LHwKGkbrqubrGzaNjwzVb0fg3tm/rVnKBfOGp6s/OP+k7pjiZGzyWMridrNNMzcbxu+3zFXvsnaLDSsrHwZbmJkZeVUmPz9M/ET3khdOClvXd0yG/7RMHO+I5yebziWqGxQHUp57CN1x77ac+xUsWH8SN356g7CyZ5PrlXXk7aZ+1vusTr8/TPh/PKIKzvasJ6EJXGwa/3shuHzDUP1Yaj5/TOT4SrDK+dDJ/9av04Q72h9ouK7eGpw/8pUtmH42KnK5MythKs1rJwvFxBmtu6Tr8PuwmVT+4cni2FgLw9w/QD9na9jy53Eh3h+709nZ6PMYnv+woHCWifZtsXlRGax6cnSvWjkerq9/+i2+v7t7dnmxps7tz0tXqgsw83Luea++vL96F9qnxhvv5t79iCR2d4+eC217dPk7U+Tn498mvxHV0ftZtqWpsPp8t6fL65/aVo4sjf+fSFZ/2RpOXSyXL9zvCmsAVOZxZOVrStfy5dtuzR/5beF5UTbpelvxtsrG1SGUhn7b9eT3blD07m2pefHu6o7iE40Tj1ZqL4+GVm6Udhyj/HwsxcO5J9NJ+IRP6nuqPagmR+6Fa9ItbOzz5YTF1uuxZ0UG1Ltgws3wwoWOjm3fp0g3tH6RGVDvKcGF5anLiwnmvty5ckZWUg2FTv77pfn/NBA4UnjWNhdPlwWZmBH/cT4yWjjADceoA/SyReJaPfzR6fDSW3tjKdmaCb+hrMw0/EF0e7pa+E14Onp8OvFluZw3+Yma0t6/tK9cifNrZ9lL7YUdrZeDUtRciwz3hM9Le+xMzm2djOFyukXuej0kY4Ny+qRxL7Wq/ELmf7D96L80Z7BS7OFaHdL7VqVzS6Xv9ekJ7p8JPGiukFlKNWxh12EkzCKM+HBV7k8lBsGWe2knMNWe6x08qA89njE1R3V1pMj/26InzprZ/cf7infp/h5J/xkRgcSt1c2X6f6RLRhoqJD87ni3fIQ8+E65cmJS2i4Xx3J8lS0PxfvcjDMQPHwbJS91LNpgBsP0AfpJEza7iOPfp0fHh5uHKt2UjuITw4ObY87GVx6noiKvz6Pl8D5fy6k07X3MQ1Dj8dny0dgItWUX7qXPRS/7t/XejIzfrL6rN3ZN7Z2Mx2100p+63N6s3dxNn792X+0JxyZnonU8vDwrnNrW5dvK560/KWWQmXyyhv0l4dSHXt8mGqdVC9vjqttbt3YyVZ7LC/rvUMH1zr5bP2YlxfXPbninkT17Pyvs4X4EVPtJDqRWp2u33ydaieD6xMVomgP9+9Qunt4+FZ1crKXb/x8t3rxztHV5EChssvyDETlx9/6ADcdoA/YycUNj++1TnaGh+PpL3JPo8yuVHt4N32k3MmXp/5zbXS28uZvfqr46+z38RHI79rxuDsRdcZztS/d1L/eSXJsbvL3Oxm8dOBh5/S1pqgyS4d7JsIDbn1wG47q4OEzhctxB5UNRspDqY59Qyf7v6pc3py++vJ6stUey0+bZxITqavfvtJJ5f1OlOku1M4+UXpcmopqnfR3PWrbPr1lJyNrExWvGM976yuzE65anpywyTd7qyvqd4mRT1ub1jo5vKGTygA3HaAP10lHZ5if8jvYjZ2cns+Fhfpa/eDdm82tN8urbX5ptvNAeGZ5UNlwNl7h70bxelLKVR834XrTufX1JDycT9RHW3SS7V37xqvTySuZo/FDrzpLxcs3OqLMw5eOaljO9rU2ZeNOqhtUhlIde62Tyy2P7uYql2fC7ipPfFt3Ut1juCCchF//8XCr9STe+tCB2tnFC01r73fCz0RjLppoXLtOZlf9WifrE1X+97ZElCk/D96vTE6YuunqjRQXmqLswslXO1kfYPVOznXn/s5O+g+WUskdewvZE6PJgWvhJ9HbeOxg5b3f3K5w0VT5HcLoQN3j0R11o+E12XiyO2wzvOtBorPv2Mqt8mcr2Wd93xzc1dcd7+Sns+lkOrymnWvsPtg4GRag5b3R3Pb0g1xm8dxQrnYzvdXT8HPu66X52jK6s+/z7IXwyOu/npq+H/9kFrbVDU2uDa5yVOe79ywOPOodnQ9zVdmgMpRieezhxrYdDz9TzX2PBwqVy6O5xYG67ZXFP76re7faYyE+s39p256hpeVjYcRf1na04UPHxXTP2v4PpdOp+YF4qOfDz/HR7pWDA2sX7kxVXqDHd/3E2kTFUSz1lD9J667r/qo8OXF8LbU14uK2lT07/i/srr42A+HnysYB/lw5QKff/lOtv+j/7xS/2+LD4Ts/bvrMuPjL0yh68fROV8eGK31fXpeeHeiI8ofiV7p3XvrK+Px3r/ksPts7tvapd3iHsHmr27+8tM6GdeI/G8+LN6gNZfPYb/9SWN/BnR9v//KaT7037zFsX3ybj8f3hRcJhbnRq7WdPH2x6TvyM8fWn043TFQUfd9Rm9E1J9Y+8v6+8N0vbxrglgfof+3/A2Yvxw+XfX3vsipmHna80y20FN73mP/IHjuXw2Ph9uLrvtVt7v5b7+frmdzffZc/eCfRk11DM49Lk+9ymBreaeve0b6B9zprf3CP+d4dMzO3XvdlooN7Em/9If1M/d99l/8fdML/Fp2gE3SCTtAJOkEn6AR0gk7QCTpBJ+gEnYBO0Ak6QSfoBJ2gE9AJOkEn6ASdoBN0AjpBJ+gEnaATdIJOQCfoBJ2gE3SCTtAJ6ASdoBN0gk7QCTpBJ6ATdIJO0Ak6QSfoBHSCTtAJOkEn6ASdgE7QCTpBJ+gEnaAT0Ak6QSfoBJ2gE3QCOkEn6ASdoBN0gk5AJ+gEnaATdIJO0Ak6AZ2gE3SCTtAJOkEnoBN0gk7QCTpBJ+gEdIJO0Ak6QSfoBJ2ATtAJOkEn6ASdoBPQCTpBJ+gEnaATdAI6QSfoBJ2gE3SCTtAJ6ASdoBN0gk7QCToBnaATdIJO0Ak6QSegE3SCTtAJOkEn6AR0gk7QCTpBJ+gEnYBO0Ak6QSfoBJ2gE9AJOkEn6ASdoBN0gk5AJ+gEnaATdIJO0AnoBJ2gE3SCTtAJOgGdoBN0gk7QCTpBJ6ATdIJO0Ak6QSfoBHSCTtAJOkEn6ASdgE7QCTpBJ+gEnaATdAI6QSfoBJ2gE3SCTkAn6ASdoBN0gk7QCegEnaATdIJO0Ak6AZ2gE3SCTtAJOkEnoBN0gk7QCTpBJ+gEdIJO0Ak6QSfoBJ2gE9AJOkEn6ASdoBN0AjpBJ+gEnaATdIJOQCfoBJ2gE3SCTtAJ6ASdoBN0gk7QCToBnaATdIJO0Ak6QSegE3SCTtAJOkEn6ASdgE7QCTpBJ+gEnaAT0Ak6QSfoBJ2gE3QCOkEn6ASdoBN0gk5AJ+gEnaATdIJO0AnoBJ2gE3SCTtAJOgGdoBN0gk7QCTpBJ+gEdIJO0Ak6QSfoBJ2ATtAJOkEn6ASdoBPQCTpBJ+gEnaATdAI6QSfoBJ2gE3SCTkAn6ASdoBN0gk7QCegEnaATdIJO0Ak6QSegE3SCTtAJOkEn6AR0gk7QCTpBJ+gEnYBO0Ak6QSfoBJ2gE9AJOkEn6ASdoBM+mk7gjXTC2/ivAAMArdil9SthdMQAAAAASUVORK5CYII=" alt=""> <a href="https://lamport.azurewebsites.net/pubs/paxos-simple.pdf" target="_blank" rel="noopener noreferrer">Paxos Made Simple<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></div> <p>虽然Lamport本人连发三篇文章都没能让大多数同行理解Paxos，但是到了2006年，Google的Chubby、Megastore以及Spanner等分布式系统都使用Paxos解决了分布式共识的问题，并将其整理成正式的论文发表之后，得益于Google的行业影响力，辅以Chubby作者Mike Burrows那略显夸张但足够吸引眼球的评价推波助澜，致使Paxos一夜间成为计算机科学分布式这条分支中最炙手可热网红概念，从这时起被学术界众人争相研究。2013年，Lamport本人因其对分布式系统的杰出理论贡献获得了2013年的图灵奖，足可见技术圈里即使再有本事，也还是需要好好包装一下的。</p> <p>讲完段子吃过西瓜，希望你没有被这些对Paxos的“困难”做的铺垫所吓倒，反正又不让你去实现它，假如放弃些许严谨性，并简化分支细节和特殊情况的话，Paxos是完全可能去通俗地理解的，Lamport在论文中也只用两段话就描述“清楚”了它的工作流程，下面我们正式来学习Paxos算法（在本节中均特指Basic Paxos算法）。Paxos算法将分布式系统中的节点分为三类：</p> <ul><li><strong>提案节点</strong>（称为Proposer）：提出对某个值进行设置操作的节点，设置值这个行为就被称之为“提案”（Proposal）。请注意，这里的“设置值”不要类比成程序中变量赋值操作，应该类比成日志记录操作，值一旦设置成功，就是不丢失、不可变的，在后面介绍的Raft算法中就索性直接把“提案”叫做“日志”了。</li> <li><strong>决策节点</strong>（称为Acceptor）：应答提案节点该提案是否可被投票、是否可被接受。提案一旦得到过半数决策节点的接受，即称该提案被批准，提案被批准即意味着该值不能再被更改，也不会丢失，且最终所有节点都会接受该它。</li> <li><strong>记录节点</strong>（被称为Learner）：不参与提案，也不参与决策，只是单纯地从提案、决策节点中学习已经达成一致的提案，譬如少数派节点从网络分区中恢复时，将会进入这种状态。</li></ul> <p>使用Paxos的分布式系统里的，所有的节点都是平等的，它们都可以承担以上某一种或者多种的角色，不过为了便于确保有明确的多数派，决策节点的数量应该被设定为奇数个，且在初始化时，网络中每个节点都知道整个网络所有决策节点的数量、地址等信息。</p> <p>分布式环境下，我们如果说各个节点“就某个值（提案）达成一致”，所指的意思是“不存在某个时刻有一个值为A，另一个时刻该值又为B的情景”。解决这个问题的复杂度主要来源于以下两个方面因素的共同作用：</p> <ul><li>系统内部各个节点通讯是不可靠的，不论对于系统中企图设置数据的提案节点抑或是决定是否批准设置行为的决策节点，其发出、收到的信息可能延迟送达、也可能会丢失，但不去考虑消息有传递错误的情况。</li> <li>系统外部各个用户访问是可并发的，如果系统只会有一个用户，如果每次只对系统进行串行访问，那单纯的应用Quorum机制已经足以保证值被正确地读写。</li></ul> <p>第一点是网络通讯中客观存在的现象，也是我们要重点解决的问题，而第二点其实也很好理解：现在我们讨论的是“分布式环境下操作的共享数据”的问题，而即使是在非分布式的环境下，有一个变量i当前在系统中存储的数值为2，如果同时有外部请求A、B分别对系统发送指令“把i的值加1”和“把i的值乘3”，如果不加任何并发控制的话，将可能得到“(2+1)*3=9”与“2*3+1=7”两种可能的结果。为此，对同一个变量的修改请求必须先“加锁”（实际操作上并不是并发控制中互斥量的加锁），不能让A、B的请求被交替处理。在分布式的环境下，由于还要同时考虑到分布式系统内可能在任何时刻出现的通讯问题，如果一个节点在取得同步锁之后，在释放锁之前发生失联，这将导致无限期的阻塞等待，因此还必须提供一个其他节点能抢占锁的机制，以避免死锁。</p> <p>Paxos算法包括两个阶段，其中第一阶段“准备”（Prepare）就相当于上面抢占锁的过程。如果某个提案节点准备发起提案，必须先向所有的决策节点广播一个许可申请（称为Prepare请求）。提案节点的Prepare请求中会附带一个全局唯一的数字n作为提案ID，决策节点收到后，将会给予提案节点两个承诺和一个应答。</p> <p>两个承诺是：</p> <ul><li>承诺不会再接受提案ID小于或等于n的Prepare请求。</li> <li>承诺不会再接受提案ID小于n的Accept请求。</li></ul> <p>一个应答是：</p> <ul><li>不违背以前作出的承诺的前提下，回复已经批准过的提案中提案ID最大的那个提案所设定的值和提案ID，如果该值从来没有被任何提案设定过，则返回空值。如果违反此前做出的承诺，即收到的提案ID并不是决策节点收到过的最大的，那可以直接对此Prepare请求不予理会。</li></ul> <p>当提案节点收到了多数派决策节点的应答（称为Promise应答）后，可以开始第二阶段“批准”（Accept）过程，这时有如下两种可能：</p> <ul><li>如果提案节点发现所有响应的决策节点此前都没有批准过该值（即为空），那说明它是第一个设置值的节点，可以随意地决定要设定的值，将自己选定的值与提案ID，构成一个二元组“(n, value)”，再次广播给全部的决策节点（称为Accept请求）。</li> <li>如果提案节点发现响应的决策节点中，已经有至少一个节点的应答中包含有值了，那它就不能够随意取值了，必须无条件地从应答中找出提案ID最大的那个值并接受，构成一个二元组“(n, maxAcceptValue)”，再次广播给全部的决策节点（称为Accept请求）。</li></ul> <p>当每一个决策节点收到Accept请求时，都会在不违背以前作出的承诺的前提下，接收并持久化对当前提案ID和提案附带的值。如果违反此前做出的承诺，即收到的提案ID并不是决策节点收到过的最大的，那可以直接对此Accept请求不予理会。</p> <p>当提案节点收到了多数派决策节点的应答（称为Accepted应答）后，协商结束，共识决议形成，将形成的决议发送给所有记录节点进行学习。整个过程的时序如下图所示：</p> <div class="mermaid" style="margin-bottom:0px;">
sequenceDiagram
    用户-&gt;&gt;提案节点: 操作请求
    提案节点-&gt;&gt;决策节点: 构造新的提案ID(n)，广播Prepare(n)请求
    决策节点--&gt;&gt;提案节点: 首次设值，返回Promise(n, null)应答
	opt  非首次设值
		决策节点--&gt;&gt;提案节点: 返回Promise(acceptedProposalID、acceptedValue)应答
		提案节点-&gt;&gt;提案节点: 将acceptedValue作为提案的value
	end
	提案节点-&gt;&gt;决策节点: 广播Accept(n, value)请求
	决策节点--&gt;&gt;提案节点: 返回Accepted(n, value)应答
	提案节点-&gt;&gt;记录节点: 形成决议，供记录节点学习
</div> <p>整个Paxos算法的工作流程确实并不复杂，如果你此前并未专门学习过分布式的知识，相信阅读到这里，不一定会对操作过程有疑惑，但估计还是不能对Paxos究竟是如何解决协商共识的形成具体的概念的，下面笔者将举一个具体例子来讲解，例子与截图来源于《<a href="https://ongardie.net/static/raft/userstudy/paxos.pdf" target="_blank" rel="noopener noreferrer">Implementing Replicated Logs with Paxos<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>》，在此统一注明，后面就不单独列出了。</p> <p>假设一个分布式系统有五个节点，分别命名为S<sub>1</sub>、S<sub>2</sub>、S<sub>3</sub>、S<sub>4</sub>、S<sub>5</sub>，只讨论正常场景，不会涉及到网络分区。全部节点都同时扮演着提案节点和决策节点的身份。此时，有两个并发的请求分别希望将同一个值分别设定为X（由S<sub>1</sub>作为提案节点提出）和Y（由S<sub>5</sub>作为提案节点提出），以P代表准备阶段，以A代表批准阶段，这时候可能发生以下情况：</p> <ul><li>情况一：譬如，S<sub>1</sub>选定的提案ID是3.1（全局唯一ID加上节点编号），先取得了多数派决策节点的Promise和Accepted应答，此时S<sub>5</sub>选定提案ID是4.5，发起Prepare请求，收到的多数派应答中至少会包含1个此前应答过S<sub>1</sub>的决策节点，假设是S<sub>3</sub>，那么S<sub>3</sub>提供的Promise中必将包含S<sub>1</sub>已设定好的值X，S<sub>5</sub>就必须无条件地用X代替Y作为自己提案的值，由此整个系统对“取值为X”这个事实达成了一致。如下图所示：</li></ul> <div class="custom-block center"><p><img src="/assets/img/paxos1.145e2dd6.png" alt=""></p></div> <ul><li>情况二：事实上，对于情况一，X被选定为最终值是必然结果，但从图中可以看出，X被选定为最终值并不是必定需要多数派的共同批准，只取决于S<sub>5</sub>提案时Promise应答中是否已包含了批准过X的决策节点，譬如下图所示，S<sub>5</sub>发起提案的Prepare请求时，X并未获得多数派批准，但由于S<sub>3</sub>已经批准的关系，最终共识的结果仍然是X。</li></ul> <div class="custom-block center"><p><img src="/assets/img/paxos2.59e89ab0.png" alt=""></p></div> <ul><li>情况三：当然，另外一种可能的结果是S<sub>5</sub>提案时Promise应答中并未包含批准过X的决策节点，譬如应答S<sub>5</sub>提案时，节点S<sub>1</sub>已经批准了X，节点S<sub>2</sub>、S<sub>3</sub>未批准但返回了Promise应答，此时S<sub>5</sub>以更大的提案ID获得了S<sub>3</sub>、S<sub>4</sub>、S<sub>5</sub>的Promise，这三个节点均未批准过任何值，那么S<sub>3</sub>将不会再接受来自S<sub>1</sub>的Accept请求，因为它的提案ID已经不是最大的了，这三个节点将批准Y的取值，整个系统最终会对“取值为Y”达成一致。</li></ul> <div class="custom-block center"><p><img src="/assets/img/paxos3.c646204c.png" alt=""></p></div> <ul><li>情况四：从以上情况三可以推导出另一种极端的情况，如果两个提案节点交替使用更大的提案ID使得准备阶段成功，但是批准阶段失败的话，这个过程理论上可以无限持续下去，形成活锁（Livelock）。在算法实现中会引入随机超时时间来避免活锁的产生。</li></ul> <div class="custom-block center"><p><img src="/assets/img/paxos4.33b9f31e.png" alt=""></p></div> <p>以上介绍是基于Basic Paxos、以正常流程（未出现网络分区等异常）、以通俗的方式介绍的Paxos算法，并未涉及到严谨的逻辑和数学原理，也未讨论Paxos的推导证明过程，对于普通的技术人员，理解起来应该并不算困难的。</p> <p>本节介绍的Basic Paxos只能对单个值形成决议，并且决议的形成至少需要两次网络请求和应答（准备和批准阶段各一次），高并发情况下将产生较大的网络开销，极端情况下甚至可能形成活锁。总之，Basic Paxos是一种很学术化但对工程并不友好的算法，现在几乎只用来做理论研究，并不直接应用在实际软件研发当中。实际的应用都是基于Multi Paxos和Fast Paxos算法的，接下来我们将会了解Multi Paxos与它的理论等价算法Raft和ZAB算法。</p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">总字数:</span> <span class="words">4,401</span> <span class="prefix">字　</span> <span class="prefix">最后更新:</span> <span class="time">5/12/2020, 11:09:03 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
    ←
    <a href="/distribution/consensus/" class="prev router-link-active">
       分布式共识算法
    </a></span> <span class="next"><a href="/distribution/consensus/raft.html">
      Multi Paxos与Raft
    </a>
    →
  </span></p></div> </main></div><div class="global-ui"><div></div><!----></div></div>
    <script src="/assets/js/app.085dd782.js" defer></script><script src="/assets/js/3.058cc938.js" defer></script><script src="/assets/js/5.c1e0bc21.js" defer></script><script src="/assets/js/7.b072c099.js" defer></script><script src="/assets/js/11.bfb1e614.js" defer></script>
  </body>
</html>
