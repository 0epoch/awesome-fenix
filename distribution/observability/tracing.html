<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>链路追踪 | 软件架构探索：The Fenix Project</title>
    <meta name="description" content="现代软件架构探索">
    <meta name="generator" content="VuePress 1.4.0">
    <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico">
    
    <link rel="preload" href="/assets/css/0.styles.b4f5acd1.css" as="style"><link rel="preload" href="/assets/js/app.55ca3099.js" as="script"><link rel="preload" href="/assets/js/3.f631742d.js" as="script"><link rel="preload" href="/assets/js/5.94baac49.js" as="script"><link rel="preload" href="/assets/js/12.9b9867e9.js" as="script"><link rel="preload" href="/assets/js/35.a0090e2c.js" as="script"><link rel="prefetch" href="/assets/js/1.f02e4d0f.js"><link rel="prefetch" href="/assets/js/10.e719107a.js"><link rel="prefetch" href="/assets/js/100.9a34d146.js"><link rel="prefetch" href="/assets/js/101.b7b0d3cf.js"><link rel="prefetch" href="/assets/js/102.e063c9fd.js"><link rel="prefetch" href="/assets/js/103.1817063f.js"><link rel="prefetch" href="/assets/js/104.20eab37d.js"><link rel="prefetch" href="/assets/js/105.dcca400a.js"><link rel="prefetch" href="/assets/js/106.2a228fed.js"><link rel="prefetch" href="/assets/js/107.d1e8154f.js"><link rel="prefetch" href="/assets/js/108.dfe4c2cf.js"><link rel="prefetch" href="/assets/js/109.2b56ca01.js"><link rel="prefetch" href="/assets/js/11.85f71a26.js"><link rel="prefetch" href="/assets/js/110.2d098a65.js"><link rel="prefetch" href="/assets/js/111.936b7d16.js"><link rel="prefetch" href="/assets/js/112.7608870a.js"><link rel="prefetch" href="/assets/js/113.bc7ef9d0.js"><link rel="prefetch" href="/assets/js/114.d74d34ba.js"><link rel="prefetch" href="/assets/js/115.fb510a91.js"><link rel="prefetch" href="/assets/js/116.0a2a0921.js"><link rel="prefetch" href="/assets/js/117.15f6f392.js"><link rel="prefetch" href="/assets/js/118.ece9bcd7.js"><link rel="prefetch" href="/assets/js/119.f50d94fa.js"><link rel="prefetch" href="/assets/js/120.bff909f0.js"><link rel="prefetch" href="/assets/js/121.97a66945.js"><link rel="prefetch" href="/assets/js/122.3ac2a2e4.js"><link rel="prefetch" href="/assets/js/123.fe9d7cf1.js"><link rel="prefetch" href="/assets/js/124.388790b1.js"><link rel="prefetch" href="/assets/js/125.21cb362c.js"><link rel="prefetch" href="/assets/js/126.3c95ae75.js"><link rel="prefetch" href="/assets/js/127.2aa49200.js"><link rel="prefetch" href="/assets/js/128.3860b5d8.js"><link rel="prefetch" href="/assets/js/129.6cc81129.js"><link rel="prefetch" href="/assets/js/13.1cfd625b.js"><link rel="prefetch" href="/assets/js/130.8ada5f4c.js"><link rel="prefetch" href="/assets/js/131.673898ff.js"><link rel="prefetch" href="/assets/js/132.ca0852ca.js"><link rel="prefetch" href="/assets/js/133.5ac0807c.js"><link rel="prefetch" href="/assets/js/134.73125b1e.js"><link rel="prefetch" href="/assets/js/135.d36fff08.js"><link rel="prefetch" href="/assets/js/136.06a2c9fb.js"><link rel="prefetch" href="/assets/js/137.3135c382.js"><link rel="prefetch" href="/assets/js/138.9f66d13d.js"><link rel="prefetch" href="/assets/js/139.33017982.js"><link rel="prefetch" href="/assets/js/14.f0dbd214.js"><link rel="prefetch" href="/assets/js/140.a078cbec.js"><link rel="prefetch" href="/assets/js/141.52cdc145.js"><link rel="prefetch" href="/assets/js/142.937f35a1.js"><link rel="prefetch" href="/assets/js/143.09eee17b.js"><link rel="prefetch" href="/assets/js/144.90739133.js"><link rel="prefetch" href="/assets/js/145.f3197a86.js"><link rel="prefetch" href="/assets/js/146.ad1393b9.js"><link rel="prefetch" href="/assets/js/147.e32d8556.js"><link rel="prefetch" href="/assets/js/148.bfda21b5.js"><link rel="prefetch" href="/assets/js/149.6e938085.js"><link rel="prefetch" href="/assets/js/15.2e00af3c.js"><link rel="prefetch" href="/assets/js/150.4302fde8.js"><link rel="prefetch" href="/assets/js/151.01f916f2.js"><link rel="prefetch" href="/assets/js/152.6fc848cf.js"><link rel="prefetch" href="/assets/js/153.a399930b.js"><link rel="prefetch" href="/assets/js/154.d52710b4.js"><link rel="prefetch" href="/assets/js/155.19f568f3.js"><link rel="prefetch" href="/assets/js/156.4d333b18.js"><link rel="prefetch" href="/assets/js/157.76bfb091.js"><link rel="prefetch" href="/assets/js/158.a5b496d0.js"><link rel="prefetch" href="/assets/js/159.4d322fba.js"><link rel="prefetch" href="/assets/js/16.a98b8dc8.js"><link rel="prefetch" href="/assets/js/160.79e79c06.js"><link rel="prefetch" href="/assets/js/161.29623052.js"><link rel="prefetch" href="/assets/js/162.a09d787d.js"><link rel="prefetch" href="/assets/js/163.29b8d84b.js"><link rel="prefetch" href="/assets/js/164.afb6b68f.js"><link rel="prefetch" href="/assets/js/17.7d7be91c.js"><link rel="prefetch" href="/assets/js/18.ed562411.js"><link rel="prefetch" href="/assets/js/19.58a32a91.js"><link rel="prefetch" href="/assets/js/20.36ca5f33.js"><link rel="prefetch" href="/assets/js/21.8aaf03a6.js"><link rel="prefetch" href="/assets/js/22.0b8e9c67.js"><link rel="prefetch" href="/assets/js/23.58ca7ba4.js"><link rel="prefetch" href="/assets/js/24.2eb0c78f.js"><link rel="prefetch" href="/assets/js/25.0e44aca3.js"><link rel="prefetch" href="/assets/js/26.1697f3a1.js"><link rel="prefetch" href="/assets/js/27.99427c64.js"><link rel="prefetch" href="/assets/js/28.23c31ad0.js"><link rel="prefetch" href="/assets/js/29.40781a75.js"><link rel="prefetch" href="/assets/js/30.78453db2.js"><link rel="prefetch" href="/assets/js/31.7a7da861.js"><link rel="prefetch" href="/assets/js/32.1e916b4b.js"><link rel="prefetch" href="/assets/js/33.aa53208b.js"><link rel="prefetch" href="/assets/js/34.aa5f1bde.js"><link rel="prefetch" href="/assets/js/36.bfe528d8.js"><link rel="prefetch" href="/assets/js/37.2d882489.js"><link rel="prefetch" href="/assets/js/38.e5838cd4.js"><link rel="prefetch" href="/assets/js/39.1d3dca5a.js"><link rel="prefetch" href="/assets/js/4.3d5c09ed.js"><link rel="prefetch" href="/assets/js/40.4fc87b15.js"><link rel="prefetch" href="/assets/js/41.87a15824.js"><link rel="prefetch" href="/assets/js/42.7f080084.js"><link rel="prefetch" href="/assets/js/43.b1a10f14.js"><link rel="prefetch" href="/assets/js/44.81d641ee.js"><link rel="prefetch" href="/assets/js/45.e149fc82.js"><link rel="prefetch" href="/assets/js/46.a01ecda1.js"><link rel="prefetch" href="/assets/js/47.9b21e07c.js"><link rel="prefetch" href="/assets/js/48.8958ba70.js"><link rel="prefetch" href="/assets/js/49.26484a6a.js"><link rel="prefetch" href="/assets/js/50.4a7c701e.js"><link rel="prefetch" href="/assets/js/51.8066485b.js"><link rel="prefetch" href="/assets/js/52.b8f14332.js"><link rel="prefetch" href="/assets/js/53.6aaca71c.js"><link rel="prefetch" href="/assets/js/54.e3fe9968.js"><link rel="prefetch" href="/assets/js/55.cc0d0dae.js"><link rel="prefetch" href="/assets/js/56.a6609ecd.js"><link rel="prefetch" href="/assets/js/57.15d180a2.js"><link rel="prefetch" href="/assets/js/58.84f3f38e.js"><link rel="prefetch" href="/assets/js/59.f81c6e39.js"><link rel="prefetch" href="/assets/js/6.5dd64a56.js"><link rel="prefetch" href="/assets/js/60.81973be8.js"><link rel="prefetch" href="/assets/js/61.671637fc.js"><link rel="prefetch" href="/assets/js/62.6686b8b4.js"><link rel="prefetch" href="/assets/js/63.c99ac0b8.js"><link rel="prefetch" href="/assets/js/64.a194ba6b.js"><link rel="prefetch" href="/assets/js/65.22fab670.js"><link rel="prefetch" href="/assets/js/66.016f34be.js"><link rel="prefetch" href="/assets/js/67.4f94609f.js"><link rel="prefetch" href="/assets/js/68.f5afc510.js"><link rel="prefetch" href="/assets/js/69.1486fbf0.js"><link rel="prefetch" href="/assets/js/7.e3e8e1d0.js"><link rel="prefetch" href="/assets/js/70.83e9db5a.js"><link rel="prefetch" href="/assets/js/71.b1f66019.js"><link rel="prefetch" href="/assets/js/72.089abed5.js"><link rel="prefetch" href="/assets/js/73.1267d42e.js"><link rel="prefetch" href="/assets/js/74.19bc6655.js"><link rel="prefetch" href="/assets/js/75.7e0589e0.js"><link rel="prefetch" href="/assets/js/76.8463fdb0.js"><link rel="prefetch" href="/assets/js/77.1f7a54d2.js"><link rel="prefetch" href="/assets/js/78.e473e5bd.js"><link rel="prefetch" href="/assets/js/79.31a0072c.js"><link rel="prefetch" href="/assets/js/8.72a1c8dd.js"><link rel="prefetch" href="/assets/js/80.792ecd24.js"><link rel="prefetch" href="/assets/js/81.11fb7cc3.js"><link rel="prefetch" href="/assets/js/82.e51efb3c.js"><link rel="prefetch" href="/assets/js/83.7834dce3.js"><link rel="prefetch" href="/assets/js/84.42237b75.js"><link rel="prefetch" href="/assets/js/85.91c49767.js"><link rel="prefetch" href="/assets/js/86.c72dc99f.js"><link rel="prefetch" href="/assets/js/87.691fd9fa.js"><link rel="prefetch" href="/assets/js/88.da2334e2.js"><link rel="prefetch" href="/assets/js/89.c5116838.js"><link rel="prefetch" href="/assets/js/9.5c6e4461.js"><link rel="prefetch" href="/assets/js/90.d9821fb8.js"><link rel="prefetch" href="/assets/js/91.af3e89b9.js"><link rel="prefetch" href="/assets/js/92.3e3a5aeb.js"><link rel="prefetch" href="/assets/js/93.412c3322.js"><link rel="prefetch" href="/assets/js/94.fd5b423e.js"><link rel="prefetch" href="/assets/js/95.d31b38f4.js"><link rel="prefetch" href="/assets/js/96.b60583e3.js"><link rel="prefetch" href="/assets/js/97.88d2aeb9.js"><link rel="prefetch" href="/assets/js/98.1c4ff42d.js"><link rel="prefetch" href="/assets/js/99.00107d08.js">
    <link rel="stylesheet" href="/assets/css/0.styles.b4f5acd1.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/images/logo-color.png" alt="软件架构探索：The Fenix Project" class="logo"> <span class="site-name can-hide">软件架构探索：The Fenix Project</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="代码" class="dropdown-title"><span class="title">代码</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/fenixsoft/awesome-fenix" target="_blank" rel="noopener noreferrer" class="nav-link external">
  文档工程 Awesome-Fenix
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/fenixsoft/fenix-bookstore-frontend" target="_blank" rel="noopener noreferrer" class="nav-link external">
  前端工程 Fenix's Bookstore
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://bookstore.icyfenix.cn" target="_blank" rel="noopener noreferrer" class="nav-link external">
  前端工程在线示例 Fenix's Bookstore
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/fenixsoft/monolithic_arch_springboot" target="_blank" rel="noopener noreferrer" class="nav-link external">
  后端：单体架构 Spring Boot
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/fenixsoft/microservice_arch_springcloud" target="_blank" rel="noopener noreferrer" class="nav-link external">
  后端：微服务架构 Spring Cloud
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/fenixsoft/microservice_arch_kubernetes" target="_blank" rel="noopener noreferrer" class="nav-link external">
  后端：微服务架构 Kubernetes
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/fenixsoft/servicemesh_arch_istio" target="_blank" rel="noopener noreferrer" class="nav-link external">
  后端：微服务架构 Istio
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/fenixsoft/serverless_arch_awslambda" target="_blank" rel="noopener noreferrer" class="nav-link external">
  后端：无服务架构 AWS Lambda
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div><div class="nav-item"><a href="https://raw.githubusercontent.com/fenixsoft/awesome-fenix/gh-pages/pdf/the-fenix-project.pdf" target="_blank" rel="noopener noreferrer" class="nav-link external">
  PDF下载
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="/board.html" class="nav-link">
  讨论区
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="代码" class="dropdown-title"><span class="title">代码</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/fenixsoft/awesome-fenix" target="_blank" rel="noopener noreferrer" class="nav-link external">
  文档工程 Awesome-Fenix
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/fenixsoft/fenix-bookstore-frontend" target="_blank" rel="noopener noreferrer" class="nav-link external">
  前端工程 Fenix's Bookstore
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://bookstore.icyfenix.cn" target="_blank" rel="noopener noreferrer" class="nav-link external">
  前端工程在线示例 Fenix's Bookstore
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/fenixsoft/monolithic_arch_springboot" target="_blank" rel="noopener noreferrer" class="nav-link external">
  后端：单体架构 Spring Boot
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/fenixsoft/microservice_arch_springcloud" target="_blank" rel="noopener noreferrer" class="nav-link external">
  后端：微服务架构 Spring Cloud
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/fenixsoft/microservice_arch_kubernetes" target="_blank" rel="noopener noreferrer" class="nav-link external">
  后端：微服务架构 Kubernetes
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/fenixsoft/servicemesh_arch_istio" target="_blank" rel="noopener noreferrer" class="nav-link external">
  后端：微服务架构 Istio
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/fenixsoft/serverless_arch_awslambda" target="_blank" rel="noopener noreferrer" class="nav-link external">
  后端：无服务架构 AWS Lambda
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div><div class="nav-item"><a href="https://raw.githubusercontent.com/fenixsoft/awesome-fenix/gh-pages/pdf/the-fenix-project.pdf" target="_blank" rel="noopener noreferrer" class="nav-link external">
  PDF下载
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="/board.html" class="nav-link">
  讨论区
</a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/summary/" class="sidebar-link">目录</a></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>前言</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/introduction/about-me.html" class="sidebar-link">✔️ 关于作者</a></li><li><a href="/introduction/about-the-fenix-project.html" class="sidebar-link">✔️ 什么是“The Fenix Project”</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>探索起步</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading open"><span>阅读指引</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/changelog/" class="sidebar-link">✔️ 更新日志</a></li><li><a href="/exploration/guide/quick-start.html" class="sidebar-link">✔️ 如何开始</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><a href="/exploration/projects/" class="sidebar-heading clickable"><span>✔️ 技术演示工程</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/exploration/projects/fenix-bookstore-frontend.html" class="sidebar-link">✔️ 前端工程</a></li><li><a href="/exploration/projects/monolithic_arch_springboot.html" class="sidebar-link">✔️ 单体架构：Spring Boot</a></li><li><a href="/exploration/projects/microservice_arch_springcloud.html" class="sidebar-link">✔️ 微服务：Spring Cloud</a></li><li><a href="/exploration/projects/microservice_arch_kubernetes.html" class="sidebar-link">✔️ 微服务：Kubernetes</a></li><li><a href="/exploration/projects/servicemesh_arch_istio.html" class="sidebar-link">✔️ 服务网格：Istio</a></li><li><a href="/exploration/projects/serverless_arch.html" class="sidebar-link">✔️ 无服务：AWS Lambda</a></li></ul></section></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>演进中的架构</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group is-sub-group depth-1"><a href="/architecture/architect-history/" class="sidebar-heading clickable open"><span>✔️ 服务架构演进史</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/architecture/architect-history/primitive-distribution.html" class="sidebar-link">✔️ 原始分布式时代</a></li><li><a href="/architecture/architect-history/monolithic.html" class="sidebar-link">✔️ 单体系统时代</a></li><li><a href="/architecture/architect-history/soa.html" class="sidebar-link">✔️ SOA时代</a></li><li><a href="/architecture/architect-history/microservices.html" class="sidebar-link">✔️ 微服务时代</a></li><li><a href="/architecture/architect-history/post-microservices.html" class="sidebar-link">✔️ 后微服务时代</a></li><li><a href="/architecture/architect-history/serverless.html" class="sidebar-link">✔️ 无服务时代</a></li></ul></section></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>架构师的视角</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group is-sub-group depth-1"><a href="/architect-perspective/general-architecture/api-style/" class="sidebar-heading clickable open"><span>✔️ 远程访问</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/architect-perspective/general-architecture/api-style/rpc.html" class="sidebar-link">✔️ 远程服务调用</a></li><li><a href="/architect-perspective/general-architecture/api-style/rest.html" class="sidebar-link">✔️ REST服务设计风格</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><a href="/architect-perspective/general-architecture/transaction/" class="sidebar-heading clickable"><span>✔️ 事务处理</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/architect-perspective/general-architecture/transaction/local.html" class="sidebar-link">✔️ 本地事务</a></li><li><a href="/architect-perspective/general-architecture/transaction/global.html" class="sidebar-link">✔️ 全局事务</a></li><li><a href="/architect-perspective/general-architecture/transaction/share.html" class="sidebar-link">✔️ 共享事务</a></li><li><a href="/architect-perspective/general-architecture/transaction/distributed.html" class="sidebar-link">✔️ 分布式事务</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><a href="/architect-perspective/general-architecture/diversion-system/" class="sidebar-heading clickable"><span>✔️ 透明多级分流系统</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/architect-perspective/general-architecture/diversion-system/client-cache.html" class="sidebar-link">✔️ 客户端缓存</a></li><li><a href="/architect-perspective/general-architecture/diversion-system/dns-lookup.html" class="sidebar-link">✔️ 域名解析</a></li><li><a href="/architect-perspective/general-architecture/diversion-system/transmission-optimization.html" class="sidebar-link">✔️ 传输链路</a></li><li><a href="/architect-perspective/general-architecture/diversion-system/cdn.html" class="sidebar-link">✔️ 内容分发网络</a></li><li><a href="/architect-perspective/general-architecture/diversion-system/load-balancing.html" class="sidebar-link">✔️ 负载均衡</a></li><li><a href="/architect-perspective/general-architecture/diversion-system/cache-middleware.html" class="sidebar-link">✔️ 缓存</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><a href="/architect-perspective/general-architecture/system-security/" class="sidebar-heading clickable"><span>✔️ 安全架构</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/architect-perspective/general-architecture/system-security/authentication.html" class="sidebar-link">✔️ 认证</a></li><li><a href="/architect-perspective/general-architecture/system-security/authorization.html" class="sidebar-link">✔️ 授权</a></li><li><a href="/architect-perspective/general-architecture/system-security/credentials.html" class="sidebar-link">✔️ 凭证</a></li><li><a href="/architect-perspective/general-architecture/system-security/confidentiality.html" class="sidebar-link">✔️ 保密</a></li><li><a href="/architect-perspective/general-architecture/system-security/transport-security.html" class="sidebar-link">✔️ 传输</a></li><li><a href="/architect-perspective/general-architecture/system-security/verification.html" class="sidebar-link">✔️ 验证</a></li></ul></section></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>分布式的基石</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group is-sub-group depth-1"><a href="/distribution/consensus/" class="sidebar-heading clickable"><span>✔️ 分布式共识算法</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/distribution/consensus/paxos.html" class="sidebar-link">✔️ Paxos</a></li><li><a href="/distribution/consensus/raft.html" class="sidebar-link">✔️ Multi Paxos与Raft</a></li><li><a href="/distribution/consensus/gossip.html" class="sidebar-link">✔️ Gossip协议</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><a href="/distribution/connect/" class="sidebar-heading clickable"><span>✔️ 从类库到服务</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/distribution/connect/service-discovery.html" class="sidebar-link">✔️ 服务发现</a></li><li><a href="/distribution/connect/service-routing.html" class="sidebar-link">✔️ 网关路由</a></li><li><a href="/distribution/connect/load-balancing.html" class="sidebar-link">✔️ 客户端负载均衡</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><a href="/distribution/traffic-management/" class="sidebar-heading clickable"><span>✔️ 服务与流量治理</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/distribution/traffic-management/failure.html" class="sidebar-link">✔️ 服务容错</a></li><li><a href="/distribution/traffic-management/traffic-control.html" class="sidebar-link">✔️ 流量控制</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><a href="/distribution/secure/" class="sidebar-heading clickable"><span>✔️ 可靠通讯</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/distribution/secure/zero-trust.html" class="sidebar-link">✔️ 零信任网络</a></li><li><a href="/distribution/secure/service-security.html" class="sidebar-link">✔️ 服务安全</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><a href="/distribution/observability/" class="sidebar-heading clickable router-link-active open"><span>✔️ 可观测性</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/distribution/observability/logging.html" class="sidebar-link">✔️ 事件日志</a></li><li><a href="/distribution/observability/tracing.html" class="active sidebar-link">✔️ 链路追踪</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/distribution/observability/tracing.html#追踪与跨度" class="sidebar-link">追踪与跨度</a></li><li class="sidebar-sub-header"><a href="/distribution/observability/tracing.html#数据收集" class="sidebar-link">数据收集</a></li><li class="sidebar-sub-header"><a href="/distribution/observability/tracing.html#追踪规范化" class="sidebar-link">追踪规范化</a></li></ul></li><li><a href="/distribution/observability/metrics.html" class="sidebar-link">✔️ 聚合度量</a></li></ul></section></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>不可变基础设施</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/immutable-infrastructure/msa-to-cn.html" class="sidebar-link">✔️ 从微服务，到云原生</a></li><li><section class="sidebar-group is-sub-group depth-1"><a href="/immutable-infrastructure/container/" class="sidebar-heading clickable"><span>✔️ 虚拟化容器</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/immutable-infrastructure/container/history.html" class="sidebar-link">✔️ 容器的崛起</a></li><li><a href="/immutable-infrastructure/container/container-build-system.html" class="sidebar-link">✔️ 以容器构建系统</a></li><li><a href="/immutable-infrastructure/container/futures.html" class="sidebar-link">✔️ 应用为中心的封装</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><a href="/immutable-infrastructure/network/" class="sidebar-heading clickable"><span>容器间网络</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/immutable-infrastructure/network/linux-vnet.html" class="sidebar-link">网络虚拟化</a></li><li><a href="/immutable-infrastructure/network/cni.html" class="sidebar-link">CNI与Kubernetes网络设计</a></li><li><a href="/immutable-infrastructure/network/plugin.html" class="sidebar-link">虚拟网络生态</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><a href="/immutable-infrastructure/storage/" class="sidebar-heading clickable"><span>分布式共享存储</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/immutable-infrastructure/storage/dfs.html" class="sidebar-link">分布式文件系统</a></li><li><a href="/immutable-infrastructure/storage/csi.html" class="sidebar-link">CSI与Kubernetes存储设计</a></li><li><a href="/immutable-infrastructure/storage/storage-plugins.html" class="sidebar-link">共享存储插件</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><a href="/immutable-infrastructure/schedule/" class="sidebar-heading clickable"><span>资源调度</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/immutable-infrastructure/schedule/hardware-schedule.html" class="sidebar-link">调度硬件资源</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><a href="/immutable-infrastructure/mesh/" class="sidebar-heading clickable"><span>服务网格</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/immutable-infrastructure/mesh/mesh-impl.html" class="sidebar-link">网格化服务</a></li><li><a href="/immutable-infrastructure/mesh/xds.html" class="sidebar-link">xDS协议</a></li><li><a href="/immutable-infrastructure/mesh/envoy.html" class="sidebar-link">Envoy代理</a></li></ul></section></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>技术方法论</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group is-sub-group depth-1"><a href="/methodology/forward-msa/" class="sidebar-heading clickable open"><span>✔️ 向微服务迈进</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/methodology/forward-msa/objective.html" class="sidebar-link">✔️ 目的：微服务的驱动力</a></li><li><a href="/methodology/forward-msa/prerequest.html" class="sidebar-link">✔️ 前提：微服务需要的条件</a></li><li><a href="/methodology/forward-msa/granularity.html" class="sidebar-link">✔️ 边界：微服务的粒度</a></li><li><a href="/methodology/forward-msa/governance.html" class="sidebar-link">✔️ 治理：理解系统复杂性</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>架构设计模式</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group is-sub-group depth-2"><a href="/methodology/pattern/events/" class="sidebar-heading clickable open"><span>✔️ 事件驱动架构</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/methodology/pattern/events/es.html" class="sidebar-link">事件溯源</a></li><li><a href="/methodology/pattern/events/cqrs.html" class="sidebar-link">查询职责分离</a></li><li><a href="/methodology/pattern/events/cep.html" class="sidebar-link">复杂事件处理</a></li></ul></section></li><li><a href="/methodology/pattern/afk.html" class="sidebar-link">扩展性立方体</a></li><li><a href="/methodology/pattern/orchestration.html" class="sidebar-link">编排与协同</a></li></ul></section></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>专题随笔</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group is-sub-group depth-1"><a href="/tricks/graalvm/" class="sidebar-heading clickable open"><span>✔️ Graal VM</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/tricks/graalvm/graal-compiler.html" class="sidebar-link">✔️ 新一代即时编译器</a></li><li><a href="/tricks/graalvm/substratevm.html" class="sidebar-link">✔️ 向原生迈进</a></li><li><a href="/tricks/graalvm/graalvm-native.html" class="sidebar-link">✔️ 没有虚拟机的Java</a></li><li><a href="/tricks/graalvm/spring-over-graal.html" class="sidebar-link">✔️ Spring over Graal</a></li></ul></section></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>附录</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group is-sub-group depth-1"><a href="/appendix/deployment-env-setup/" class="sidebar-heading clickable open"><span>✔️ 部署环境</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/appendix/deployment-env-setup/setup-docker.html" class="sidebar-link">✔️ 部署Docker CE容器环境</a></li><li><section class="sidebar-group collapsable is-sub-group depth-2"><a href="/appendix/deployment-env-setup/setup-kubernetes/" class="sidebar-heading clickable"><span>✔️ 部署Kubernetes集群</span> <span class="arrow right"></span></a> <!----></section></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><a href="/appendix/operation-env-setup/" class="sidebar-heading clickable"><span>运维环境</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/appendix/operation-env-setup/elk-setup.html" class="sidebar-link">部署Elastic Stack</a></li><li><a href="/appendix/operation-env-setup/prometheus-setup.html" class="sidebar-link">部署Prometheus</a></li></ul></section></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="链路追踪">链路追踪</h1> <p>尽管2010年之前就已经有了X-Trace、Magpie等追踪系统了，但分布式链路追踪公认的起源是Google在2010年发表的论文《<a href="https://static.googleusercontent.com/media/research.google.com/zh-CN//archive/papers/dapper-2010-1.pdf" target="_blank" rel="noopener noreferrer">Dapper : a Large-Scale Distributed Systems Tracing Infrastructure<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>》，这篇论文介绍了Google自己从2004年开始使用的分布式追踪系统Dapper的实现原理。此后，所有著名的追踪系统，无论是国外Twitter的<a href="https://github.com/openzipkin/zipkin" target="_blank" rel="noopener noreferrer">Zipkin<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>、Naver的<a href="https://github.com/naver/pinpoint" target="_blank" rel="noopener noreferrer">Pinpoint<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>（Naver是Line的母公司，Pinpoint出现其实早于Dapper论文发表，在Dapper论文中还提到了Pinpoint），抑或是国内阿里的鹰眼、大众点评的<a href="https://github.com/dianping/cat" target="_blank" rel="noopener noreferrer">CAT<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>、个人开源的<a href="https://github.com/apache/skywalking" target="_blank" rel="noopener noreferrer">SkyWalking<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>（后进入Apache基金会孵化毕业）都受到Dapper的直接影响。</p> <p>广义上讲，一个完整的分布式追踪系统应该由数据收集、数据存储和数据展示三个相对独立的子系统构成，而狭义上讲的追踪则就只是特指链路追踪数据的收集部分。譬如<a href="https://spring.io/projects/spring-cloud-sleuth" target="_blank" rel="noopener noreferrer">Spring Cloud Sleuth<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>就属于狭义的追踪系统，通常会搭配Zipkin作为数据展示，搭配Elasticsearch作为数据存储来组合使用，而前面提到的那些Dapper的徒子徒孙们大多都属于广义的追踪系统，广义的追踪系统又常被称为“APM系统”（Application Performance Management）。</p> <h2 id="追踪与跨度">追踪与跨度</h2> <p>为了有效地进行分布式追踪，Dapper提出了“追踪”与“跨度”的概念。链路追踪从客户发起请求抵达系统的边界开始，记录流经的每一个服务，直到到被追踪系统向客户返回响应为止，这整个过程就称为一次“追踪”（Trace，为了不与系统名称产生混淆，后文就直接使用英文Trace来指代了）。由于每个Trace都可能会调用数量不定、位置不定的服务，为了能够记录具体调用了哪些服务，以及每次调用的顺序、开始时点、执行时长等信息，调用服务时需要埋入一个调用记录，这个记录称为一个“跨度”（Span），每一个Trace实际上都是由若干个有顺序、有层级关系的Span所组成一颗追踪树（Trace Tree）。Span的数据结构应该足够简单，以便于能放在日志或者网络协议的报文头里；也应该足够完备，起码应含有时间戳、起止时间、Trace的的ID、当前Span的ID、父Span的ID等能够满足追踪需要的信息，譬如下图所示。</p> <div class="custom-block center"><p><img src="/assets/img/spans.1f33251a.png" alt="">
Trace和Spans（图片来源于<a href="https://static.googleusercontent.com/media/research.google.com/zh-CN//archive/papers/dapper-2010-1.pdf" target="_blank" rel="noopener noreferrer">Dapper论文<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>）</p></div> <p>从目标来看，链路追踪的目的是为排查故障和分析性能提供数据支持，系统对外提供服务的过程中，持续地接受请求并处理响应，同时持续地生成Trace，按次序整理好Trace中每一个Span所记录的调用关系，便能绘制出一幅系统的服务调用拓扑图。根据拓扑图中Span记录的时间信息、请求结果（正常或异常返回）就可以定位到缓慢或者出错的服务，将Trace与历史记录进行对比统计，就可以从系统整体层面分析服务性能，定位性能优化的目标。</p> <p>从实现来看，为每次服务调用记录Trace和Span，并以此构成追踪树结构，听着好像也不是很复杂，然而考虑到实际情况，追踪系统在功能和非功能性上都有不小的挑战。功能上的挑战来源于服务的异构性，各个服务采用不同程序语言，服务间交互采用不同的网络协议，每兼容一种场景，都会增加功能实现方面的工作量。而非功能性的挑战具体就包括以下这四个方面：</p> <ul><li><strong>低性能损耗</strong>：分布式追踪不能对服务本身产生明显的性能负担。追踪的主要目的之一就是为了寻找性能缺陷，越慢的服务越是需要追踪，所以工作场景都是性能敏感的地方。</li> <li><strong>对应用透明</strong>：追踪系统通常是运维期才事后加入的系统，应该尽量以非侵入的方式来实现追踪，对开发人员做到透明化。</li> <li><strong>随应用扩缩</strong>：现代的分布式服务集群都有根据流量压力自动扩缩的能力，这要求当业务系统扩缩时，追踪系统也能自动跟随，不需要运维人员人工参与。</li> <li><strong>持续的监控</strong>：要求追踪系统必须能够7x24小时工作，否则就难以定位到系统偶尔抖动的行为。</li></ul> <h2 id="数据收集">数据收集</h2> <p>目前，追踪系统根据数据收集方式的差异，可分为三种主流的实现方式，分别是<code>基于日志的追踪</code>（Log-Based Tracing），<code>基于服务的追踪</code>（Service-Based Tracing）和<code>基于边车代理的追踪</code>（Sidecar-Based Tracing），笔者分别介绍如下：</p> <ul><li><p>基于日志的追踪的思路是将TraceID、Span等信息直接输出到应用日志中，然后随着所有节点的日志归集过程汇聚到一起，再从全局日志信息中反推出完整的调用链拓扑。日志追踪对网络消息完全没有侵入性，对应用服务只有很少量的侵入性，对性能影响也非常低。但其缺点是对日志归集过程的直接依赖，这使得它往往不如其他两种追踪系统实现来的精确。业务服务的调用与日志的归集并不是同时完成的，也通常不由同一个进程完成，完全可能发生业务调用已经顺利结束了，但由于日志归集不及时或者精度丢失，导致日志出现延迟或缺失记录，进而导致追踪失真。这也是前面笔者介绍Elastic Stack时提到的观点，ELK在日志、追踪和度量方面都可以发挥作用，这对中小型应用确实有一定便利，但是大型系统最好还是由专业的工具做专业的事，让ELK只专注于日志处理。<br>目前，日志追踪的代表是Spring Cloud Sleuth，下面是一段由Sleuth在调用时自动生成的日志记录，你可以从中观察到TraceID、SpanID、父SpanID等追踪信息。</p> <div class="language- extra-class"><pre class="language-text"><code># 以下为调用端的日志输出：
Created new Feign span [Trace: cbe97e67ce162943, Span: bb1798f7a7c9c142, Parent: cbe97e67ce162943, exportable:false]
2019-06-30 09:43:24.022 [http-nio-9010-exec-8] DEBUG o.s.c.s.i.web.client.feign.TraceFeignClient - The modified request equals GET http://localhost:9001/product/findAll HTTP/1.1

X-B3-ParentSpanId: cbe97e67ce162943
X-B3-Sampled: 0
X-B3-TraceId: cbe97e67ce162943
X-Span-Name: http:/product/findAll
X-B3-SpanId: bb1798f7a7c9c142

# 以下为服务端的日志输出：
[findAll] to a span [Trace: cbe97e67ce162943, Span: bb1798f7a7c9c142, Parent: cbe97e67ce162943, exportable:false]
Adding a class tag with value [ProductController] to a span [Trace: cbe97e67ce162943, Span: bb1798f7a7c9c142, Parent: cbe97e67ce162943, exportable:false]
</code></pre></div></li> <li><p>基于服务的追踪是目前最为常用的追踪实现方式，被Zipkin、SkyWalking等主流追踪系统广泛采用。服务追踪的实现思路是通过某些手段（针对Java应用一般就是通过Java Agent注入）给目标应用注入追踪探针（Probe），你可以把探针视为一个寄生在目标服务身上的独立微服务系统了，它一般会有自己专用的服务注册、心跳检测等功能，有专门的数据收集协议，把从目标系统中监控得到的服务调用信息，通过另一次独立的HTTP或者RPC请求发送给追踪系统。因此，基于服务的追踪会比基于日志的追踪消耗更多的资源，也有更强的侵入性，以此换来的收益是追踪的精确性与稳定性都有所保证，不必再依靠日志归集来传输追踪数据。<br>下面是一张Pinpoint的追踪效果截图，从图中可以看到参数、变量等相当详细方法级调用信息。笔者在上一节“<a href="/distribution/observability/logging.html">日志分析</a>”里把“打印追踪诊断信息”列为一种反模式，如果需要诊断需要方法参数、返回值、上下文信息，或者方法调用耗时这类数据，通过追踪系统来实现是比通过日志系统实现更加恰当的解决方案。</p> <div class="custom-block center"><p><img src="/assets/img/pinpoint.888fa28f.png" alt="">
Pinpoint的追踪截图（图片来自网络）</p></div> <p>当然，也必须说明清楚的是像Pinpoint这种详细程度的追踪对应用系统的性能压力是相当大的，应该仅在除错时开启，Pinpoint本身就是比较重负载的系统（运行它必须先维护一套HBase）。目前服务追踪的其中一个发展趋势是轻量化，SkyWalking是这方面的佼佼者。</p></li> <li><p>基于边车代理的追踪目前实际上只有<a href="https://www.envoyproxy.io/" target="_blank" rel="noopener noreferrer">Envoy<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>一家能做（如果把“实际上”改成“理论上”的话可算上Linkerd/Conduit和NginMesh），毕竟当前Sidecar领域还没有什么能和Envoy真正竞争的产品。现在主流的服务网格框架，如Istio和微软的OSM（Open Service Mesh）都是基于Envoy的。基于边车代理的追踪毫无疑问是最符合理想中的分布式追踪模型的，它对应用完全透明，无论是日志还是服务本身都不会有任何变化；它与程序语言无关，无论应用采用什么编程语言实现，只要它还是通过网络（HTTP或者gRPC）来访问服务就可以被追踪到；它有自己独立的数据通道，追踪数据通过xDS协议进行上报，避免了对服务本身网络或者日志归集的依赖，保证了精确性。如果要说这种追踪方式还有什么缺点的话，那就是服务网格现在还不够普及，未来随着云原生的发展，相信它会成为追踪系统的主流实现方式之一。另外就是Envoy本身的工作原理决定了它只能实现服务调用层面的追踪，像上面Pinpoint截图那样本地方法调用级别的追踪诊断是做不到的。<br>Envoy也没有提供自己的界面端和存储端，所以Envoy和Sleuth一样都属于狭义的追踪系统，需要配合专门的UI来使用，现在SkyWalking、Zipkin、<a href="https://www.jaegertracing.io/" target="_blank" rel="noopener noreferrer">Jaeger<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>、<a href="https://lightstep.com/products/" target="_blank" rel="noopener noreferrer">LightStep Tracing<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>等系统都可以接受来自于Envoy的追踪数据，充当它的界面端。</p></li></ul> <h2 id="追踪规范化">追踪规范化</h2> <p>比起日志与度量，追踪这个领域的产品竞争要相对激烈。一方面，目前还没有像日志、度量那样出现明显具有统治力的产品，仍处于群雄混战的状态。另一方面，几乎市面上所有的追踪系统都是以Dapper的论文为原型发展出来的，基本上都算是同门师兄弟，却囿于实现细节，彼此互斥。这只能怪当初Google发表的Dapper是论文而不是有约束力的规范，说白了就是只提了思路，并没有规定细节，譬如该怎样进行埋点、Span上下文具体该有什么数据结构，怎样设计追踪系统与探针或者界面端的API接口等等。</p> <p>为了平息追踪产品的混乱状况，2016年11月，CNCF技术委员会接受了OpenTracing作为基金会第三个项目。OpenTracing是一套与平台无关、与厂商无关、与语言无关的追踪协议规范，只要遵循OpenTracing规范，追踪产品就可以随时更换，也可以相互搭配使用。</p> <p>OpenTracing的具体工作是制定了一个很薄的标准化层，位于应用程序与追踪系统之间，这样探针与追踪系统完全可以不是同一个厂商的产品，只要它们都支持OpenTracing协议即可互相通讯。另外，OpenTracing还规定了微服务之间发生调用时，应该如何传递Span信息（OpenTracing Payload），以上这些都如下图绿色部分所示。</p> <div class="custom-block center"><p><img src="/assets/img/opentracing.0a47ec4d.png" alt="">
符合OpenTracing的软件架构（<a href="https://medium.com/opentracing/towards-turnkey-distributed-tracing-5f4297d1736" target="_blank" rel="noopener noreferrer">图片来源<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>）</p></div> <p>OpenTracing规范一公布，业界著名的追踪系统，如Zipkin、Jaeger、SkyWalking等都很快宣布支持OpenTracing协议，但谁也没想到的是，Google自己却在此时出来反对，提出了与OpenTracing很类似的OpenCensus规范，并随后得到了Microsoft的支持和参与。OpenCensus不仅涉及到追踪，还把指标度量也纳入进来；内容上不仅涉及到规范制定，还把数据采集的探针和收集器都一起以SDK（目前支持五种语言）的形式提供出来。一下子大家都有点手足无措了，OpenTracing和OpenCensus迅速形成了可观测性的两大阵营，一边是在这方面深耕多年的众多老牌APM系统厂商，另一边是分布式追踪概念的提出者Google，以及与Google同样庞大的Microsoft。对追踪系统的规范化工作，看来并没有平息厂商竞争的混乱，反倒是把水搅得更加浑了。</p> <p>正当群众们买好西瓜搬好板凳的时候，2019年，OpenTracing和OpenCensus又忽然握手言和了，它们共同发布了可观测性的终极解决方案<a href="https://opentelemetry.io/" target="_blank" rel="noopener noreferrer">OpenTelemetry<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>，并宣布会各自冻结OpenTracing和OpenCensus的发展。OpenTelemetry野心颇大，不仅包括追踪规范，还包括度量规范、各种语言的SDK、以及采集系统的参考实现，但是不包括界面端和指标预警这些会与用户直接接触的后端功能，将它们留给具体产品去实现，算是没有对一众APM厂商赶尽杀绝，留下了一条活路。</p> <p>OpenTelemetry一诞生就带着无比炫目的光环，直接进入CNCF的孵化项目，它的目标是统一追踪、度量和日志三大领域（目前主要关注的是追踪和度量，日志方面，官方表示将放到下一阶段再去处理）。不过，OpenTelemetry毕竟是2019年才出现的新生事物，尽管背景深厚，前途无量，但未来究竟如何发展，能否打败现在已经有的众多成熟系统，目前仍然言之尚早。</p></div> <footer class="page-edit"><!----> <div class="git-hub-star"><span class="prefix">
      Kudos to
      <span style="position:relative;top:4px;right:-4px;"><a href="https://github.com/fenixsoft/awesome-fenix" aria-label="Star fenixsoft/awesome-fenix on GitHub" data-icon="octicon-star" data-show-count="true">
      Star
    </a></span></span></div> <div class="last-updated"><span class="prefix">总字数:</span> <span class="words">3,969</span> <span class="prefix">字　</span> <span class="prefix">最后更新:</span> <span class="time">9/7/2020, 8:31:59 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
    ←
    <a href="/distribution/observability/logging.html" class="prev">
      事件日志
    </a></span> <span class="next"><a href="/distribution/observability/metrics.html">
      聚合度量
    </a>
    →
  </span></p></div> </main></div><div class="global-ui"><div></div><!----></div></div>
    <script src="/assets/js/app.55ca3099.js" defer></script><script src="/assets/js/3.f631742d.js" defer></script><script src="/assets/js/5.94baac49.js" defer></script><script src="/assets/js/12.9b9867e9.js" defer></script><script src="/assets/js/35.a0090e2c.js" defer></script>
  </body>
</html>
