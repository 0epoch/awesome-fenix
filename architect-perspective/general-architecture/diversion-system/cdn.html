<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>内容分发网络 | 软件架构探索：The Fenix Project</title>
    <meta name="description" content="现代软件架构探索">
    <meta name="generator" content="VuePress 1.4.0">
    <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico">
    
    <link rel="preload" href="/assets/css/0.styles.b4f5acd1.css" as="style"><link rel="preload" href="/assets/js/app.35528d4b.js" as="script"><link rel="preload" href="/assets/js/3.02a1fb82.js" as="script"><link rel="preload" href="/assets/js/5.1f4b07a2.js" as="script"><link rel="preload" href="/assets/js/24.6b62fd7d.js" as="script"><link rel="preload" href="/assets/js/21.4b14faa8.js" as="script"><link rel="preload" href="/assets/js/41.b658a7ce.js" as="script"><link rel="prefetch" href="/assets/js/1.8c1289c6.js"><link rel="prefetch" href="/assets/js/10.fa752348.js"><link rel="prefetch" href="/assets/js/100.1f028478.js"><link rel="prefetch" href="/assets/js/101.b8ebf4f1.js"><link rel="prefetch" href="/assets/js/102.102295c6.js"><link rel="prefetch" href="/assets/js/103.f324025e.js"><link rel="prefetch" href="/assets/js/104.48795e33.js"><link rel="prefetch" href="/assets/js/105.6a31ecfa.js"><link rel="prefetch" href="/assets/js/106.5b63ce06.js"><link rel="prefetch" href="/assets/js/107.83d1936e.js"><link rel="prefetch" href="/assets/js/108.cd66f914.js"><link rel="prefetch" href="/assets/js/109.4bd0809b.js"><link rel="prefetch" href="/assets/js/11.e9c7a7d2.js"><link rel="prefetch" href="/assets/js/110.95ece437.js"><link rel="prefetch" href="/assets/js/111.d0568e79.js"><link rel="prefetch" href="/assets/js/112.13cbcd33.js"><link rel="prefetch" href="/assets/js/113.c9aa4146.js"><link rel="prefetch" href="/assets/js/114.1fb43649.js"><link rel="prefetch" href="/assets/js/115.7b2cbb1f.js"><link rel="prefetch" href="/assets/js/116.c7353975.js"><link rel="prefetch" href="/assets/js/117.ca00581f.js"><link rel="prefetch" href="/assets/js/118.449d8bb8.js"><link rel="prefetch" href="/assets/js/119.b7b771fb.js"><link rel="prefetch" href="/assets/js/12.4511aae5.js"><link rel="prefetch" href="/assets/js/120.60488a28.js"><link rel="prefetch" href="/assets/js/121.0749c81f.js"><link rel="prefetch" href="/assets/js/122.c798bc2c.js"><link rel="prefetch" href="/assets/js/123.1dde0f1f.js"><link rel="prefetch" href="/assets/js/124.10cb23dd.js"><link rel="prefetch" href="/assets/js/125.2b6461c1.js"><link rel="prefetch" href="/assets/js/126.d2e48560.js"><link rel="prefetch" href="/assets/js/127.89fbd233.js"><link rel="prefetch" href="/assets/js/128.bf4fb142.js"><link rel="prefetch" href="/assets/js/129.304c3a93.js"><link rel="prefetch" href="/assets/js/13.ed38460a.js"><link rel="prefetch" href="/assets/js/130.4238a37a.js"><link rel="prefetch" href="/assets/js/131.74c3a6a1.js"><link rel="prefetch" href="/assets/js/132.a3d427a7.js"><link rel="prefetch" href="/assets/js/133.89d2c7ee.js"><link rel="prefetch" href="/assets/js/134.d0d6e275.js"><link rel="prefetch" href="/assets/js/135.c797784b.js"><link rel="prefetch" href="/assets/js/136.ea140df7.js"><link rel="prefetch" href="/assets/js/137.1b5696df.js"><link rel="prefetch" href="/assets/js/138.c7436b41.js"><link rel="prefetch" href="/assets/js/139.1b2c08ee.js"><link rel="prefetch" href="/assets/js/14.197395a3.js"><link rel="prefetch" href="/assets/js/140.3c7ae406.js"><link rel="prefetch" href="/assets/js/141.939a2f26.js"><link rel="prefetch" href="/assets/js/142.858c266d.js"><link rel="prefetch" href="/assets/js/143.7ecd3860.js"><link rel="prefetch" href="/assets/js/144.c7ab091f.js"><link rel="prefetch" href="/assets/js/145.78a585cd.js"><link rel="prefetch" href="/assets/js/146.2bbfbfe6.js"><link rel="prefetch" href="/assets/js/147.21e10302.js"><link rel="prefetch" href="/assets/js/148.3abe76fb.js"><link rel="prefetch" href="/assets/js/149.0c4be303.js"><link rel="prefetch" href="/assets/js/15.0cafb164.js"><link rel="prefetch" href="/assets/js/150.9464b612.js"><link rel="prefetch" href="/assets/js/151.79476a03.js"><link rel="prefetch" href="/assets/js/152.b1e85476.js"><link rel="prefetch" href="/assets/js/153.06c66a45.js"><link rel="prefetch" href="/assets/js/154.7e437ada.js"><link rel="prefetch" href="/assets/js/155.dd90e05a.js"><link rel="prefetch" href="/assets/js/156.0ef8bf85.js"><link rel="prefetch" href="/assets/js/157.508a8219.js"><link rel="prefetch" href="/assets/js/158.4ead1b85.js"><link rel="prefetch" href="/assets/js/159.bbb1d640.js"><link rel="prefetch" href="/assets/js/16.dfc2f682.js"><link rel="prefetch" href="/assets/js/160.cf3f6f78.js"><link rel="prefetch" href="/assets/js/161.7b3c79cf.js"><link rel="prefetch" href="/assets/js/162.b66ba25d.js"><link rel="prefetch" href="/assets/js/17.1540eaf5.js"><link rel="prefetch" href="/assets/js/18.33efb230.js"><link rel="prefetch" href="/assets/js/19.70db9e87.js"><link rel="prefetch" href="/assets/js/20.8a7f4afc.js"><link rel="prefetch" href="/assets/js/22.4ef30f86.js"><link rel="prefetch" href="/assets/js/23.f1754c1c.js"><link rel="prefetch" href="/assets/js/25.8a1bf31e.js"><link rel="prefetch" href="/assets/js/26.db450350.js"><link rel="prefetch" href="/assets/js/27.40dffdc3.js"><link rel="prefetch" href="/assets/js/28.548a28a8.js"><link rel="prefetch" href="/assets/js/29.ca64bab4.js"><link rel="prefetch" href="/assets/js/30.c9645101.js"><link rel="prefetch" href="/assets/js/31.c7ed3adb.js"><link rel="prefetch" href="/assets/js/32.677c2803.js"><link rel="prefetch" href="/assets/js/33.cb4921f6.js"><link rel="prefetch" href="/assets/js/34.0fba5dd9.js"><link rel="prefetch" href="/assets/js/35.182bcb65.js"><link rel="prefetch" href="/assets/js/36.1cfefaf6.js"><link rel="prefetch" href="/assets/js/37.32b968bc.js"><link rel="prefetch" href="/assets/js/38.1617bf7a.js"><link rel="prefetch" href="/assets/js/39.bc982dc7.js"><link rel="prefetch" href="/assets/js/4.320ac403.js"><link rel="prefetch" href="/assets/js/40.8c4aa702.js"><link rel="prefetch" href="/assets/js/42.7fb9b048.js"><link rel="prefetch" href="/assets/js/43.85ca261a.js"><link rel="prefetch" href="/assets/js/44.6c13c677.js"><link rel="prefetch" href="/assets/js/45.20d20248.js"><link rel="prefetch" href="/assets/js/46.bc63198c.js"><link rel="prefetch" href="/assets/js/47.e57d2c2f.js"><link rel="prefetch" href="/assets/js/48.2acd27e1.js"><link rel="prefetch" href="/assets/js/49.faa2d35d.js"><link rel="prefetch" href="/assets/js/50.e8b2f13d.js"><link rel="prefetch" href="/assets/js/51.6d368049.js"><link rel="prefetch" href="/assets/js/52.e0513c95.js"><link rel="prefetch" href="/assets/js/53.24d44a26.js"><link rel="prefetch" href="/assets/js/54.d53fdde3.js"><link rel="prefetch" href="/assets/js/55.f6f70c96.js"><link rel="prefetch" href="/assets/js/56.3c20d26f.js"><link rel="prefetch" href="/assets/js/57.3f9a30d4.js"><link rel="prefetch" href="/assets/js/58.7fb6bd8b.js"><link rel="prefetch" href="/assets/js/59.855b6426.js"><link rel="prefetch" href="/assets/js/6.f60c28e5.js"><link rel="prefetch" href="/assets/js/60.b89301f1.js"><link rel="prefetch" href="/assets/js/61.ad64eb66.js"><link rel="prefetch" href="/assets/js/62.9566c4b6.js"><link rel="prefetch" href="/assets/js/63.bc312a78.js"><link rel="prefetch" href="/assets/js/64.dd912338.js"><link rel="prefetch" href="/assets/js/65.3542f0ea.js"><link rel="prefetch" href="/assets/js/66.ed37fc2c.js"><link rel="prefetch" href="/assets/js/67.7f224760.js"><link rel="prefetch" href="/assets/js/68.a518c6a7.js"><link rel="prefetch" href="/assets/js/69.65a9cf21.js"><link rel="prefetch" href="/assets/js/7.d0a43de7.js"><link rel="prefetch" href="/assets/js/70.da5d666d.js"><link rel="prefetch" href="/assets/js/71.6562e341.js"><link rel="prefetch" href="/assets/js/72.9d192cb0.js"><link rel="prefetch" href="/assets/js/73.36abc322.js"><link rel="prefetch" href="/assets/js/74.5ad4f5a3.js"><link rel="prefetch" href="/assets/js/75.568e4c63.js"><link rel="prefetch" href="/assets/js/76.ca2b8774.js"><link rel="prefetch" href="/assets/js/77.6fdf83ca.js"><link rel="prefetch" href="/assets/js/78.dde1020d.js"><link rel="prefetch" href="/assets/js/79.d2141d96.js"><link rel="prefetch" href="/assets/js/8.ceb02d47.js"><link rel="prefetch" href="/assets/js/80.52c7e8b5.js"><link rel="prefetch" href="/assets/js/81.26bcc96e.js"><link rel="prefetch" href="/assets/js/82.28ee3c7f.js"><link rel="prefetch" href="/assets/js/83.2a5cd5ce.js"><link rel="prefetch" href="/assets/js/84.953c56b8.js"><link rel="prefetch" href="/assets/js/85.95b487fa.js"><link rel="prefetch" href="/assets/js/86.b3a031b1.js"><link rel="prefetch" href="/assets/js/87.f1b240f2.js"><link rel="prefetch" href="/assets/js/88.2d11e420.js"><link rel="prefetch" href="/assets/js/89.84de9b63.js"><link rel="prefetch" href="/assets/js/9.80f4b475.js"><link rel="prefetch" href="/assets/js/90.429728fe.js"><link rel="prefetch" href="/assets/js/91.75ca266c.js"><link rel="prefetch" href="/assets/js/92.4458f669.js"><link rel="prefetch" href="/assets/js/93.064d3c15.js"><link rel="prefetch" href="/assets/js/94.db65eb4f.js"><link rel="prefetch" href="/assets/js/95.fb357a51.js"><link rel="prefetch" href="/assets/js/96.d9afce68.js"><link rel="prefetch" href="/assets/js/97.75a98812.js"><link rel="prefetch" href="/assets/js/98.5af93120.js"><link rel="prefetch" href="/assets/js/99.cfa66c19.js">
    <link rel="stylesheet" href="/assets/css/0.styles.b4f5acd1.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/images/logo-color.png" alt="软件架构探索：The Fenix Project" class="logo"> <span class="site-name can-hide">软件架构探索：The Fenix Project</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="代码" class="dropdown-title"><span class="title">代码</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/fenixsoft/awesome-fenix" target="_blank" rel="noopener noreferrer" class="nav-link external">
  文档工程 Awesome-Fenix
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/fenixsoft/fenix-bookstore-frontend" target="_blank" rel="noopener noreferrer" class="nav-link external">
  前端工程 Fenix's Bookstore
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://bookstore.icyfenix.cn" target="_blank" rel="noopener noreferrer" class="nav-link external">
  前端工程在线示例 Fenix's Bookstore
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/fenixsoft/monolithic_arch_springboot" target="_blank" rel="noopener noreferrer" class="nav-link external">
  后端：单体架构 Spring Boot
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/fenixsoft/microservice_arch_springcloud" target="_blank" rel="noopener noreferrer" class="nav-link external">
  后端：微服务架构 Spring Cloud
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/fenixsoft/microservice_arch_kubernetes" target="_blank" rel="noopener noreferrer" class="nav-link external">
  后端：微服务架构 Kubernetes
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/fenixsoft/servicemesh_arch_istio" target="_blank" rel="noopener noreferrer" class="nav-link external">
  后端：微服务架构 Istio
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/fenixsoft/serverless_arch_awslambda" target="_blank" rel="noopener noreferrer" class="nav-link external">
  后端：无服务架构 AWS Lambda
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div><div class="nav-item"><a href="https://raw.githubusercontent.com/fenixsoft/awesome-fenix/gh-pages/pdf/the-fenix-project.pdf" target="_blank" rel="noopener noreferrer" class="nav-link external">
  PDF下载
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="/board.html" class="nav-link">
  讨论区
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="代码" class="dropdown-title"><span class="title">代码</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/fenixsoft/awesome-fenix" target="_blank" rel="noopener noreferrer" class="nav-link external">
  文档工程 Awesome-Fenix
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/fenixsoft/fenix-bookstore-frontend" target="_blank" rel="noopener noreferrer" class="nav-link external">
  前端工程 Fenix's Bookstore
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://bookstore.icyfenix.cn" target="_blank" rel="noopener noreferrer" class="nav-link external">
  前端工程在线示例 Fenix's Bookstore
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/fenixsoft/monolithic_arch_springboot" target="_blank" rel="noopener noreferrer" class="nav-link external">
  后端：单体架构 Spring Boot
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/fenixsoft/microservice_arch_springcloud" target="_blank" rel="noopener noreferrer" class="nav-link external">
  后端：微服务架构 Spring Cloud
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/fenixsoft/microservice_arch_kubernetes" target="_blank" rel="noopener noreferrer" class="nav-link external">
  后端：微服务架构 Kubernetes
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/fenixsoft/servicemesh_arch_istio" target="_blank" rel="noopener noreferrer" class="nav-link external">
  后端：微服务架构 Istio
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/fenixsoft/serverless_arch_awslambda" target="_blank" rel="noopener noreferrer" class="nav-link external">
  后端：无服务架构 AWS Lambda
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div><div class="nav-item"><a href="https://raw.githubusercontent.com/fenixsoft/awesome-fenix/gh-pages/pdf/the-fenix-project.pdf" target="_blank" rel="noopener noreferrer" class="nav-link external">
  PDF下载
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="/board.html" class="nav-link">
  讨论区
</a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/summary/" class="sidebar-link">目录</a></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>前言</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/introduction/about-me.html" class="sidebar-link">✔️ 关于作者</a></li><li><a href="/introduction/about-the-fenix-project.html" class="sidebar-link">✔️ 什么是“The Fenix Project”</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>探索起步</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading open"><span>阅读指引</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/changelog/" class="sidebar-link">✔️ 更新日志</a></li><li><a href="/exploration/guide/quick-start.html" class="sidebar-link">✔️ 如何开始</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><a href="/exploration/projects/" class="sidebar-heading clickable"><span>✔️ 技术演示工程</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/exploration/projects/fenix-bookstore-frontend.html" class="sidebar-link">✔️ 前端工程</a></li><li><a href="/exploration/projects/monolithic_arch_springboot.html" class="sidebar-link">✔️ 单体架构：Spring Boot</a></li><li><a href="/exploration/projects/microservice_arch_springcloud.html" class="sidebar-link">✔️ 微服务：Spring Cloud</a></li><li><a href="/exploration/projects/microservice_arch_kubernetes.html" class="sidebar-link">✔️ 微服务：Kubernetes</a></li><li><a href="/exploration/projects/servicemesh_arch_istio.html" class="sidebar-link">✔️ 服务网格：Istio</a></li><li><a href="/exploration/projects/serverless_arch.html" class="sidebar-link">✔️ 无服务：AWS Lambda</a></li></ul></section></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>演进中的架构</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group is-sub-group depth-1"><a href="/architecture/architect-history/" class="sidebar-heading clickable open"><span>✔️ 服务架构演进史</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/architecture/architect-history/primitive-distribution.html" class="sidebar-link">✔️ 原始分布式时代</a></li><li><a href="/architecture/architect-history/monolithic.html" class="sidebar-link">✔️ 单体系统时代</a></li><li><a href="/architecture/architect-history/soa.html" class="sidebar-link">✔️ SOA时代</a></li><li><a href="/architecture/architect-history/microservices.html" class="sidebar-link">✔️ 微服务时代</a></li><li><a href="/architecture/architect-history/post-microservices.html" class="sidebar-link">✔️ 后微服务时代</a></li><li><a href="/architecture/architect-history/serverless.html" class="sidebar-link">✔️ 无服务时代</a></li></ul></section></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>架构师的视角</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group is-sub-group depth-1"><a href="/architect-perspective/general-architecture/api-style/" class="sidebar-heading clickable"><span>✔️ 远程访问</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/architect-perspective/general-architecture/api-style/rpc.html" class="sidebar-link">✔️ 远程服务调用</a></li><li><a href="/architect-perspective/general-architecture/api-style/rest.html" class="sidebar-link">✔️ REST服务设计风格</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><a href="/architect-perspective/general-architecture/transaction/" class="sidebar-heading clickable"><span>✔️ 事务处理</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/architect-perspective/general-architecture/transaction/local.html" class="sidebar-link">✔️ 本地事务</a></li><li><a href="/architect-perspective/general-architecture/transaction/global.html" class="sidebar-link">✔️ 全局事务</a></li><li><a href="/architect-perspective/general-architecture/transaction/share.html" class="sidebar-link">✔️ 共享事务</a></li><li><a href="/architect-perspective/general-architecture/transaction/distributed.html" class="sidebar-link">✔️ 分布式事务</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><a href="/architect-perspective/general-architecture/diversion-system/" class="sidebar-heading clickable router-link-active open"><span>✔️ 透明多级分流系统</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/architect-perspective/general-architecture/diversion-system/client-cache.html" class="sidebar-link">✔️ 客户端缓存</a></li><li><a href="/architect-perspective/general-architecture/diversion-system/dns-lookup.html" class="sidebar-link">✔️ 域名解析</a></li><li><a href="/architect-perspective/general-architecture/diversion-system/transmission-optimization.html" class="sidebar-link">✔️ 传输链路</a></li><li><a href="/architect-perspective/general-architecture/diversion-system/cdn.html" class="active sidebar-link">✔️ 内容分发网络</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/architect-perspective/general-architecture/diversion-system/cdn.html#路由解析" class="sidebar-link">路由解析</a></li><li class="sidebar-sub-header"><a href="/architect-perspective/general-architecture/diversion-system/cdn.html#内容分发" class="sidebar-link">内容分发</a></li><li class="sidebar-sub-header"><a href="/architect-perspective/general-architecture/diversion-system/cdn.html#cdn应用" class="sidebar-link">CDN应用</a></li></ul></li><li><a href="/architect-perspective/general-architecture/diversion-system/load-balancing.html" class="sidebar-link">✔️ 负载均衡</a></li><li><a href="/architect-perspective/general-architecture/diversion-system/cache-middleware.html" class="sidebar-link">✔️ 缓存</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><a href="/architect-perspective/general-architecture/system-security/" class="sidebar-heading clickable"><span>✔️ 安全架构</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/architect-perspective/general-architecture/system-security/authentication.html" class="sidebar-link">✔️ 认证</a></li><li><a href="/architect-perspective/general-architecture/system-security/authorization.html" class="sidebar-link">✔️ 授权</a></li><li><a href="/architect-perspective/general-architecture/system-security/credentials.html" class="sidebar-link">✔️ 凭证</a></li><li><a href="/architect-perspective/general-architecture/system-security/confidentiality.html" class="sidebar-link">✔️ 保密</a></li><li><a href="/architect-perspective/general-architecture/system-security/transport-security.html" class="sidebar-link">✔️ 传输</a></li><li><a href="/architect-perspective/general-architecture/system-security/verification.html" class="sidebar-link">✔️ 验证</a></li></ul></section></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>分布式的基石</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group is-sub-group depth-1"><a href="/distribution/consensus/" class="sidebar-heading clickable open"><span>✔️ 分布式共识算法</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/distribution/consensus/paxos.html" class="sidebar-link">✔️ Paxos</a></li><li><a href="/distribution/consensus/raft.html" class="sidebar-link">✔️ Multi Paxos与Raft</a></li><li><a href="/distribution/consensus/gossip.html" class="sidebar-link">✔️ Gossip协议</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><a href="/distribution/connect/" class="sidebar-heading clickable"><span>✔️ 从类库到服务</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/distribution/connect/service-discovery.html" class="sidebar-link">✔️ 服务发现</a></li><li><a href="/distribution/connect/service-routing.html" class="sidebar-link">✔️ 网关路由</a></li><li><a href="/distribution/connect/load-balancing.html" class="sidebar-link">✔️ 客户端负载均衡</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><a href="/distribution/traffic-management/" class="sidebar-heading clickable"><span>✔️ 服务与流量治理</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/distribution/traffic-management/failure.html" class="sidebar-link">✔️ 服务容错</a></li><li><a href="/distribution/traffic-management/traffic-control.html" class="sidebar-link">✔️ 流量控制</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><a href="/distribution/secure/" class="sidebar-heading clickable"><span>✔️ 可靠通讯</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/distribution/secure/zero-trust.html" class="sidebar-link">✔️ 零信任网络</a></li><li><a href="/distribution/secure/service-security.html" class="sidebar-link">✔️ 服务安全</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><a href="/distribution/observability/" class="sidebar-heading clickable"><span>✔️ 可观测性</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/distribution/observability/logging.html" class="sidebar-link">✔️ 事件日志</a></li><li><a href="/distribution/observability/tracing.html" class="sidebar-link">✔️ 链路追踪</a></li><li><a href="/distribution/observability/metrics.html" class="sidebar-link">✔️ 聚合度量</a></li></ul></section></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>不可变基础设施</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/immutable-infrastructure/msa-to-cn.html" class="sidebar-link">✔️ 从微服务到云原生</a></li><li><section class="sidebar-group is-sub-group depth-1"><a href="/immutable-infrastructure/container/" class="sidebar-heading clickable"><span>✔️ 虚拟化容器</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/immutable-infrastructure/container/history.html" class="sidebar-link">✔️ 容器的崛起</a></li><li><a href="/immutable-infrastructure/container/container-build-system.html" class="sidebar-link">✔️ 以容器构建系统</a></li><li><a href="/immutable-infrastructure/container/application-centric.html" class="sidebar-link">✔️ 应用为中心的封装</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><a href="/immutable-infrastructure/network/" class="sidebar-heading clickable"><span>✔️ 容器间网络</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/immutable-infrastructure/network/linux-vnet.html" class="sidebar-link">✔️ Linux网络虚拟化</a></li><li><a href="/immutable-infrastructure/network/cni.html" class="sidebar-link">✔️ 容器网络与生态</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><a href="/immutable-infrastructure/storage/" class="sidebar-heading clickable"><span>✔️ 容器持久化存储</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/immutable-infrastructure/storage/storage-evolution.html" class="sidebar-link">✔️ Kubernetes存储设计</a></li><li><a href="/immutable-infrastructure/storage/csi.html" class="sidebar-link">✔️ 容器存储与生态</a></li></ul></section></li><li><a href="/immutable-infrastructure/schedule/hardware-schedule.html" class="sidebar-link">✔️ 资源与调度</a></li><li><section class="sidebar-group is-sub-group depth-1"><a href="/immutable-infrastructure/mesh/" class="sidebar-heading clickable"><span>服务网格</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/immutable-infrastructure/mesh/mesh-impl.html" class="sidebar-link">网格化服务</a></li><li><a href="/immutable-infrastructure/mesh/xds.html" class="sidebar-link">xDS协议</a></li><li><a href="/immutable-infrastructure/mesh/envoy.html" class="sidebar-link">Envoy代理</a></li></ul></section></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>技术方法论</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group is-sub-group depth-1"><a href="/methodology/forward-msa/" class="sidebar-heading clickable open"><span>✔️ 向微服务迈进</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/methodology/forward-msa/objective.html" class="sidebar-link">✔️ 目的：微服务的驱动力</a></li><li><a href="/methodology/forward-msa/prerequest.html" class="sidebar-link">✔️ 前提：微服务需要的条件</a></li><li><a href="/methodology/forward-msa/granularity.html" class="sidebar-link">✔️ 边界：微服务的粒度</a></li><li><a href="/methodology/forward-msa/governance.html" class="sidebar-link">✔️ 治理：理解系统复杂性</a></li></ul></section></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>专题随笔</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group is-sub-group depth-1"><a href="/tricks/graalvm/" class="sidebar-heading clickable open"><span>✔️ Graal VM</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/tricks/graalvm/graal-compiler.html" class="sidebar-link">✔️ 新一代即时编译器</a></li><li><a href="/tricks/graalvm/substratevm.html" class="sidebar-link">✔️ 向原生迈进</a></li><li><a href="/tricks/graalvm/graalvm-native.html" class="sidebar-link">✔️ 没有虚拟机的Java</a></li><li><a href="/tricks/graalvm/spring-over-graal.html" class="sidebar-link">✔️ Spring over Graal</a></li></ul></section></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>附录</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group is-sub-group depth-1"><a href="/appendix/deployment-env-setup/" class="sidebar-heading clickable open"><span>✔️ 部署环境</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/appendix/deployment-env-setup/setup-docker.html" class="sidebar-link">✔️ 部署Docker CE容器环境</a></li><li><section class="sidebar-group collapsable is-sub-group depth-2"><a href="/appendix/deployment-env-setup/setup-kubernetes/" class="sidebar-heading clickable"><span>✔️ 部署Kubernetes集群</span> <span class="arrow right"></span></a> <!----></section></li></ul></section></li><li><a href="/appendix/istio.html" class="sidebar-link">✔️ 部署Istio</a></li><li><a href="/appendix/operation-env-setup/elk-setup.html" class="sidebar-link">✔️ 部署Elastic Stack</a></li><li><a href="/appendix/operation-env-setup/prometheus-setup.html" class="sidebar-link">✔️ 部署Prometheus</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="内容分发网络">内容分发网络</h1> <div class="custom-block tip"><p class="custom-block-title">内容分发网络（Content Distribution Network）</p> <p>CDN是一种十分古老而又十分透明，没什么存在感的分流系统，许多人都说听过它，但真正了解过它的人却很少。</p></div> <p>前面几个小节介绍了缓存、域名解析、链路优化，这节我们来讨论它们的一个经典的综合运用案例：内容分发网络（Content Distribution Network，CDN）。</p> <p>CDN是一种十分古老的应用，以至于笔者相信阅读本文的受众至少有八、九成应该对它有不同程度的了解的——起码是听说过它的名字的。如果把某个互联网系统比喻为一家开门营业的企业，那CDN就是它遍布世界各地的分支销售机构，客户要买一块CPU就订机票飞到美国加州Intel总部去那肯定是不合适的，到本地电脑城找个装机铺才是正常人类的做法，CDN就相当于电脑城那吆喝着CPU三十块钱一斤的本地经销商。</p> <p>CDN又是一种十分透明的应用，以至于笔者相信阅读本文的受众至少有八、九成应该对它是如何为互联网站点分流、对它的工作原理并没有什么系统性的概念——起码没有自己亲自使用过。如果抛却其他影响服务质量的因素，仅从网络角度看，一个互联网系统的速度快慢取决于以下四点因素：</p> <ol><li>网站服务器接入网络运营商的链路所能提供的出口带宽。</li> <li>用户客户端接入网络运营商的链路所能提供的入口带宽。</li> <li>从网站到用户之间经过的不同运营商之间互联节点的带宽，一般来说两个运营商之间只有固定的若干个点是互通的，所有跨运营商之间的交互都要经过这些点。</li> <li>从网站到用户之间的物理链路传输时延。打游戏的同学都清楚，ping比流量更重要。</li></ol> <p>以上四个网络问题，除了第二个只能由用户掏腰包装个更好的宽带才能够解决之外，其余三个都能通过内容分发网络来显著改善的。一个工作良好的CDN，能为互联网系统解决跨运营商、跨地域物理距离所导致的时延问题，能为网站流量带宽起到分流、减负的作用。如果不是有遍布全国的阿里云CDN网络支持，哪怕把整个杭州所有市民上网的权力都剥夺，带宽全部让给淘宝，恐怕也撑不住双十一全国乃至全球用户的疯狂围攻。</p> <p>CDN的工作过程，主要涉及到路由解析、内容分发、负载均衡（由于后面专门有一节讨论负载均衡的内容，所以这部分在CDN中就暂不涉及）和所能支持的应用内容四个方面，下面我们来逐一了解。</p> <h2 id="路由解析">路由解析</h2> <p>根据我们在第二节中对DNS系统的介绍，一个未使用CDN的用户访问网站的过程应该是这样的：</p> <div class="mermaid" style="margin-bottom:0px;">
sequenceDiagram
    浏览器 -&gt;&gt; 本地DNS: 查询网站icyfenix.cn
    loop 递归查询
	    本地DNS -&gt;&gt; 权威DNS: 查询网站icyfenix.cn
	end
	权威DNS --&gt;&gt; 本地DNS: 地址:xx.xx.xx.xx
	本地DNS --&gt;&gt; 浏览器: 地址:xx.xx.xx.xx
	浏览器 -&gt;&gt; 网站服务器: 请求
	网站服务器 --&gt;&gt; 浏览器: 响应
</div> <p>以上时序所表达的内容跟第二节中讲述的没有差异，这里仅列作对比，不再赘述。下面分析使用了CDN的DNS查询过程之前，我们先来看一段对本站进行DNS查询的实际应答。通过dig或者host命令，可以很方便地得到DNS服务器的返回结果（结果中头4个IP的地址是我手工加入的，后面的就不一个一个查了），如下所示：</p> <div class="language-bash extra-class"><pre class="language-bash"><code>$ <span class="token function">dig</span> icyfenix.cn

<span class="token punctuation">;</span> <span class="token operator">&lt;&lt;</span><span class="token operator">&gt;&gt;</span> DiG <span class="token number">9.11</span>.3-1ubuntu1.8-Ubuntu <span class="token operator">&lt;&lt;</span><span class="token operator">&gt;&gt;</span> icyfenix.cn
<span class="token punctuation">;</span><span class="token punctuation">;</span> global options: +cmd
<span class="token punctuation">;</span><span class="token punctuation">;</span> Got answer:
<span class="token punctuation">;</span><span class="token punctuation">;</span> -<span class="token operator">&gt;&gt;</span>HEADER<span class="token operator">&lt;&lt;-</span> opcode: QUERY, status: NOERROR, id: <span class="token number">60630</span>
<span class="token punctuation">;</span><span class="token punctuation">;</span> flags: qr rd ra<span class="token punctuation">;</span> QUERY: <span class="token number">1</span>, ANSWER: <span class="token number">17</span>, AUTHORITY: <span class="token number">0</span>, ADDITIONAL: <span class="token number">1</span>

<span class="token punctuation">;</span><span class="token punctuation">;</span> OPT PSEUDOSECTION:
<span class="token punctuation">;</span> EDNS: version: <span class="token number">0</span>, flags:<span class="token punctuation">;</span> udp: <span class="token number">65494</span>
<span class="token punctuation">;</span><span class="token punctuation">;</span> QUESTION SECTION:
<span class="token punctuation">;</span>icyfenix.cn.                   IN      A

<span class="token punctuation">;</span><span class="token punctuation">;</span> ANSWER SECTION:
icyfenix.cn.            <span class="token number">600</span>     IN      CNAME   icyfenix.cn.cdn.dnsv1.com.
icyfenix.cn.cdn.dnsv1.com. <span class="token number">599</span>  IN      CNAME   4yi4q4z6.dispatch.spcdntip.com.
4yi4q4z6.dispatch.spcdntip.com.	<span class="token number">60</span> IN	A	<span class="token number">101.71</span>.72.192      <span class="token comment">#浙江宁波市</span>
4yi4q4z6.dispatch.spcdntip.com.	<span class="token number">60</span> IN	A	<span class="token number">113.200</span>.16.234     <span class="token comment">#陕西省榆林市</span>
4yi4q4z6.dispatch.spcdntip.com.	<span class="token number">60</span> IN	A	<span class="token number">116.95</span>.25.196      <span class="token comment">#内蒙古自治区呼和浩特市</span>
4yi4q4z6.dispatch.spcdntip.com.	<span class="token number">60</span> IN	A	<span class="token number">116.178</span>.66.65      <span class="token comment">#新疆维吾尔自治区乌鲁木齐市</span>
4yi4q4z6.dispatch.spcdntip.com.	<span class="token number">60</span> IN	A	<span class="token number">118.212</span>.234.144
4yi4q4z6.dispatch.spcdntip.com.	<span class="token number">60</span> IN	A	<span class="token number">211.91</span>.160.228
4yi4q4z6.dispatch.spcdntip.com.	<span class="token number">60</span> IN	A	<span class="token number">211.97</span>.73.224
4yi4q4z6.dispatch.spcdntip.com.	<span class="token number">60</span> IN	A	<span class="token number">218.11</span>.8.232
4yi4q4z6.dispatch.spcdntip.com.	<span class="token number">60</span> IN	A	<span class="token number">221.204</span>.166.70
4yi4q4z6.dispatch.spcdntip.com.	<span class="token number">60</span> IN	A	<span class="token number">14.204</span>.74.140
4yi4q4z6.dispatch.spcdntip.com.	<span class="token number">60</span> IN	A	<span class="token number">43.242</span>.166.88
4yi4q4z6.dispatch.spcdntip.com.	<span class="token number">60</span> IN	A	<span class="token number">59.80</span>.39.110
4yi4q4z6.dispatch.spcdntip.com.	<span class="token number">60</span> IN	A	<span class="token number">59.83</span>.204.12
4yi4q4z6.dispatch.spcdntip.com.	<span class="token number">60</span> IN	A	<span class="token number">59.83</span>.204.14
4yi4q4z6.dispatch.spcdntip.com.	<span class="token number">60</span> IN	A	<span class="token number">59.83</span>.218.235

<span class="token punctuation">;</span><span class="token punctuation">;</span> Query time: <span class="token number">74</span> msec
<span class="token punctuation">;</span><span class="token punctuation">;</span> SERVER: <span class="token number">127.0</span>.0.53<span class="token comment">#53(127.0.0.53)</span>
<span class="token punctuation">;</span><span class="token punctuation">;</span> WHEN: Sat Apr <span class="token number">11</span> <span class="token number">22</span>:33:56 CST <span class="token number">2020</span>
<span class="token punctuation">;</span><span class="token punctuation">;</span> MSG SIZE  rcvd: <span class="token number">152</span>
</code></pre></div><p>根据以上信息，查询“icyfenix.cn.”的查询结果首先返回了一个<a href="https://zh.wikipedia.org/wiki/CNAME%E8%AE%B0%E5%BD%95" target="_blank" rel="noopener noreferrer">CNAME记录<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>（icyfenix.cn.cdn.dnsv1.com.），递归查询该CNAME时候，返回了另一个看起来更奇怪的CNAME（4yi4q4z6.dispatch.spcdntip.com.），最后，这个CNAME返回了十几个位于全国不同地区的A记录，很明显，那些A记录就是存有本站缓存的CDN节点。CDN路由解析的工作过程是：</p> <ol><li>架设好服务器后，将服务器的IP地址在你的CDN服务商上注册为“源站”，注册后你会得到一个CNAME，即本例中的“icyfenix.cn.cdn.dnsv1.com.”。</li> <li>将得到的CNAME在你购买域名的DNS服务商上注册为一条CNAME记录。</li> <li>当发生一次未命中缓存的DNS查询时，域名服务商解析出CNAME后，返回给本地DNS，至此之后链路解析的主导权就开始由CDN的调度服务接管了。</li> <li>本地DNS查询CNAME时，能解析该CNAME的权威服务器只有CDN服务商的权威DNS，该DNS会根据一定的均衡策略和参数，如拓扑结构、容量、时延等，在全国各地能提供服务的CDN节点中挑选一个适合的，将它的IP返回给本地DNS。</li> <li>浏览器从本地DNS拿到IP，将该IP当作源站服务器来进行访问，此时该IP的CDN服务上可能有，也可能没有缓存源站的资源，这点将在稍后“内容分发”部分讨论。</li> <li>CDN代替源站向用户提供所需的资源。</li></ol> <p>以上步骤反映在时序图上，将如下图所示：</p> <div class="mermaid" style="margin-bottom:0px;">
sequenceDiagram
    浏览器 -&gt;&gt; 本地DNS: 查询网站icyfenix.cn
    loop 递归查询
	    本地DNS -&gt;&gt; 域名的权威DNS: 查询网站icyfenix.cn
	end
	域名的权威DNS --&gt;&gt; 本地DNS: CNAME:icyfenix.cn.cdn.dnsv1.com.
	本地DNS --&gt;&gt; CNAME的权威DNS: 查询CNAME：icyfenix.cn.cdn.dnsv1.com.
	loop 递归查询
		CNAME的权威DNS -&gt;&gt; CNAME的权威DNS: 经过递归查询和负载均衡，确定合适的CDN
	end
	CNAME的权威DNS --&gt;&gt; 本地DNS: 地址:xx.xx.xx.xx
	本地DNS --&gt;&gt; 浏览器: 地址:xx.xx.xx.xx
	浏览器 -&gt;&gt; CDN服务器: 请求
	CDN服务器 -&gt;&gt; 源站服务器: 请求
	源站服务器 --&gt;&gt; CDN服务器: 响应
	CDN服务器 --&gt;&gt; 浏览器: 缓存并响应
</div> <h2 id="内容分发">内容分发</h2> <p>通过智能化的路由解析，CDN节点实现了无论是对用户端还是服务端，都完全透明地中间接管了用户向服务发出的资源请求，后面随之而来的下一个问题就是CDN中必须缓存有用户想要请求的资源，然后才能代替源站来满足用户的资源请求。这包括了两个大的问题：“如何获取源站资源”和“如何管理（更新）资源”。</p> <p>CDN获取源站资源的过程被称为“内容分发”，目前主要有两种主流的内容分发方式：</p> <ul><li><strong>主动分发</strong>（Push）：分发由源站主动发起，将内容从源站或者其他资源库推送到各边缘的CDN节点上。这个推送的过程没有什么技术标准，可以采用任何传输方式（HTTP、FTP、P2P，等等）、任何推送策略（满足特定条件、定时、人工，等等）、任何推送时间，只要与后面说的更新策略先匹配即可。由于主动分发（通常）需要源站、CDN服务双方提供程序API接层面的配合，它并不是透明的，一般用于系统预载大量数据资源。譬如双十一之前一段时间内，淘宝、京东等各个网络商城就会开始把未来活动中所需用到的资源推送到CDN上，特别常用的资源甚至会直接缓存到你的手机APP、你浏览器的localStorage上。</li> <li><strong>被动回源</strong>（Pull）：回源由用户访问触发，由CDN服务发起。当某资源第一次被用户访问的时候，CDN会实时从源站获取，这时资源的响应时间可粗略认为是资源从源站到CDN的时间加上CDN到用户的时间之和，因此，被动回源的首次访问通常是比较慢（但并不一定比你直接访问源站慢）的， 不适合应用于大量的数据资源。但被动回源可以做到完全透明，不需要源站在程序上做任何的配合，使用起来较为方便，这种是小型站点使用CDN服务的主流选择（不是自建CDN，购买阿里云、腾讯云的CDN服务，多数就是这种方式）。</li></ul> <div class="custom-block center"><p><img src="/assets/img/ali-cdn.cd6a5448.png" alt="">
阿里云官网上的的CDN介绍</p></div> <p>对于“CDN如何管理（更新）资源”这个问题，同样没有统一的标准可言，尽管在HTTP协议中关于缓存的Header定义中确实是有对CDN这类共享缓存的一些指引性参数（如Cache-Control的s-maxage），但是否要遵循，完全取决于CDN本身的策略。更令人无奈的是，由于大多数网站的开发和运维本身并不了解HTTP缓存机制，所以CDN如果完全照着HTTP Header来控制缓存失效和更新，效果也会相当的差，还可能引发其他问题。因此，CDN缓存的管理并不存在通用的准则。</p> <h2 id="cdn应用">CDN应用</h2> <p>CDN是为了快速分发静态资源而设计的，但今天的CDN所能做的事情已经远远超越了开始建设时的目标，这部分无法展开逐一细说，只对现在CDN可以做的事情简要列举，以便有个总体认知：</p> <ul><li>加速静态资源：这是CDN本职工作。</li> <li>安全防御：CDN在广义上可以视作你网站的堡垒机，源站只对CDN提供服务，由CDN来对外界其他用户服务，这样恶意攻击者就不容易直接威胁源站，CDN对防御某些攻击手段，如<a href="https://zh.wikipedia.org/zh-tw/%E9%98%BB%E6%96%B7%E6%9C%8D%E5%8B%99%E6%94%BB%E6%93%8A" target="_blank" rel="noopener noreferrer">DDoS攻击<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>的尤其有效。但需注意，将安全都寄托在CDN上本身是不安全的，一旦源站真实IP被泄漏，就会面临很高风险。</li> <li>协议升级：不少CDN提供商都同时对接（代售CA的）SSL证书服务，可以实现源站是HTTP的，而对外开放的网站是基于HTTPS的。同理，可以实现源站到CDN是HTTP/1.x协议，CDN提供的外部服务是HTTPS/2.0协议、实现源站是基于IPv4网络的，CDN提供的外部服务支持IPv6网络，等等。</li> <li>状态缓存：第一节介绍缓存时简要提到了一下状态缓存，CDN不仅可以缓存源站的资源，还可以缓存源站的状态，譬如源站的301/302转向，可以缓存起来，让客户端直接跳转、可以通过CDN开启HSTS、可以通过CDN进行<a href="https://zh.wikipedia.org/wiki/OCSP%E8%A3%85%E8%AE%A2" target="_blank" rel="noopener noreferrer">OCSP装订<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>加速SSL证书访问，等等。有一些情况下甚至可以配置CDN对任意状态码（譬如404）进行一定时间的缓存，以减轻源站压力，但这个操作应当慎重。</li> <li>修改资源：CDN可以在返回资源给用户的时候修改它的任何内容，以实现不同的目的。譬如，可以对源站未压缩的资源自动压缩并修改Content-Encoding，以节省用户的网络带宽消耗、可以对源站未启用客户端缓存的内容加上缓存Header，以启用客户端缓存，可以修改<a href="https://developer.mozilla.org/zh-CN/docs/Glossary/CORS" target="_blank" rel="noopener noreferrer">CORS<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>的相关Header，将源站不支持跨域的资源提供跨域能力，等等。</li> <li>访问控制：CDN可以实现IP黑/白名单，根据不同的来访IP提供不同的响应结果，根据IP的访问流量来实现QoS控制、根据HTTP的Referer来实现防盗链，等等。</li> <li>注入功能：CDN可以在不修改源站代码的前提下，为源站注入各种功能，下图是国际CDN巨头CloudFlare提供的Google Analytics、PACE、Hardenize等第三方应用，均无需修改源站任何代码。<img src="/assets/img/cloudflare.1f16c80f.gif" alt=""></li> <li>绕过某些不存在的网络措施，这也是在国内申请CDN也必须实名备案的原因，就不细说了。</li> <li>…………</li></ul></div> <footer class="page-edit"><!----> <div class="git-hub-star"><span class="prefix">
      Kudos to
      <span style="position:relative;top:4px;right:-4px;"><a href="https://github.com/fenixsoft/awesome-fenix" aria-label="Star fenixsoft/awesome-fenix on GitHub" data-icon="octicon-star" data-show-count="true">
      Star
    </a></span></span></div> <div class="last-updated"><span class="prefix">总字数:</span> <span class="words">3,652</span> <span class="prefix">字　</span> <span class="prefix">最后更新:</span> <span class="time">6/18/2020, 9:18:00 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
    ←
    <a href="/architect-perspective/general-architecture/diversion-system/transmission-optimization.html" class="prev">
      传输链路
    </a></span> <span class="next"><a href="/architect-perspective/general-architecture/diversion-system/load-balancing.html">
      负载均衡
    </a>
    →
  </span></p></div> </main></div><div class="global-ui"><div></div><!----></div></div>
    <script src="/assets/js/app.35528d4b.js" defer></script><script src="/assets/js/3.02a1fb82.js" defer></script><script src="/assets/js/5.1f4b07a2.js" defer></script><script src="/assets/js/24.6b62fd7d.js" defer></script><script src="/assets/js/21.4b14faa8.js" defer></script><script src="/assets/js/41.b658a7ce.js" defer></script>
  </body>
</html>
