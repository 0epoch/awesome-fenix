<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>分布式共识算法 | 软件架构探索：The Fenix Project</title>
    <meta name="description" content="现代软件架构探索">
    <meta name="generator" content="VuePress 1.4.0">
    <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico">
    
    <link rel="preload" href="/assets/css/0.styles.159364f2.css" as="style"><link rel="preload" href="/assets/js/app.a4b0dffb.js" as="script"><link rel="preload" href="/assets/js/3.85e0994d.js" as="script"><link rel="preload" href="/assets/js/5.06c13e85.js" as="script"><link rel="preload" href="/assets/js/88.580b3ca5.js" as="script"><link rel="prefetch" href="/assets/js/1.a480e8c5.js"><link rel="prefetch" href="/assets/js/10.f92331f3.js"><link rel="prefetch" href="/assets/js/100.2d5497de.js"><link rel="prefetch" href="/assets/js/101.f0bdbd85.js"><link rel="prefetch" href="/assets/js/102.66f3e323.js"><link rel="prefetch" href="/assets/js/103.babd2439.js"><link rel="prefetch" href="/assets/js/104.70e4693d.js"><link rel="prefetch" href="/assets/js/105.0cd13f10.js"><link rel="prefetch" href="/assets/js/106.bbbed4b5.js"><link rel="prefetch" href="/assets/js/107.3126e7df.js"><link rel="prefetch" href="/assets/js/108.e2b74bff.js"><link rel="prefetch" href="/assets/js/109.c88fef2f.js"><link rel="prefetch" href="/assets/js/11.137f2edc.js"><link rel="prefetch" href="/assets/js/110.d205297b.js"><link rel="prefetch" href="/assets/js/111.f6b48cc5.js"><link rel="prefetch" href="/assets/js/112.a4ffc1df.js"><link rel="prefetch" href="/assets/js/113.3fd8f845.js"><link rel="prefetch" href="/assets/js/114.c205ec2e.js"><link rel="prefetch" href="/assets/js/115.c0f36781.js"><link rel="prefetch" href="/assets/js/116.c8a83388.js"><link rel="prefetch" href="/assets/js/117.43647408.js"><link rel="prefetch" href="/assets/js/118.6b442b5f.js"><link rel="prefetch" href="/assets/js/119.97f54bbe.js"><link rel="prefetch" href="/assets/js/12.38a00e84.js"><link rel="prefetch" href="/assets/js/120.8f672d89.js"><link rel="prefetch" href="/assets/js/121.fce7c0d8.js"><link rel="prefetch" href="/assets/js/122.d862a4aa.js"><link rel="prefetch" href="/assets/js/123.ade9743a.js"><link rel="prefetch" href="/assets/js/124.7d91acaa.js"><link rel="prefetch" href="/assets/js/125.acb4d09f.js"><link rel="prefetch" href="/assets/js/126.08ce46e1.js"><link rel="prefetch" href="/assets/js/127.6f887299.js"><link rel="prefetch" href="/assets/js/128.69f20192.js"><link rel="prefetch" href="/assets/js/129.c8adb6ac.js"><link rel="prefetch" href="/assets/js/13.d6e407e6.js"><link rel="prefetch" href="/assets/js/130.b6705740.js"><link rel="prefetch" href="/assets/js/131.892a1949.js"><link rel="prefetch" href="/assets/js/132.952c9003.js"><link rel="prefetch" href="/assets/js/133.aaeeaceb.js"><link rel="prefetch" href="/assets/js/134.3241149b.js"><link rel="prefetch" href="/assets/js/135.c4481576.js"><link rel="prefetch" href="/assets/js/136.3549a195.js"><link rel="prefetch" href="/assets/js/137.3468a686.js"><link rel="prefetch" href="/assets/js/14.52f62f7e.js"><link rel="prefetch" href="/assets/js/15.4ef1fc24.js"><link rel="prefetch" href="/assets/js/16.517b20a6.js"><link rel="prefetch" href="/assets/js/17.f8a19215.js"><link rel="prefetch" href="/assets/js/18.68fd4adb.js"><link rel="prefetch" href="/assets/js/19.03a4fca9.js"><link rel="prefetch" href="/assets/js/20.f2848098.js"><link rel="prefetch" href="/assets/js/21.6bac91e6.js"><link rel="prefetch" href="/assets/js/22.430e1e9b.js"><link rel="prefetch" href="/assets/js/23.ce138c8e.js"><link rel="prefetch" href="/assets/js/24.fd26c13d.js"><link rel="prefetch" href="/assets/js/25.5fd76ab7.js"><link rel="prefetch" href="/assets/js/26.7662056c.js"><link rel="prefetch" href="/assets/js/27.c9c1c36a.js"><link rel="prefetch" href="/assets/js/28.722d3f63.js"><link rel="prefetch" href="/assets/js/29.70adb2c1.js"><link rel="prefetch" href="/assets/js/30.17e31390.js"><link rel="prefetch" href="/assets/js/31.a188e8e3.js"><link rel="prefetch" href="/assets/js/32.6a99f811.js"><link rel="prefetch" href="/assets/js/33.9a5c0cd4.js"><link rel="prefetch" href="/assets/js/34.93b43989.js"><link rel="prefetch" href="/assets/js/35.f9c66e96.js"><link rel="prefetch" href="/assets/js/36.669f6897.js"><link rel="prefetch" href="/assets/js/37.70d6bc6c.js"><link rel="prefetch" href="/assets/js/38.c61d8585.js"><link rel="prefetch" href="/assets/js/39.d197cca0.js"><link rel="prefetch" href="/assets/js/4.2dce68e6.js"><link rel="prefetch" href="/assets/js/40.d7933e43.js"><link rel="prefetch" href="/assets/js/41.e682448c.js"><link rel="prefetch" href="/assets/js/42.510479f0.js"><link rel="prefetch" href="/assets/js/43.5c4588c7.js"><link rel="prefetch" href="/assets/js/44.8010876d.js"><link rel="prefetch" href="/assets/js/45.499c1532.js"><link rel="prefetch" href="/assets/js/46.1b1656e0.js"><link rel="prefetch" href="/assets/js/47.34f83ba2.js"><link rel="prefetch" href="/assets/js/48.55b2df4d.js"><link rel="prefetch" href="/assets/js/49.3dd1d506.js"><link rel="prefetch" href="/assets/js/50.0052f335.js"><link rel="prefetch" href="/assets/js/51.b72dfe67.js"><link rel="prefetch" href="/assets/js/52.1ddb5c3f.js"><link rel="prefetch" href="/assets/js/53.2a480e27.js"><link rel="prefetch" href="/assets/js/54.c018be22.js"><link rel="prefetch" href="/assets/js/55.80a00d72.js"><link rel="prefetch" href="/assets/js/56.fbb909bf.js"><link rel="prefetch" href="/assets/js/57.90a8eb3a.js"><link rel="prefetch" href="/assets/js/58.b2658403.js"><link rel="prefetch" href="/assets/js/59.646eaa1f.js"><link rel="prefetch" href="/assets/js/6.083828f6.js"><link rel="prefetch" href="/assets/js/60.9c0c45b5.js"><link rel="prefetch" href="/assets/js/61.6eb878f0.js"><link rel="prefetch" href="/assets/js/62.6ae2de27.js"><link rel="prefetch" href="/assets/js/63.8f39e05f.js"><link rel="prefetch" href="/assets/js/64.5dbff7f1.js"><link rel="prefetch" href="/assets/js/65.d71d088c.js"><link rel="prefetch" href="/assets/js/66.5c5534fe.js"><link rel="prefetch" href="/assets/js/67.73fc0a2d.js"><link rel="prefetch" href="/assets/js/68.77063fe8.js"><link rel="prefetch" href="/assets/js/69.87667830.js"><link rel="prefetch" href="/assets/js/7.d84e795f.js"><link rel="prefetch" href="/assets/js/70.197cd082.js"><link rel="prefetch" href="/assets/js/71.e8660168.js"><link rel="prefetch" href="/assets/js/72.86994ff4.js"><link rel="prefetch" href="/assets/js/73.2f038c98.js"><link rel="prefetch" href="/assets/js/74.832c1d08.js"><link rel="prefetch" href="/assets/js/75.32d8d1c8.js"><link rel="prefetch" href="/assets/js/76.aa57da0c.js"><link rel="prefetch" href="/assets/js/77.eec774d9.js"><link rel="prefetch" href="/assets/js/78.9d731e6f.js"><link rel="prefetch" href="/assets/js/79.8f1d5bac.js"><link rel="prefetch" href="/assets/js/8.664c9010.js"><link rel="prefetch" href="/assets/js/80.10a36eff.js"><link rel="prefetch" href="/assets/js/81.89bfe8fc.js"><link rel="prefetch" href="/assets/js/82.2be24458.js"><link rel="prefetch" href="/assets/js/83.b27ba0ec.js"><link rel="prefetch" href="/assets/js/84.ee267afa.js"><link rel="prefetch" href="/assets/js/85.11865e50.js"><link rel="prefetch" href="/assets/js/86.5ccc571e.js"><link rel="prefetch" href="/assets/js/87.5da710aa.js"><link rel="prefetch" href="/assets/js/89.72aa68e5.js"><link rel="prefetch" href="/assets/js/9.07f3ab19.js"><link rel="prefetch" href="/assets/js/90.af61592a.js"><link rel="prefetch" href="/assets/js/91.d1ff8407.js"><link rel="prefetch" href="/assets/js/92.e9ef73b7.js"><link rel="prefetch" href="/assets/js/93.ef31bd6e.js"><link rel="prefetch" href="/assets/js/94.0ae8e4d2.js"><link rel="prefetch" href="/assets/js/95.57697871.js"><link rel="prefetch" href="/assets/js/96.6686c549.js"><link rel="prefetch" href="/assets/js/97.bcb69846.js"><link rel="prefetch" href="/assets/js/98.ae97cb8c.js"><link rel="prefetch" href="/assets/js/99.e0e2f868.js">
    <link rel="stylesheet" href="/assets/css/0.styles.159364f2.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/images/logo-color.png" alt="软件架构探索：The Fenix Project" class="logo"> <span class="site-name can-hide">软件架构探索：The Fenix Project</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="代码" class="dropdown-title"><span class="title">代码</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/fenixsoft/awesome-fenix" target="_blank" rel="noopener noreferrer" class="nav-link external">
  文档工程 Awesome-Fenix
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/fenixsoft/fenix-bookstore-frontend" target="_blank" rel="noopener noreferrer" class="nav-link external">
  前端工程 Fenix's Bookstore
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/fenixsoft/monolithic_arch_springboot" target="_blank" rel="noopener noreferrer" class="nav-link external">
  后端：单体架构 SpringBoot
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/fenixsoft/microservice_arch_springcloud" target="_blank" rel="noopener noreferrer" class="nav-link external">
  后端：微服务架构 SpringCloud
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/fenixsoft/microservice_arch_kubernetes" target="_blank" rel="noopener noreferrer" class="nav-link external">
  后端：微服务架构 Kubernetes
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/fenixsoft/serverless_arch_knative" target="_blank" rel="noopener noreferrer" class="nav-link external">
  后端：无服务架构 Knative
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div><div class="nav-item"><a href="http://bookstore.icyfenix.cn" target="_blank" rel="noopener noreferrer" class="nav-link external">
  示例
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://icyfenix.cn/pdf/the-fenix-project.pdf" target="_blank" rel="noopener noreferrer" class="nav-link external">
  PDF下载
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="/board.html" class="nav-link">
  讨论区
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="代码" class="dropdown-title"><span class="title">代码</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/fenixsoft/awesome-fenix" target="_blank" rel="noopener noreferrer" class="nav-link external">
  文档工程 Awesome-Fenix
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/fenixsoft/fenix-bookstore-frontend" target="_blank" rel="noopener noreferrer" class="nav-link external">
  前端工程 Fenix's Bookstore
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/fenixsoft/monolithic_arch_springboot" target="_blank" rel="noopener noreferrer" class="nav-link external">
  后端：单体架构 SpringBoot
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/fenixsoft/microservice_arch_springcloud" target="_blank" rel="noopener noreferrer" class="nav-link external">
  后端：微服务架构 SpringCloud
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/fenixsoft/microservice_arch_kubernetes" target="_blank" rel="noopener noreferrer" class="nav-link external">
  后端：微服务架构 Kubernetes
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/fenixsoft/serverless_arch_knative" target="_blank" rel="noopener noreferrer" class="nav-link external">
  后端：无服务架构 Knative
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div><div class="nav-item"><a href="http://bookstore.icyfenix.cn" target="_blank" rel="noopener noreferrer" class="nav-link external">
  示例
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://icyfenix.cn/pdf/the-fenix-project.pdf" target="_blank" rel="noopener noreferrer" class="nav-link external">
  PDF下载
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="/board.html" class="nav-link">
  讨论区
</a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/summary/" class="sidebar-link">目录</a></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>前言</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/introduction/about-me.html" class="sidebar-link">✔️ 关于作者</a></li><li><a href="/introduction/about-the-fenix-project.html" class="sidebar-link">✔️ 什么是“The Fenix Project”</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>探索起步</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading open"><span>阅读指引</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/CHANGELOG.html" class="sidebar-link">✔️ 更新日志</a></li><li><a href="/exploration/guide/quick-start.html" class="sidebar-link">✔️ 如何开始</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><a href="/exploration/projects/" class="sidebar-heading clickable"><span>✔️ 技术演示工程</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/exploration/projects/fenix-bookstore-frontend.html" class="sidebar-link">✔️ 前端工程</a></li><li><a href="/exploration/projects/monolithic_arch_springboot.html" class="sidebar-link">✔️ 后端工程：Spring Boot</a></li><li><a href="/exploration/projects/microservice_arch_springcloud.html" class="sidebar-link">✔️ 后端工程：Spring Cloud</a></li><li><a href="/exploration/projects/microservice_arch_kubernetes.html" class="sidebar-link">后端工程：Kubernetes</a></li><li><a href="/exploration/projects/serverless_arch_knative.html" class="sidebar-link">后端工程：Knative</a></li></ul></section></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>设计者的视角</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group is-sub-group depth-1"><a href="/architect-perspective/general-architecture/" class="sidebar-heading clickable open"><span>✔️ 架构的普适问题</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group collapsable is-sub-group depth-2"><a href="/architect-perspective/general-architecture/api-style/" class="sidebar-heading clickable open"><span>✔️ 服务风格设计</span> <span class="arrow down"></span></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/architect-perspective/general-architecture/api-style/rpc.html" class="sidebar-link">✔️ 远程服务调用</a></li><li><a href="/architect-perspective/general-architecture/api-style/rest.html" class="sidebar-link">✔️ RESTful服务</a></li><li><a href="/architect-perspective/general-architecture/api-style/mq.html" class="sidebar-link">异步服务调用</a></li></ul></section></li><li><section class="sidebar-group collapsable is-sub-group depth-2"><a href="/architect-perspective/general-architecture/system-security/" class="sidebar-heading clickable"><span>✔️ 安全架构</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-2"><a href="/architect-perspective/general-architecture/transaction/" class="sidebar-heading clickable"><span>✔️ 事务一致性</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-2"><a href="/architect-perspective/general-architecture/diversion-system/" class="sidebar-heading clickable"><span>✔️ 透明多级分流系统</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-2"><a href="/architect-perspective/general-architecture/concurrent/" class="sidebar-heading clickable"><span>高效并发</span> <span class="arrow right"></span></a> <!----></section></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>设计方法论</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/architect-perspective/methodology/layered-system.html" class="sidebar-link">系统分层</a></li><li><a href="/architect-perspective/methodology/capacity-design.html" class="sidebar-link">容量规划</a></li><li><a href="/architect-perspective/methodology/constraint.html" class="sidebar-link">非功能属性设计</a></li></ul></section></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>演进中的架构</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group is-sub-group depth-1"><a href="/architecture/architect-history/" class="sidebar-heading clickable open"><span>✔️ 服务架构演进史</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/architecture/architect-history/primitive-distribution.html" class="sidebar-link">✔️ 原始分布式时代</a></li><li><a href="/architecture/architect-history/monolithic.html" class="sidebar-link">✔️ 单体系统时代</a></li><li><a href="/architecture/architect-history/soa.html" class="sidebar-link">✔️ SOA时代</a></li><li><a href="/architecture/architect-history/microservices.html" class="sidebar-link">✔️ 微服务时代</a></li><li><a href="/architecture/architect-history/post-microservices.html" class="sidebar-link">✔️ 后微服务时代</a></li><li><a href="/architecture/architect-history/serverless.html" class="sidebar-link">✔️ 无服务时代</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>从架构到实现</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/architecture/architect-framework/j2ee-base-arch.html" class="sidebar-link">基于J2EE的单体架构</a></li><li><a href="/architecture/architect-framework/springboot-base-arch.html" class="sidebar-link">基于Spring Boot的单体架构</a></li><li><a href="/architecture/architect-framework/springcloud-base-arch.html" class="sidebar-link">基于Spring Cloud微服务架构</a></li><li><a href="/architecture/architect-framework/kubernetes-base-arch.html" class="sidebar-link">基于Kubernetes的微服务架构</a></li><li><a href="/architecture/architect-framework/servicemesh-lstio-arch.html" class="sidebar-link">基于Istio的服务网格架构</a></li><li><a href="/architecture/architect-framework/serverless-arch-knative.html" class="sidebar-link">基于Knative的无服务架构</a></li><li><a href="/architecture/architect-framework/serverless-arch-kubeless.html" class="sidebar-link">基于Kubeless的无服务架构</a></li></ul></section></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>分布式的基石</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group is-sub-group depth-1"><a href="/distribution/consensus/" class="sidebar-heading clickable router-link-exact-active router-link-active open active"><span>✔️ 分布式共识算法</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/distribution/consensus/paxos.html" class="sidebar-link">✔️ Paxos</a></li><li><a href="/distribution/consensus/raft.html" class="sidebar-link">Raft与ZAB</a></li><li><a href="/distribution/consensus/gossip.html" class="sidebar-link">Gossip协议</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><a href="/distribution/service-discovery/" class="sidebar-heading clickable"><span>服务发现</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/distribution/service-discovery/service-routing.html" class="sidebar-link">服务路由与网关</a></li><li><a href="/distribution/service-discovery/load-balancing.html" class="sidebar-link">进程内负载均衡</a></li><li><a href="/distribution/service-discovery/composer.html" class="sidebar-link">服务编排</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><a href="/distribution/fault-tolerance/" class="sidebar-heading clickable"><span>服务容错</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/distribution/fault-tolerance/isolation.html" class="sidebar-link">隔离</a></li><li><a href="/distribution/fault-tolerance/breaker.html" class="sidebar-link">熔断</a></li><li><a href="/distribution/fault-tolerance/timeout.html" class="sidebar-link">超时</a></li><li><a href="/distribution/fault-tolerance/traffic-control.html" class="sidebar-link">流控</a></li><li><a href="/distribution/fault-tolerance/service-downgrade.html" class="sidebar-link">降级</a></li><li><a href="/distribution/fault-tolerance/exception-inject.html" class="sidebar-link">异常注入</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><a href="/distribution/service-monitoring/" class="sidebar-heading clickable"><span>服务监控</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/distribution/service-monitoring/logging.html" class="sidebar-link">日志聚合</a></li><li><a href="/distribution/service-monitoring/invokechain-trace.html" class="sidebar-link">链路跟踪</a></li><li><a href="/distribution/service-monitoring/apm.html" class="sidebar-link">应用性能管理</a></li></ul></section></li><li><a href="/distribution/configuration.html" class="sidebar-link">中心化配置</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>不可变基础设施</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/immutable-infrastructure/history.html" class="sidebar-link">概念与演进历史</a></li><li><section class="sidebar-group is-sub-group depth-1"><a href="/immutable-infrastructure/container/" class="sidebar-heading clickable"><span>容器</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/immutable-infrastructure/container/cri.html" class="sidebar-link">CRI接口</a></li><li><a href="/immutable-infrastructure/container/resource-isolation.html" class="sidebar-link">资源隔离</a></li><li><a href="/immutable-infrastructure/container/image.html" class="sidebar-link">镜像</a></li><li><a href="/immutable-infrastructure/container/manage.html" class="sidebar-link">容器管理</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><a href="/immutable-infrastructure/network/" class="sidebar-heading clickable"><span>网络</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/immutable-infrastructure/network/cni.html" class="sidebar-link">CNI接口</a></li><li><a href="/immutable-infrastructure/network/container-lb.html" class="sidebar-link">容器负载均衡</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><a href="/immutable-infrastructure/storage/" class="sidebar-heading clickable"><span>存储</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/immutable-infrastructure/storage/csi.html" class="sidebar-link">CSI接口</a></li><li><a href="/immutable-infrastructure/storage/storage-plugins.html" class="sidebar-link">共享存储插件</a></li></ul></section></li><li><a href="/immutable-infrastructure/gpu-support.html" class="sidebar-link">GPU虚拟化</a></li><li><a href="/immutable-infrastructure/hardware-schedule.html" class="sidebar-link">硬件资源调度</a></li><li><a href="/immutable-infrastructure/cloud-native.html" class="sidebar-link">云原生环境</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>技巧与专题</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group is-sub-group depth-1"><a href="/tricks/graalvm/" class="sidebar-heading clickable open"><span>✔️ Graal VM</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/tricks/graalvm/graal-compiler.html" class="sidebar-link">✔️ 新一代即时编译器</a></li><li><a href="/tricks/graalvm/substratevm.html" class="sidebar-link">✔️ 向原生迈进</a></li><li><a href="/tricks/graalvm/graalvm-native.html" class="sidebar-link">✔️ 没有虚拟机的Java</a></li><li><a href="/tricks/graalvm/spring-over-graal.html" class="sidebar-link">✔️ Spring over Graal</a></li></ul></section></li><li><a href="/tricks/responsive-programming.html" class="sidebar-link">响应式编程</a></li><li><a href="/tricks/zero-copy.html" class="sidebar-link">零拷贝</a></li><li><a href="/tricks/stream-computing.html" class="sidebar-link">流式计算</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>附录</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/appendix/build-script.html" class="sidebar-link">构建发布脚本</a></li><li><a href="/appendix/continuous-integration.html" class="sidebar-link">持续集成</a></li><li><a href="/appendix/gated-launch.html" class="sidebar-link">灰度发布</a></li><li><section class="sidebar-group is-sub-group depth-1"><a href="/appendix/deployment-env-setup/" class="sidebar-heading clickable"><span>✔️ 环境依赖</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/appendix/deployment-env-setup/setup-docker.html" class="sidebar-link">✔️ 部署Docker CE容器环境</a></li><li><section class="sidebar-group collapsable is-sub-group depth-2"><a href="/appendix/deployment-env-setup/setup-kubernetes/" class="sidebar-heading clickable"><span>✔️ 部署Kubernetes集群</span> <span class="arrow right"></span></a> <!----></section></li></ul></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/appendix/operation-env-setup/" class="sidebar-heading clickable"><span>运维环境</span> <span class="arrow right"></span></a> <!----></section></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="分布式共识算法">分布式共识算法</h1> <div class="custom-block tip"><p class="custom-block-title">前置知识</p> <p>关于分布式中CAP问题，请先阅读“<a href="/architect-perspective/general-architecture/transaction/distributed.html">分布式事务</a>”中的介绍，后文中提及的一致性、可用性、网络分区等概念，均在此文中有过介绍。</p></div> <p>在本章正式开始探讨各种分布式环境中面临的技术问题和解决方案之前，笔者先安排一篇“纯理论”的文章，来分析分布式环境中对共享数据操作的本质。分布式系统里，如果准备在各个分布式节点中进行一致的操作，并且期望获得一致的结果，均可以理解为是一种“<a href="https://en.wikipedia.org/wiki/State_machine_replication" target="_blank" rel="noopener noreferrer">状态机复制<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>”（State Machine Replication）过程，无论这个操作是新增、修改、删除抑或是其他可能的程序行为，都可以理解为要将一连串的操作日志正确地复制到各个分布式节点上，如果分布式系统各个节点的初始状态一致，接受到的操作序列都相同，那各个节点最终都能得到一致的状态。这句话听起来颇为抽象，如果你现在暂时不能理解的话，不妨先在心中回想一下经典数据库中的重做和回滚日志的做法，然后跟后续的讲解进行类比。</p> <p>为了解释清楚分布式环境中共享数据所面临的问题，笔者先从一个最浅显的场景开始说起：</p> <blockquote><p>如果你有一份很重要的数据，要确保它长期存储在电脑上不会丢失，你会怎么做？</p></blockquote> <p>这不是什么脑筋急转弯的古怪问题，答案就是去买几块硬盘，把数据在不同磁盘上多备份几个副本。假设一块硬盘每年损坏的概率是5%，那把文件复制到另一块备份盘上，由于两块磁盘同时损坏而丢失数据的概率就只有0.25%，如果使用三块硬盘存储则是0.00125%，四块是0.0000625%，换而言之，这已经保证了数据超过99.9999%的概率是不会丢失的。</p> <p>在软件系统里，要保障系统的可靠性，采用的办法也和那几个备份磁盘大体上并无区别，单个节点的系统宕机无法提供服务的原因可能有很多，譬如程序出错、硬件损坏、网络分区、电源断电，等等，往往一年中出现系统宕机的概率要远高于5%，这更加决定了软件系统也必须有多台机器能够拥有一致的数据，才能对外提供一致的服务。但分布式的软件系统与备份磁盘又有着本质的区别，磁盘之间是孤立的，不需要互相通讯，备份数据初始化后状态就是不变的，由人工完成的文件复制操作保障了数据各个副本的一致；而分布式系统里面，我们必须考虑数据如何在可能出现分区的网络环境下在各个节点之间正确复制的问题：</p> <blockquote><p>如果你有一份很重要的数据，要确保它正确地存储于集群中的几台不同机器之上，你会怎么做？</p></blockquote> <p>一个最容易想到的答案是“同步”（Synchronous）：每当数据有变化，把变化情况在各个节点间的复制视作一种原子性的操作，只有集群中每一台机器都反馈成功地完成磁盘写入后，数据的变化才宣告成功，我们在<a href="/architect-perspective/general-architecture/transaction/global">前文</a>中曾经讲解过，可以使用2PC/3PC来实现这种同步操作。同步的其中一种真实应用场景是数据库中的主从全同步复制（Fully Synchronous Replication），譬如MySQL Cluster，进行全同步复制时，会等待所有Slave的Binlog都完成写入后，Master的事务才进行提交。这里有一个显而易见的问题，尽管可以确保Master和Slave中的数据是是绝对一致的，但任何一个Slave节点因为任何原因未响应均都会阻塞整个事务，每增加一个Slave，都导致造成整个系统可用性风险增加一分。显然这种简单的一致性保障手段，是以完全牺牲可用性为代价的，我们在建设分布式系统的时候，往往不能承受这种代价，一些关键系统，在要求数据正确的前提下，对可用性的要求也非常苛刻，譬如要达到99.99999%可用的程度，这就引出了我们的第三个问题：</p> <blockquote><p>如果你有一份很重要的数据，要确保它正确地存储于集群中的几台不同机器之上，并且要尽可能保证及时地应用到正确的数据，你会怎么做？</p></blockquote> <p>在网络分区不可能消除的前提下，一致性与可用性的矛盾造成了增加机器数量反而带来可用性的降低，为缓解这个矛盾，我们不再追求集群内所有节点在任何情况下的数据状态都一致，改为采用“少数服从多数”的原则，一旦数据变化在集群过半数的节点中完成了复制，就认为数据的变化已经正确地存储在系统当中，这样就可以容忍少数（不超过半数）的机器形成网络分区，使得增加机器数量对集群可用性变成是有益的。此模式在分布式中被称为“<a href="https://en.wikipedia.org/wiki/Quorum_(distributed_computing)" target="_blank" rel="noopener noreferrer">Quorum机制<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>”，或者可以直接形象地称其为“多数派机制”（Majority）。在这个前提下，我们需要设计一种算法，能够让分布式系统内部可以暂时容忍存在不同的状态，但最终全部节点的状态均能够达成一致；同时能够让分布式系统外部看来，始终表现出整体一致的结果，这个过程，我们称其为“协商共识”（Consensus）。</p> <p>请注意共识与一致性（Consistency）的区别，一致性指的是数据不同副本之间的差异，而共识是指达成一致性的方法与过程。由于翻译的关系，很多中文资料把Consensus同样翻译为“一致性”，导致网络上大量的二手中文资料把这两个概念混淆起来，如果你在网上看到“分布式一致性算法”，应明白其所指其实是“Distributed Consensus Algorithm”。</p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">总字数:</span> <span class="words">1,843</span> <span class="prefix">字　</span> <span class="prefix">最后更新:</span> <span class="time">5/8/2020, 4:02:28 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
    ←
    <a href="/architecture/architect-framework/serverless-arch-kubeless.html" class="prev">
      基于Kubeless的无服务架构
    </a></span> <span class="next"><a href="/distribution/consensus/paxos.html">
      Paxos
    </a>
    →
  </span></p></div> </main></div><div class="global-ui"><div></div><!----></div></div>
    <script src="/assets/js/app.a4b0dffb.js" defer></script><script src="/assets/js/3.85e0994d.js" defer></script><script src="/assets/js/5.06c13e85.js" defer></script><script src="/assets/js/88.580b3ca5.js" defer></script>
  </body>
</html>
