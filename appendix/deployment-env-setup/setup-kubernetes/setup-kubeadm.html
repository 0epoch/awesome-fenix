<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>使用Kubeadm部署 | 软件架构探索：The Fenix Project</title>
    <meta name="description" content="现代软件架构探索">
    <meta name="generator" content="VuePress 1.4.0">
    <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico">
    
    <link rel="preload" href="/assets/css/0.styles.b4f5acd1.css" as="style"><link rel="preload" href="/assets/js/app.51ccb962.js" as="script"><link rel="preload" href="/assets/js/3.95a2b2fa.js" as="script"><link rel="preload" href="/assets/js/6.3b617915.js" as="script"><link rel="preload" href="/assets/js/25.bab3efd5.js" as="script"><link rel="preload" href="/assets/js/42.87752af5.js" as="script"><link rel="prefetch" href="/assets/js/1.d4d05d67.js"><link rel="prefetch" href="/assets/js/10.010f3dee.js"><link rel="prefetch" href="/assets/js/100.7ad2be8f.js"><link rel="prefetch" href="/assets/js/101.c87dc462.js"><link rel="prefetch" href="/assets/js/102.6fe4e1ec.js"><link rel="prefetch" href="/assets/js/103.5898c997.js"><link rel="prefetch" href="/assets/js/104.b5064f70.js"><link rel="prefetch" href="/assets/js/105.fbdd277a.js"><link rel="prefetch" href="/assets/js/106.f1f4c426.js"><link rel="prefetch" href="/assets/js/107.73e32852.js"><link rel="prefetch" href="/assets/js/108.5e5eb88d.js"><link rel="prefetch" href="/assets/js/109.96c95133.js"><link rel="prefetch" href="/assets/js/11.c03a2b21.js"><link rel="prefetch" href="/assets/js/110.4dd701f8.js"><link rel="prefetch" href="/assets/js/111.e8dc57f5.js"><link rel="prefetch" href="/assets/js/112.d815b87d.js"><link rel="prefetch" href="/assets/js/113.1592b73d.js"><link rel="prefetch" href="/assets/js/114.1eff79ee.js"><link rel="prefetch" href="/assets/js/115.919bfc57.js"><link rel="prefetch" href="/assets/js/116.ce8e8ec2.js"><link rel="prefetch" href="/assets/js/117.28ccd97f.js"><link rel="prefetch" href="/assets/js/118.febf871a.js"><link rel="prefetch" href="/assets/js/119.8f06b803.js"><link rel="prefetch" href="/assets/js/12.6a4216a9.js"><link rel="prefetch" href="/assets/js/120.adf08c2d.js"><link rel="prefetch" href="/assets/js/121.8d73e6ce.js"><link rel="prefetch" href="/assets/js/122.3abaaea4.js"><link rel="prefetch" href="/assets/js/123.78306484.js"><link rel="prefetch" href="/assets/js/124.6d1c1158.js"><link rel="prefetch" href="/assets/js/125.41e036c1.js"><link rel="prefetch" href="/assets/js/126.43690013.js"><link rel="prefetch" href="/assets/js/127.1baf13ac.js"><link rel="prefetch" href="/assets/js/128.65fcecea.js"><link rel="prefetch" href="/assets/js/129.a79ad50f.js"><link rel="prefetch" href="/assets/js/13.cb001b25.js"><link rel="prefetch" href="/assets/js/130.4f0a4604.js"><link rel="prefetch" href="/assets/js/131.2c51e021.js"><link rel="prefetch" href="/assets/js/132.a3f5f8ed.js"><link rel="prefetch" href="/assets/js/133.4d938d69.js"><link rel="prefetch" href="/assets/js/134.59a84796.js"><link rel="prefetch" href="/assets/js/135.6b9c7fde.js"><link rel="prefetch" href="/assets/js/136.254760da.js"><link rel="prefetch" href="/assets/js/137.c87ebd78.js"><link rel="prefetch" href="/assets/js/138.98d053d5.js"><link rel="prefetch" href="/assets/js/139.2f43f882.js"><link rel="prefetch" href="/assets/js/14.21db2ca8.js"><link rel="prefetch" href="/assets/js/140.affef7ea.js"><link rel="prefetch" href="/assets/js/141.1b13d685.js"><link rel="prefetch" href="/assets/js/142.d4afde6d.js"><link rel="prefetch" href="/assets/js/143.a19d9ee1.js"><link rel="prefetch" href="/assets/js/144.57a598b7.js"><link rel="prefetch" href="/assets/js/145.20c1fdb9.js"><link rel="prefetch" href="/assets/js/146.70685c90.js"><link rel="prefetch" href="/assets/js/147.0166cf3c.js"><link rel="prefetch" href="/assets/js/148.318370fa.js"><link rel="prefetch" href="/assets/js/149.08e6ce24.js"><link rel="prefetch" href="/assets/js/15.82542e1c.js"><link rel="prefetch" href="/assets/js/150.13ceeb6e.js"><link rel="prefetch" href="/assets/js/151.ef87a325.js"><link rel="prefetch" href="/assets/js/152.48c3ff44.js"><link rel="prefetch" href="/assets/js/153.8f9daae2.js"><link rel="prefetch" href="/assets/js/154.00bf349f.js"><link rel="prefetch" href="/assets/js/155.c92ad179.js"><link rel="prefetch" href="/assets/js/156.f081b984.js"><link rel="prefetch" href="/assets/js/157.993a88a7.js"><link rel="prefetch" href="/assets/js/16.b65acfb6.js"><link rel="prefetch" href="/assets/js/17.8ea75f37.js"><link rel="prefetch" href="/assets/js/18.545600ce.js"><link rel="prefetch" href="/assets/js/19.7b7cc823.js"><link rel="prefetch" href="/assets/js/20.0351ca3d.js"><link rel="prefetch" href="/assets/js/21.794c8421.js"><link rel="prefetch" href="/assets/js/22.ea5f50ff.js"><link rel="prefetch" href="/assets/js/23.b5d621c4.js"><link rel="prefetch" href="/assets/js/24.ddc6dc98.js"><link rel="prefetch" href="/assets/js/26.fc37f7af.js"><link rel="prefetch" href="/assets/js/27.d2864847.js"><link rel="prefetch" href="/assets/js/28.5f6e8877.js"><link rel="prefetch" href="/assets/js/29.c059ca70.js"><link rel="prefetch" href="/assets/js/30.cc446644.js"><link rel="prefetch" href="/assets/js/31.972baeb3.js"><link rel="prefetch" href="/assets/js/32.7d4348cd.js"><link rel="prefetch" href="/assets/js/33.6e755ad9.js"><link rel="prefetch" href="/assets/js/34.bedd1670.js"><link rel="prefetch" href="/assets/js/35.27f8df43.js"><link rel="prefetch" href="/assets/js/36.1496a873.js"><link rel="prefetch" href="/assets/js/37.620c4d9d.js"><link rel="prefetch" href="/assets/js/38.77fc5d8e.js"><link rel="prefetch" href="/assets/js/39.8cfcbbce.js"><link rel="prefetch" href="/assets/js/4.b45cdbf7.js"><link rel="prefetch" href="/assets/js/40.9010c6eb.js"><link rel="prefetch" href="/assets/js/41.99be3938.js"><link rel="prefetch" href="/assets/js/43.f0402756.js"><link rel="prefetch" href="/assets/js/44.5f7595e2.js"><link rel="prefetch" href="/assets/js/45.9e65655a.js"><link rel="prefetch" href="/assets/js/46.6050eaa4.js"><link rel="prefetch" href="/assets/js/47.482e831d.js"><link rel="prefetch" href="/assets/js/48.1ed4b906.js"><link rel="prefetch" href="/assets/js/49.2644a37b.js"><link rel="prefetch" href="/assets/js/5.b92bc60a.js"><link rel="prefetch" href="/assets/js/50.ff6c1b39.js"><link rel="prefetch" href="/assets/js/51.cff8aac2.js"><link rel="prefetch" href="/assets/js/52.b26b229c.js"><link rel="prefetch" href="/assets/js/53.c7183ea6.js"><link rel="prefetch" href="/assets/js/54.af7bf251.js"><link rel="prefetch" href="/assets/js/55.8bb573da.js"><link rel="prefetch" href="/assets/js/56.25525444.js"><link rel="prefetch" href="/assets/js/57.a9b089d0.js"><link rel="prefetch" href="/assets/js/58.2a00cb73.js"><link rel="prefetch" href="/assets/js/59.b3d03ee6.js"><link rel="prefetch" href="/assets/js/60.64d78830.js"><link rel="prefetch" href="/assets/js/61.233ad293.js"><link rel="prefetch" href="/assets/js/62.09435036.js"><link rel="prefetch" href="/assets/js/63.db8045f1.js"><link rel="prefetch" href="/assets/js/64.3b9e64d8.js"><link rel="prefetch" href="/assets/js/65.7a852941.js"><link rel="prefetch" href="/assets/js/66.a71b3dc9.js"><link rel="prefetch" href="/assets/js/67.7dd205c2.js"><link rel="prefetch" href="/assets/js/68.6d91272a.js"><link rel="prefetch" href="/assets/js/69.1fbff3c8.js"><link rel="prefetch" href="/assets/js/7.378387db.js"><link rel="prefetch" href="/assets/js/70.c0e04b35.js"><link rel="prefetch" href="/assets/js/71.0530d05a.js"><link rel="prefetch" href="/assets/js/72.e492df8e.js"><link rel="prefetch" href="/assets/js/73.376e9c01.js"><link rel="prefetch" href="/assets/js/74.8ccefcc1.js"><link rel="prefetch" href="/assets/js/75.d94118d6.js"><link rel="prefetch" href="/assets/js/76.4aea91f7.js"><link rel="prefetch" href="/assets/js/77.13e580f7.js"><link rel="prefetch" href="/assets/js/78.423f0c20.js"><link rel="prefetch" href="/assets/js/79.da1a49f8.js"><link rel="prefetch" href="/assets/js/8.d8ef3c1c.js"><link rel="prefetch" href="/assets/js/80.66b4e68d.js"><link rel="prefetch" href="/assets/js/81.1c19620e.js"><link rel="prefetch" href="/assets/js/82.0fcc7186.js"><link rel="prefetch" href="/assets/js/83.bcd7e501.js"><link rel="prefetch" href="/assets/js/84.ef99b424.js"><link rel="prefetch" href="/assets/js/85.8c87bb54.js"><link rel="prefetch" href="/assets/js/86.6c458758.js"><link rel="prefetch" href="/assets/js/87.7a296d18.js"><link rel="prefetch" href="/assets/js/88.87237172.js"><link rel="prefetch" href="/assets/js/89.978913e7.js"><link rel="prefetch" href="/assets/js/9.6c904c68.js"><link rel="prefetch" href="/assets/js/90.1597be00.js"><link rel="prefetch" href="/assets/js/91.d7d2ea41.js"><link rel="prefetch" href="/assets/js/92.0d9bfc57.js"><link rel="prefetch" href="/assets/js/93.2c9366c9.js"><link rel="prefetch" href="/assets/js/94.248d0ce1.js"><link rel="prefetch" href="/assets/js/95.f11e969e.js"><link rel="prefetch" href="/assets/js/96.364e652e.js"><link rel="prefetch" href="/assets/js/97.220920a3.js"><link rel="prefetch" href="/assets/js/98.66d24719.js"><link rel="prefetch" href="/assets/js/99.6b7caffa.js">
    <link rel="stylesheet" href="/assets/css/0.styles.b4f5acd1.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/images/logo-color.png" alt="软件架构探索：The Fenix Project" class="logo"> <span class="site-name can-hide">软件架构探索：The Fenix Project</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="代码" class="dropdown-title"><span class="title">代码</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/fenixsoft/awesome-fenix" target="_blank" rel="noopener noreferrer" class="nav-link external">
  文档工程 Awesome-Fenix
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/fenixsoft/fenix-bookstore-frontend" target="_blank" rel="noopener noreferrer" class="nav-link external">
  前端工程 Fenix's Bookstore
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://bookstore.icyfenix.cn" target="_blank" rel="noopener noreferrer" class="nav-link external">
  前端工程在线示例 Fenix's Bookstore
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/fenixsoft/monolithic_arch_springboot" target="_blank" rel="noopener noreferrer" class="nav-link external">
  后端：单体架构 Spring Boot
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/fenixsoft/microservice_arch_springcloud" target="_blank" rel="noopener noreferrer" class="nav-link external">
  后端：微服务架构 Spring Cloud
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/fenixsoft/microservice_arch_kubernetes" target="_blank" rel="noopener noreferrer" class="nav-link external">
  后端：微服务架构 Kubernetes
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/fenixsoft/servicemesh_arch_istio" target="_blank" rel="noopener noreferrer" class="nav-link external">
  后端：微服务架构 Istio
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/fenixsoft/serverless_arch_awslambda" target="_blank" rel="noopener noreferrer" class="nav-link external">
  后端：无服务架构 AWS Lambda
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div><div class="nav-item"><a href="https://raw.githubusercontent.com/fenixsoft/awesome-fenix/gh-pages/pdf/the-fenix-project.pdf" target="_blank" rel="noopener noreferrer" class="nav-link external">
  PDF下载
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="/board/" class="nav-link">
  讨论区
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="代码" class="dropdown-title"><span class="title">代码</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/fenixsoft/awesome-fenix" target="_blank" rel="noopener noreferrer" class="nav-link external">
  文档工程 Awesome-Fenix
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/fenixsoft/fenix-bookstore-frontend" target="_blank" rel="noopener noreferrer" class="nav-link external">
  前端工程 Fenix's Bookstore
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://bookstore.icyfenix.cn" target="_blank" rel="noopener noreferrer" class="nav-link external">
  前端工程在线示例 Fenix's Bookstore
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/fenixsoft/monolithic_arch_springboot" target="_blank" rel="noopener noreferrer" class="nav-link external">
  后端：单体架构 Spring Boot
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/fenixsoft/microservice_arch_springcloud" target="_blank" rel="noopener noreferrer" class="nav-link external">
  后端：微服务架构 Spring Cloud
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/fenixsoft/microservice_arch_kubernetes" target="_blank" rel="noopener noreferrer" class="nav-link external">
  后端：微服务架构 Kubernetes
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/fenixsoft/servicemesh_arch_istio" target="_blank" rel="noopener noreferrer" class="nav-link external">
  后端：微服务架构 Istio
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/fenixsoft/serverless_arch_awslambda" target="_blank" rel="noopener noreferrer" class="nav-link external">
  后端：无服务架构 AWS Lambda
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div><div class="nav-item"><a href="https://raw.githubusercontent.com/fenixsoft/awesome-fenix/gh-pages/pdf/the-fenix-project.pdf" target="_blank" rel="noopener noreferrer" class="nav-link external">
  PDF下载
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="/board/" class="nav-link">
  讨论区
</a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/summary/" class="sidebar-link">目录</a></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>前言</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/introduction/about-me.html" class="sidebar-link">关于作者</a></li><li><a href="/introduction/about-the-fenix-project.html" class="sidebar-link">什么是“The Fenix Project”</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>探索起步</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading open"><span>阅读指引</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/changelog/" class="sidebar-link">更新日志</a></li><li><a href="/exploration/guide/quick-start.html" class="sidebar-link">如何开始</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><a href="/exploration/projects/" class="sidebar-heading clickable"><span>技术演示工程</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/exploration/projects/fenix-bookstore-frontend.html" class="sidebar-link">前端工程</a></li><li><a href="/exploration/projects/monolithic_arch_springboot.html" class="sidebar-link">单体架构：Spring Boot</a></li><li><a href="/exploration/projects/microservice_arch_springcloud.html" class="sidebar-link">微服务：Spring Cloud</a></li><li><a href="/exploration/projects/microservice_arch_kubernetes.html" class="sidebar-link">微服务：Kubernetes</a></li><li><a href="/exploration/projects/servicemesh_arch_istio.html" class="sidebar-link">服务网格：Istio</a></li><li><a href="/exploration/projects/serverless_arch.html" class="sidebar-link">无服务：AWS Lambda</a></li></ul></section></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>演进中的架构</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group is-sub-group depth-1"><a href="/architecture/architect-history/" class="sidebar-heading clickable open"><span>服务架构演进史</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/architecture/architect-history/primitive-distribution.html" class="sidebar-link">原始分布式时代</a></li><li><a href="/architecture/architect-history/monolithic.html" class="sidebar-link">单体系统时代</a></li><li><a href="/architecture/architect-history/soa.html" class="sidebar-link">SOA时代</a></li><li><a href="/architecture/architect-history/microservices.html" class="sidebar-link">微服务时代</a></li><li><a href="/architecture/architect-history/post-microservices.html" class="sidebar-link">后微服务时代</a></li><li><a href="/architecture/architect-history/serverless.html" class="sidebar-link">无服务时代</a></li></ul></section></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>架构师的视角</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group is-sub-group depth-1"><a href="/architect-perspective/general-architecture/api-style/" class="sidebar-heading clickable open"><span>访问远程服务</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/architect-perspective/general-architecture/api-style/rpc.html" class="sidebar-link">远程服务调用</a></li><li><a href="/architect-perspective/general-architecture/api-style/rest.html" class="sidebar-link">REST设计风格</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><a href="/architect-perspective/general-architecture/transaction/" class="sidebar-heading clickable"><span>事务处理</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/architect-perspective/general-architecture/transaction/local.html" class="sidebar-link">本地事务</a></li><li><a href="/architect-perspective/general-architecture/transaction/global.html" class="sidebar-link">全局事务</a></li><li><a href="/architect-perspective/general-architecture/transaction/share.html" class="sidebar-link">共享事务</a></li><li><a href="/architect-perspective/general-architecture/transaction/distributed.html" class="sidebar-link">分布式事务</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><a href="/architect-perspective/general-architecture/diversion-system/" class="sidebar-heading clickable"><span>透明多级分流系统</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/architect-perspective/general-architecture/diversion-system/client-cache.html" class="sidebar-link">客户端缓存</a></li><li><a href="/architect-perspective/general-architecture/diversion-system/dns-lookup.html" class="sidebar-link">域名解析</a></li><li><a href="/architect-perspective/general-architecture/diversion-system/transmission-optimization.html" class="sidebar-link">传输链路</a></li><li><a href="/architect-perspective/general-architecture/diversion-system/cdn.html" class="sidebar-link">内容分发网络</a></li><li><a href="/architect-perspective/general-architecture/diversion-system/load-balancing.html" class="sidebar-link">负载均衡</a></li><li><a href="/architect-perspective/general-architecture/diversion-system/cache-middleware.html" class="sidebar-link">服务端缓存</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><a href="/architect-perspective/general-architecture/system-security/" class="sidebar-heading clickable"><span>架构安全性</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/architect-perspective/general-architecture/system-security/authentication.html" class="sidebar-link">认证</a></li><li><a href="/architect-perspective/general-architecture/system-security/authorization.html" class="sidebar-link">授权</a></li><li><a href="/architect-perspective/general-architecture/system-security/credentials.html" class="sidebar-link">凭证</a></li><li><a href="/architect-perspective/general-architecture/system-security/confidentiality.html" class="sidebar-link">保密</a></li><li><a href="/architect-perspective/general-architecture/system-security/transport-security.html" class="sidebar-link">传输</a></li><li><a href="/architect-perspective/general-architecture/system-security/verification.html" class="sidebar-link">验证</a></li></ul></section></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>分布式的基石</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group is-sub-group depth-1"><a href="/distribution/consensus/" class="sidebar-heading clickable open"><span>分布式共识算法</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/distribution/consensus/paxos.html" class="sidebar-link">Paxos</a></li><li><a href="/distribution/consensus/raft.html" class="sidebar-link">Multi Paxos与Raft</a></li><li><a href="/distribution/consensus/gossip.html" class="sidebar-link">Gossip协议</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><a href="/distribution/connect/" class="sidebar-heading clickable"><span>从类库到服务</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/distribution/connect/service-discovery.html" class="sidebar-link">服务发现</a></li><li><a href="/distribution/connect/service-routing.html" class="sidebar-link">网关路由</a></li><li><a href="/distribution/connect/load-balancing.html" class="sidebar-link">客户端负载均衡</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><a href="/distribution/traffic-management/" class="sidebar-heading clickable"><span>服务与流量治理</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/distribution/traffic-management/failure.html" class="sidebar-link">服务容错</a></li><li><a href="/distribution/traffic-management/traffic-control.html" class="sidebar-link">流量控制</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><a href="/distribution/secure/" class="sidebar-heading clickable"><span>可靠通讯</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/distribution/secure/zero-trust.html" class="sidebar-link">零信任网络</a></li><li><a href="/distribution/secure/service-security.html" class="sidebar-link">服务安全</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><a href="/distribution/observability/" class="sidebar-heading clickable"><span>可观测性</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/distribution/observability/logging.html" class="sidebar-link">事件日志</a></li><li><a href="/distribution/observability/tracing.html" class="sidebar-link">链路追踪</a></li><li><a href="/distribution/observability/metrics.html" class="sidebar-link">聚合度量</a></li></ul></section></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>不可变基础设施</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/immutable-infrastructure/msa-to-cn.html" class="sidebar-link">从微服务到云原生</a></li><li><section class="sidebar-group is-sub-group depth-1"><a href="/immutable-infrastructure/container/" class="sidebar-heading clickable"><span>虚拟化容器</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/immutable-infrastructure/container/history.html" class="sidebar-link">容器的崛起</a></li><li><a href="/immutable-infrastructure/container/container-build-system.html" class="sidebar-link">以容器构建系统</a></li><li><a href="/immutable-infrastructure/container/application-centric.html" class="sidebar-link">应用为中心的封装</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><a href="/immutable-infrastructure/network/" class="sidebar-heading clickable"><span>容器间网络</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/immutable-infrastructure/network/linux-vnet.html" class="sidebar-link">Linux网络虚拟化</a></li><li><a href="/immutable-infrastructure/network/cni.html" class="sidebar-link">容器网络与生态</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><a href="/immutable-infrastructure/storage/" class="sidebar-heading clickable"><span>容器持久化存储</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/immutable-infrastructure/storage/storage-evolution.html" class="sidebar-link">Kubernetes存储设计</a></li><li><a href="/immutable-infrastructure/storage/csi.html" class="sidebar-link">容器存储与生态</a></li></ul></section></li><li><a href="/immutable-infrastructure/schedule/hardware-schedule.html" class="sidebar-link">资源与调度</a></li><li><section class="sidebar-group is-sub-group depth-1"><a href="/immutable-infrastructure/mesh/" class="sidebar-heading clickable"><span>服务网格</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/immutable-infrastructure/mesh/communication.html" class="sidebar-link">透明通讯的涅槃</a></li><li><a href="/immutable-infrastructure/mesh/ecosystems.html" class="sidebar-link">服务网格与生态</a></li></ul></section></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>技术方法论</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group is-sub-group depth-1"><a href="/methodology/forward-msa/" class="sidebar-heading clickable open"><span>向微服务迈进</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/methodology/forward-msa/objective.html" class="sidebar-link">目的：微服务的驱动力</a></li><li><a href="/methodology/forward-msa/prerequest.html" class="sidebar-link">前提：微服务需要的条件</a></li><li><a href="/methodology/forward-msa/granularity.html" class="sidebar-link">边界：微服务的粒度</a></li><li><a href="/methodology/forward-msa/governance.html" class="sidebar-link">治理：理解系统复杂性</a></li></ul></section></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>专题随笔</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group is-sub-group depth-1"><a href="/tricks/graalvm/" class="sidebar-heading clickable open"><span>Graal VM</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/tricks/graalvm/graal-compiler.html" class="sidebar-link">新一代即时编译器</a></li><li><a href="/tricks/graalvm/substratevm.html" class="sidebar-link">向原生迈进</a></li><li><a href="/tricks/graalvm/graalvm-native.html" class="sidebar-link">没有虚拟机的Java</a></li><li><a href="/tricks/graalvm/spring-over-graal.html" class="sidebar-link">Spring over Graal</a></li></ul></section></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>附录</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group is-sub-group depth-1"><a href="/appendix/deployment-env-setup/" class="sidebar-heading clickable router-link-active open"><span>部署环境</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/appendix/deployment-env-setup/setup-docker.html" class="sidebar-link">部署Docker CE容器环境</a></li><li><section class="sidebar-group collapsable is-sub-group depth-2"><a href="/appendix/deployment-env-setup/setup-kubernetes/" class="sidebar-heading clickable router-link-active open"><span>部署Kubernetes集群</span> <span class="arrow down"></span></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/appendix/deployment-env-setup/setup-kubernetes/setup-kubeadm.html" class="active sidebar-link">使用Kubeadm部署</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/appendix/deployment-env-setup/setup-kubernetes/setup-kubeadm.html#注册apt软件源" class="sidebar-link">注册apt软件源</a></li><li class="sidebar-sub-header"><a href="/appendix/deployment-env-setup/setup-kubernetes/setup-kubeadm.html#安装kubelet、kubectl、kubeadm" class="sidebar-link">安装kubelet、kubectl、kubeadm</a></li><li class="sidebar-sub-header"><a href="/appendix/deployment-env-setup/setup-kubernetes/setup-kubeadm.html#初始化集群前的准备" class="sidebar-link">初始化集群前的准备</a></li><li class="sidebar-sub-header"><a href="/appendix/deployment-env-setup/setup-kubernetes/setup-kubeadm.html#预拉取镜像" class="sidebar-link">预拉取镜像</a></li><li class="sidebar-sub-header"><a href="/appendix/deployment-env-setup/setup-kubernetes/setup-kubeadm.html#初始化集群控制平面" class="sidebar-link">初始化集群控制平面</a></li><li class="sidebar-sub-header"><a href="/appendix/deployment-env-setup/setup-kubernetes/setup-kubeadm.html#为当前用户生成kubeconfig" class="sidebar-link">为当前用户生成kubeconfig</a></li><li class="sidebar-sub-header"><a href="/appendix/deployment-env-setup/setup-kubernetes/setup-kubeadm.html#安装cni插件" class="sidebar-link">安装CNI插件</a></li><li class="sidebar-sub-header"><a href="/appendix/deployment-env-setup/setup-kubernetes/setup-kubeadm.html#移除master节点上的污点" class="sidebar-link">移除Master节点上的污点</a></li><li class="sidebar-sub-header"><a href="/appendix/deployment-env-setup/setup-kubernetes/setup-kubeadm.html#调整nodeport范围" class="sidebar-link">调整NodePort范围</a></li><li class="sidebar-sub-header"><a href="/appendix/deployment-env-setup/setup-kubernetes/setup-kubeadm.html#启用kubectl命令自动补全功能" class="sidebar-link">启用kubectl命令自动补全功能</a></li><li class="sidebar-sub-header"><a href="/appendix/deployment-env-setup/setup-kubernetes/setup-kubeadm.html#将其他node节点加入到kubernetes集群中" class="sidebar-link">将其他Node节点加入到Kubernetes集群中</a></li></ul></li><li><a href="/appendix/deployment-env-setup/setup-kubernetes/setup-rancher.html" class="sidebar-link">使用Rancher部署</a></li><li><a href="/appendix/deployment-env-setup/setup-kubernetes/setup-minikube.html" class="sidebar-link">使用Minikube部署</a></li></ul></section></li></ul></section></li><li><a href="/appendix/istio.html" class="sidebar-link">部署Istio</a></li><li><a href="/appendix/operation-env-setup/elk-setup.html" class="sidebar-link">部署Elastic Stack</a></li><li><a href="/appendix/operation-env-setup/prometheus-setup.html" class="sidebar-link">部署Prometheus</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="使用kubeadm部署">使用Kubeadm部署</h1> <p>尽管使用Rancher或者KubeSphere这样更高层次的管理工具，可以更“傻瓜式”地部署和管理Kubernetes集群，但kubeadm作为官方提供的用于快速安装Kbuernetes的命令行工具，仍然是应该掌握的基础技能。kubeadm随着新版的Kubernetes同步更新，时效性也会比其他更高层次的管理工具来的更好。</p> <p>随着Kubernetes不断成熟，kuberadm无论是部署单控制平面（Single Control-Plane，单Master节点）集群还是高可用（High-Availability，多Master节点）集群，都已经有了更优秀的易用性，现在手工部署Kubernetes集群已经不是什么太复杂、困难的事情了。本文以Debian系的Linux为例，介绍通过kuberadm部署集群的全过程。</p> <div class="custom-block tip"><p class="custom-block-title">注意事项</p> <ol><li>安装Kubernetes集群，需要从谷歌的仓库中拉取镜像，由于国内访问谷歌的网络受阻，需要通过科学上网或者在Docker中预先拉取好所需镜像等方式解决。</li> <li>集群中每台机器的Hostname不要重复，否则Kubernetes从不同机器收集状态信息时会产生干扰，被认为是同一台机器。</li> <li>安装Kubernetes最小需要2核CPU、2GB内存，且为x86架构（暂不支持ARM架构）。对于物理机来说，今时今日要找一台不满足以上条件的机器很困难，但对于云主机来说，尤其是购买网站上最低配置的同学，要注意一下是否达到了最低要求，不清楚的话请在/proc/cpuinf、/proc/meminfo中确认一下。</li> <li>确保网络通畅的——这听起来像是废话，但确实有相当一部分的云主机默认不对SELinux、iptables、安全组、防火墙进行设置的话，内网各个节点之间、与外网之间会存在访问障碍，导致部署失败。</li></ol></div> <h2 id="注册apt软件源">注册apt软件源</h2> <p>由于Kubernetes并不在主流Debian系统自带的软件源中，所以要手工注册，然后才能使用apt-get安装。</p> <p>官方的GPG Key地址为：<a href="https://packages.cloud.google.com/apt/doc/apt-key.gpg" target="_blank" rel="noopener noreferrer">https://packages.cloud.google.com/apt/doc/apt-key.gpg<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>，其中包括的软件源的地址为：<a href="https://apt.kubernetes.io/" target="_blank" rel="noopener noreferrer">https://apt.kubernetes.io/<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>（该地址最终又会被重定向至：<a href="https://packages.cloud.google.com/apt/" target="_blank" rel="noopener noreferrer">https://packages.cloud.google.com/apt/<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>）。如果能访问google.com域名的机器，采用以下方法注册apt软件源是最佳的方式：</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># 添加GPG Key</span>
$ <span class="token function">sudo</span> <span class="token function">curl</span> -fsSL https://packages.cloud.google.com/apt/doc/apt-key.gpg <span class="token operator">|</span> <span class="token function">sudo</span> apt-key <span class="token function">add</span> -

<span class="token comment"># 添加K8S软件源</span>
$ <span class="token function">sudo</span> add-apt-repository <span class="token string">&quot;deb https://apt.kubernetes.io/ kubernetes-xenial main&quot;</span>
</code></pre></div><p>对于不能访问google.com的机器，就要借助国内的镜像源来安装了。虽然在这些镜像源中我已遇到过不止一次同步不及时的问题了——就是官方源中已经发布了软件的更新版本，而镜像源中还是旧版的，除了时效性问题外，还出现过其他的一些一致性问题，但是总归比没有的强。国内常见用的apt源有阿里云的、中科大的等，具体为：</p> <blockquote><p>阿里云：</p> <ul><li>GPG Key：<a href="http://mirrors.aliyun.com/kubernetes/apt/doc/apt-key.gpg" target="_blank" rel="noopener noreferrer">http://mirrors.aliyun.com/kubernetes/apt/doc/apt-key.gpg<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li>软件源：<a href="http://mirrors.aliyun.com/kubernetes/apt" target="_blank" rel="noopener noreferrer">http://mirrors.aliyun.com/kubernetes/apt<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <p>中科大：</p> <ul><li>GPG Key：<a href="https://raw.githubusercontent.com/EagleChen/kubernetes_init/master/kube_apt_key.gpg" target="_blank" rel="noopener noreferrer">https://raw.githubusercontent.com/EagleChen/kubernetes_init/master/kube_apt_key.gpg<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li>软件源：<a href="http://mirrors.ustc.edu.cn/kubernetes/apt" target="_blank" rel="noopener noreferrer">http://mirrors.ustc.edu.cn/kubernetes/apt<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></blockquote> <p>它们的使用方式与官方源注册过程是一样的，只需替换里面的GPG Key和软件源的URL地址即可，譬如阿里云：</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># 添加GPG Key</span>
$ <span class="token function">curl</span> -fsSL http://mirrors.aliyun.com/kubernetes/apt/doc/apt-key.gpg <span class="token operator">|</span> <span class="token function">sudo</span> apt-key <span class="token function">add</span> -

<span class="token comment"># 添加K8S软件源</span>
$ <span class="token function">sudo</span> add-apt-repository <span class="token string">&quot;deb http://mirrors.aliyun.com/kubernetes/apt kubernetes-xenial main&quot;</span>
</code></pre></div><p>添加源后记得执行一次更新：</p> <div class="language-bash extra-class"><pre class="language-bash"><code>$ <span class="token function">sudo</span> <span class="token function">apt-get</span> update
</code></pre></div><h2 id="安装kubelet、kubectl、kubeadm">安装kubelet、kubectl、kubeadm</h2> <p>其实并不需要在每个节点都装上kubectl，但是，我缺的是哪点磁盘空间？</p> <p>下面简要列出了这三个工具/组件的作用，现在看不看得懂都没有关系，以后用到它们的机会多得是，要相信日久总会生情的。</p> <ul><li>kubeadm: 引导启动Kubernate集群的命令行工具。</li> <li>kubelet: 在群集中的所有计算机上运行的组件, 并用来执行如启动pods和containers等操作。</li> <li>kubectl: 用于操作运行中的集群的命令行工具。</li></ul> <div class="language-bash extra-class"><pre class="language-bash"><code>$ <span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> kubelet kubeadm kubectl
</code></pre></div><h2 id="初始化集群前的准备">初始化集群前的准备</h2> <p>在使用kubeadm初始化集群之前，还有一些必须的前置工作要妥善处理：</p> <p>首先，基于安全性（如在文档中承诺的Secret只会在内存中读写）、利于保证节点同步一致性等原因，从1.8版开始，Kubernetes就在它的文档中明确声明了它<strong>默认不支持Swap分区</strong>，在未关闭Swap分区时，集群将直接无法启动。关闭Swap的命令为：</p> <div class="language-bash extra-class"><pre class="language-bash"><code>$ <span class="token function">sudo</span> swapoff -a
</code></pre></div><p>上面这个命令是一次性的，只在当前这次启动中生效，要彻底关闭Swap分区，需要在文件系统分区表的配置文件中去直接除掉Swap分区。使用vim打开/etc/fstab，注释其中带有swap的行即可，或使用以下命令直接完成修改：</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># 还是先备份一下</span>
$ <span class="token function">yes</span> <span class="token operator">|</span> <span class="token function">sudo</span> <span class="token function">cp</span> /etc/fstab /etc/fstab_bak

<span class="token comment"># 进行修改</span>
$ <span class="token function">sudo</span> <span class="token function">cat</span> /etc/fstab_bak <span class="token operator">|</span> <span class="token function">grep</span> -v swap <span class="token operator">&gt;</span> /etc/fstab
</code></pre></div><blockquote><p><strong>可选操作</strong></p> <p>当然，在服务器上使用的话，关闭Swap影响还是很大的，如果服务器除了Kubernetes还有其他用途的话（除非实在太穷，否则建议不要这样混用；一定要混用的话，宁可把其他服务搬到Kubernetes上）。关闭Swap有可能会对其他服务产生不良的影响，这时需要修改每个节点的kubelet配置，去掉必须关闭Swap的默认限制，具体操作为：</p> <div class="language-bash extra-class"><pre class="language-bash"><code>$ <span class="token builtin class-name">echo</span> <span class="token string">&quot;KUBELET_EXTRA_ARGS=--fail-swap-on=false&quot;</span> <span class="token operator">&gt;&gt;</span> /etc/sysconfig/kubelet
</code></pre></div></blockquote> <p>其次，由于Kubernetes与Docker默认的cgroup（root控制组）驱动程序并不一致，Kubernetes默认为systemd，而Docker默认为cgroupfs。</p> <div class="custom-block warning"><p class="custom-block-title">更新信息</p> <p>从1.18开始，Kubernetes默认的cgroup驱动已经<a href="https://kubernetes.io/docs/setup/production-environment/tools/kubeadm/install-kubeadm/#configure-cgroup-driver-used-by-kubelet-on-control-plane-node" target="_blank" rel="noopener noreferrer">默认修改<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>成cgroupfs了，这时候再进行改动反而又会不一致</p></div> <p>在这里我们要修改Docker或者Kubernetes其中一个的cgroup驱动，以便两者统一。根据官方文档《<a href="https://kubernetes.io/docs/setup/cri/" target="_blank" rel="noopener noreferrer">CRI installation<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>》中的建议，对于使用systemd作为引导系统的Linux的发行版，使用systemd作为Docker的cgroup驱动程序可以服务器节点在资源紧张的情况表现得更为稳定。</p> <p>这里选择修改各个节点上Docker的cgroup驱动为systemd，具体操作为编辑（无则新增）/etc/docker/daemon.json文件，加入以下内容即可：</p> <div class="language-text extra-class"><pre class="language-text"><code>{
  &quot;exec-opts&quot;: [&quot;native.cgroupdriver=systemd&quot;]
}
</code></pre></div><p>然后重新启动Docker容器：</p> <div class="language-bash extra-class"><pre class="language-bash"><code>$ systemctl daemon-reload
$ systemctl restart docker
</code></pre></div><h2 id="预拉取镜像">预拉取镜像 <span class="badge warning" style="vertical-align:top;" data-v-15b7b770>可选</span></h2> <p>预拉取镜像并不是必须的，本来初始化集群的时候系统就会自动拉取Kubernetes中要使用到的Docker镜像组件，也提供了一个“kubeadm config images pull”命令来一次性的完成拉取，这都是因为如果要手工来进行这项工作，实在非常非常非常的繁琐。</p> <p>但对于许多人来说这项工作往往又是无可奈何的，Kubernetes的镜像都存储在k8s.gcr.io上，如果您的机器无法直接或通过代理访问到gcr.io（Google Container Registry，敲黑板：这是属于谷歌的网址）的话，初始化集群时自动拉取就无法顺利进行，所以就不得不手工预拉取。</p> <p>预拉取的意思是，由于Docker只要查询到本地有相同（名称和tag完全相同、哈希相同）的镜像，就不会访问远程仓库，那只要从GitHub上拉取到所需的镜像，再将tag修改成官方的一致，就可以跳过网络访问阶段。</p> <p>首先使用以下命令查询当前版本需要哪些镜像：</p> <div class="language-bash extra-class"><pre class="language-bash"><code>$ kubeadm config images list --kubernetes-version v1.17.3

k8s.gcr.io/kube-apiserver:v1.17.3
k8s.gcr.io/kube-controller-manager:v1.17.3
k8s.gcr.io/kube-scheduler:v1.17.3
k8s.gcr.io/kube-proxy:v1.17.3
k8s.gcr.io/pause:3.1
k8s.gcr.io/etcd:3.4.3-0
k8s.gcr.io/coredns:1.6.5
……
</code></pre></div><p>这里必须使用“--kubernetes-version”参数指定具体版本，因为尽管每个版本需要的镜像信息在本地是有存储的，但如果不加的话，Kubernetes将向远程GCR仓库查询最新的版本号，会因网络无法访问而导致问题。但加版本号的时候切记不能照抄上面的命令中的“v1.17.3”，应该与你安装的kubelet版本保持一致，否则在初始化集群控制平面的时候会提示控制平面版本与kubectl版本不符。</p> <p>得到这些镜像名称和tag后，可以从<a href="https://hub.docker.com" target="_blank" rel="noopener noreferrer">DockerHub<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>上找存有相同镜像的仓库来拉取，至于具体哪些公开仓库有，考虑到以后阅读本文时Kubernetes的版本应该会有所差别，所以需要自行到网站上查询一下。笔者比较常用的是一个名为“anjia0532”的仓库，有机器人自动跟官方同步，相对比较及时。</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment">#以k8s.gcr.io/coredns:1.6.5为例，每个镜像都要这样处理一次</span>
$ docker pull anjia0532/google-containers.coredns:1.6.5

<span class="token comment">#修改tag</span>
$ docker tag anjia0532/google-containers.coredns:1.6.5 k8s.gcr.io/coredns:1.6.5

<span class="token comment">#修改完tag后就可以删除掉旧镜像了</span>
$ docker rmi anjia0532/google-containers.coredns:1.6.5
</code></pre></div><h2 id="初始化集群控制平面">初始化集群控制平面</h2> <p>到了这里，终于可以开始Master节点的部署了，先确保kubelet是开机启动的：</p> <div class="language-bash extra-class"><pre class="language-bash"><code>$ <span class="token function">sudo</span> systemctl start kubelet
$ <span class="token function">sudo</span> systemctl <span class="token builtin class-name">enable</span> kubelet
</code></pre></div><p>接下来使用su直接切换到root用户（而不是使用sudo），然后使用以下命令开始部署：</p> <div class="language-bash extra-class"><pre class="language-bash"><code>$ kubeadm init --kubernetes-version v1.17.3 --pod-network-cidr<span class="token operator">=</span><span class="token number">10.244</span>.0.0/16
</code></pre></div><p>这里使用“--kubernetes-version”参数（要注意版本号与kubelet一致）的原因与前面预拉取是一样的，避免额外的网络访问；另外一个参数“--pod-network-cidr”着在稍后介绍完CNI网络插件时会去说明。</p> <p>当看到下面信息之后，说明集群主节点已经安装完毕了。</p> <div class="custom-block center"><p><img src="/assets/img/kubernetes-initialized.7c7ddc17.png" alt=""></p></div> <p>这信息先恭喜你已经把控制平面安装成功了，但还有三行“you need……”、“you should……”、“you can……”开头的内容，这是三项后续的“可选”工作，下面继续介绍。</p> <h2 id="为当前用户生成kubeconfig">为当前用户生成kubeconfig</h2> <p>使用Kubernetes前需要为当前用户先配置好admin.conf文件。切换至需配置的用户后，进行如下操作：</p> <div class="language-bash extra-class"><pre class="language-bash"><code>$ <span class="token function">mkdir</span> -p <span class="token environment constant">$HOME</span>/.kube
$ <span class="token function">sudo</span> <span class="token function">cp</span> -i /etc/kubernetes/admin.conf <span class="token environment constant">$HOME</span>/.kube/config
$ <span class="token function">sudo</span> <span class="token function">chown</span> <span class="token variable"><span class="token variable">$(</span><span class="token function">id</span> -u<span class="token variable">)</span></span><span class="token builtin class-name">:</span><span class="token variable"><span class="token variable">$(</span><span class="token function">id</span> -g<span class="token variable">)</span></span> <span class="token environment constant">$HOME</span>/.kube/config
</code></pre></div><h2 id="安装cni插件">安装CNI插件 <span class="badge warning" style="vertical-align:top;" data-v-15b7b770>可选</span></h2> <p>CNI即“容器网络接口”，在2016 年，CoreOS发布了CNI规范。2017年5月，CNI被CNCF技术监督委员会投票决定接受为托管项目，从此成为不同容器编排工具（Kubernetes、Mesos、OpenShift）可以共同使用的、解决容器之间网络通讯的统一接口规范。</p> <p>部署Kubernetes时，我们可以有两种网络方案使得以后受管理的容器之间进行网络通讯：</p> <ul><li>使用Kubernetes的默认网络</li> <li>使用CNI及其插件</li></ul> <p>第一种方案，尤其不在GCP或者AWS的云主机上，没有它们的命令行管理工具时，需要大量的手工配置，基本上是反人类的。实际通常都会采用第二种方案，使用CNI插件来处理容器之间的网络通讯，所以本节所标识的“[可选]”其实也并没什么选择不安装CNI插件的余地。</p> <p>Kubernetes目前支持的CNI插件有：Calico、Cilium、Contiv-VPP、Flannel、Kube-router、Weave Net等六种，每种网络提供了不同的管理特性（如MTU自动检测）、安全特性（如是否支持加密通讯）、网络策略（如Ingress、Egress规则）、传输性能（甚至对TCP、UDP、HTTP、FTP、SCP等不同协议来说也有不同的性能表现）以及主机的性能消耗。后续我们将专门对不同CNI插件进行测试对比，在环境部署这部分，对于初学者来说，使用Flannel是较为合适的，它是最精简的CNI，没有安全特性的支持，主机压力小，安装便捷，效率也不错，使用以下命令安装Flannel网络：</p> <div class="language-bash extra-class"><pre class="language-bash"><code>$ <span class="token function">curl</span> --insecure -sfL https://raw.githubusercontent.com/coreos/flannel/master/Documentation/kube-flannel.yml <span class="token operator">|</span> kubectl apply -f -
</code></pre></div><p>使用Flannel的话，要注意要在创建集群时加入“--pod-network-cidr”参数，指明网段划分。</p> <h2 id="移除master节点上的污点">移除Master节点上的污点 <span class="badge warning" style="vertical-align:top;" data-v-15b7b770>可选</span></h2> <p>污点（Taint）是Kubernetes Pod调度中的概念，在这里通俗地理解就是Kubernetes决定在集群中的哪一个节点建立新的容器时，要先排除掉带有特定污点的节点，以避免容器在Kubernetes不希望运行的节点中创建、运行。默认情况下，集群的Master节点是会带有污点的，以避免容器分配到Master中创建。但对于许多学习Kubernetes的同学来说，并没有多宽裕的机器数量，往往是建立单节点集群或者最多只有两、三个节点，这样Master节点不能运行容器就显得十分浪费了。需要移除掉Master节点上所有的污点，在Master节点上执行以下命令即可：</p> <div class="language-bash extra-class"><pre class="language-bash"><code>$ kubectl taint nodes --all node-role.kubernetes.io/master-
</code></pre></div><p>做到这步，如果你只有一台机器的话，那Kubernetes的安装已经宣告结束了，可以使用此环境来完成后续所有的部署。你还可以通过cluster-info和get nodes子命令来查看一下集群的状态，类似如下所示：</p> <div class="custom-block center"><p><img src="/assets/img/kubernetes-setup-completed.08416ad7.png" alt=""></p></div> <h2 id="调整nodeport范围">调整NodePort范围 <span class="badge warning" style="vertical-align:top;" data-v-15b7b770>可选</span></h2> <p>Kubernetes默认的NodePort范围为30000-32767，为了方便使用低端口，可能需要修改此范围，这需要调整Api-Server的启动参数，具体操作如下（如过是高可用部署，需要对每一个Master节点进行修改）：</p> <ul><li><p>修改<code>/etc/kubernetes/manifests/kube-apiserver.yaml</code>文件，添加一个参数在<code>spec.containers.command</code>中增加一个参数<code>--service-node-port-range=1-32767</code></p></li> <li><p>重启Api-Server，现在Kubernetes基本都是以静态Pods模式部署，Api-Server是一个直接由kubelet控制的静态Pod，删除后它会自动重启：</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># 获得 apiserver 的 pod 名字</span>
<span class="token builtin class-name">export</span> <span class="token assign-left variable">apiserver_pods</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span>kubectl get pods --selector<span class="token operator">=</span>component<span class="token operator">=</span>kube-apiserver -n kube-system --output<span class="token operator">=</span>jsonpath<span class="token operator">=</span><span class="token punctuation">{</span>.items<span class="token punctuation">..</span>metadata.name<span class="token punctuation">}</span><span class="token variable">)</span></span>
<span class="token comment"># 删除 apiserver 的 pod</span>
kubectl delete pod <span class="token variable">$apiserver_pods</span> -n kube-system
</code></pre></div></li> <li><p>验证修改结果：可以在pod中看到该参数即可</p> <div class="language-bash extra-class"><pre class="language-bash"><code>kubectl describe pod <span class="token variable">$apiserver_pods</span> -n kube-system
</code></pre></div></li></ul> <h2 id="启用kubectl命令自动补全功能">启用kubectl命令自动补全功能 <span class="badge warning" style="vertical-align:top;" data-v-15b7b770>可选</span></h2> <p>由于kubectl命令在后面十分常用，而且Kubernetes许多资源名称都带有随机字符，要手工照着敲很容易出错，强烈推荐启用命令自动补全的功能，这里仅以bash和笔者常用的zsh为例，如果您使用其他shell，需自行调整：</p> <blockquote><p>bash：</p> <div class="language-bash extra-class"><pre class="language-bash"><code>$ <span class="token builtin class-name">echo</span> <span class="token string">'source &lt;(kubectl completion bash)'</span> <span class="token operator">&gt;&gt;</span> ~/.bashrc
$ <span class="token builtin class-name">echo</span> <span class="token string">'source /usr/share/bash-completion/bash_completion'</span> <span class="token operator">&gt;&gt;</span> ~/.bashrc
</code></pre></div><p>zsh：</p> <div class="language-bash extra-class"><pre class="language-bash"><code>$ <span class="token builtin class-name">echo</span> <span class="token string">'source &lt;(kubectl completion zsh)'</span> <span class="token operator">&gt;&gt;</span> <span class="token operator">!</span>/.zshrc
</code></pre></div></blockquote> <h2 id="将其他node节点加入到kubernetes集群中">将其他Node节点加入到Kubernetes集群中</h2> <p>在安装Master节点时候，输出的最后一部分内容会类似如下所示：</p> <div class="language-text extra-class"><pre class="language-text"><code>Then you can join any number of worker nodes by running the following on each as root:

  kubeadm join 10.3.7.5:6443 --token ejg4tt.y08moym055dn9i32 \
    --discovery-token-ca-cert-hash sha256:9d2079d2844fa2953d33cc0da57ab15f571e974aa40ccb50edde12c5e906d513
</code></pre></div><p>这部分内容是告诉用户，集群的Master节点已经建立完毕，其他节点的机器可以使用“kubeadm join”命令加入集群。这些机器只要完成kubeadm、kubelet、kubectl的安装即可、其他的所有步骤，如拉取镜像、初始化集群等等都不需要去做，就是可以使用该命令加入集群了。需要注意的是，该Token的有效时间为24小时，如果超时，使用以下命令重新获取：</p> <div class="language-bash extra-class"><pre class="language-bash"><code>$ kubeadm token create --print-join-command
</code></pre></div></div> <footer class="page-edit"><!----> <div class="git-hub-star"><span class="prefix">
      Kudos to
      <span style="position:relative;top:4px;right:-4px;"><a href="https://github.com/fenixsoft/awesome-fenix" aria-label="Star fenixsoft/awesome-fenix on GitHub" data-icon="octicon-star" data-show-count="true">
      Star
    </a></span></span></div> <div class="last-updated"><span class="prefix">总字数:</span> <span class="words">4,243</span> <span class="prefix">字　</span> <span class="prefix">最后更新:</span> <span class="time">10/10/2020, 9:12:24 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
    ←
    <a href="/appendix/deployment-env-setup/setup-kubernetes/" class="prev router-link-active">
      部署Kubernetes集群
    </a></span> <span class="next"><a href="/appendix/deployment-env-setup/setup-kubernetes/setup-rancher.html">
      使用Rancher部署
    </a>
    →
  </span></p></div> </main></div><div class="global-ui"><div></div><!----></div></div>
    <script src="/assets/js/app.51ccb962.js" defer></script><script src="/assets/js/3.95a2b2fa.js" defer></script><script src="/assets/js/6.3b617915.js" defer></script><script src="/assets/js/25.bab3efd5.js" defer></script><script src="/assets/js/42.87752af5.js" defer></script>
  </body>
</html>
